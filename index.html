<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>2606AI</title>

<!-- Bootstrap & Icons -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

<style>
/* =======================================================
   2606AI UI ‚Äì FULL STYLESHEET (v7)
   ======================================================= */

/* ---------- CSS variables & base ---------- */
:root{
  --main:#2e7d32;
  --main-dark:#1b5e20;
  --main-light:#66bb6a;
  --grad:linear-gradient(90deg,#4caf50,#1b5e20);
  --accent:#d4af37;
  --bg:#f6faf6;
  --card:#fff;
  --border:#e3ebe3;
  --text:#172617;
  --muted:#607460;
  --radius:12px;
  --radius-sm:10px;
  --shadow-sm:0 1px 3px rgba(0,0,0,.06);
  --shadow-md:0 4px 14px rgba(0,0,0,.12);
  --shadow-lg:0 8px 28px rgba(0,0,0,.16);
  --tr:all .2s ease;
}

/* Reset r·∫•t nh·∫π */
*{box-sizing:border-box}
html,body{height:100%}
html{scroll-behavior:smooth}
body{
  margin:0; background:var(--bg); color:var(--text);
  font-family:'Be Vietnam Pro',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  font-size:15px; line-height:1.6; padding-top:70px;
}
img{max-width:100%; display:block}
a{color:var(--main); text-decoration:none}
a:hover{color:var(--main-dark)}
.container-fluid{max-width:1360px; margin:0 auto; padding:0 18px}

/* ---------- Header + Search ---------- */
.site-header{
  position:fixed; inset:0 0 auto 0; height:70px; z-index:1000;
  background:#fff; border-bottom:1px solid var(--border); box-shadow:var(--shadow-sm);
}
.site-header .wrap{
  display:flex; align-items:center; gap:14px; padding:12px 18px;
}
.site-header img.logo{
  width:110px; object-fit:contain; margin-left:8px; cursor:pointer;
}
.header-search{ flex:1 1 auto; margin-left:8px }
.header-search .input-group{ width:100% }
.header-search .form-control{
  height:42px; border:1px solid var(--border); border-radius:10px 0 0 10px;
  padding:8px 12px; font-size:14px; background:#fff;
}
.header-search .btn{
  height:42px; border-radius:0 10px 10px 0; border:0;
  background:var(--grad); color:#fff; font-weight:700;
}
.header-search .btn:hover{ opacity:.92 }

/* ---------- Top banner (marquee) ---------- */
.top-banner{
  position:sticky; top:70px; height:40px; z-index:950;
  background:var(--grad); color:#fff; display:flex; align-items:center; overflow:hidden;
}
.top-banner .wrap{ width:100%; display:flex; justify-content:center; padding:0 12px }
.top-banner .marquee{
  white-space:nowrap; display:inline-block; line-height:1.2; will-change:transform;
  animation:marquee 60s linear infinite;
}
@keyframes marquee{ 0%{transform:translateX(100%)} 100%{transform:translateX(-100%)} }

/* ---------- Sidebar box ---------- */
.sidebar-box{
  background:var(--card); border:1px solid var(--border);
  border-radius:var(--radius); box-shadow:var(--shadow-sm);
  padding:14px; margin-bottom:18px;
}

/* =======================================================
   ‚ÄúCh√∫ng t√¥i c√≥ g√¨ cho b·∫°n‚Ä¶‚Äù  (gi·ªëng h√¨nh b·∫°n g·ª≠i)
   ======================================================= */
.benefits-v3 .grid{ display:flex; flex-direction:column; gap:10px }
.benefits-v3 .bcard{
  background:#fff; border:1px solid #e5efe5; border-radius:12px;
  box-shadow:var(--shadow-sm); padding:12px 14px;
  display:grid; column-gap:12px; row-gap:4px; align-items:center;
  grid-template-columns:48px 1fr 280px;
  grid-template-areas:
    "ic ttl badge"
    "ic sub badge";
  transition:var(--tr);
}
.benefits-v3 .bcard:hover{
  background:#f6fbf6; border-color:#dfeade; box-shadow:0 2px 12px rgba(46,125,50,.09);
  transform:translateY(-1px);
}
.benefits-v3 .bcard .ic{
  grid-area:ic; width:38px; height:38px; border-radius:50%;
  display:grid; place-items:center; background:#eff7ef; color:var(--main);
  font-size:18px;
}
.benefits-v3 .bcard .ttl{
  grid-area:ttl; font-weight:800; color:#153515; line-height:1.35;
}
.benefits-v3 .bcard .sub{
  grid-area:sub; color:#6b7d6b; font-size:13px; line-height:1.35;
}
.benefits-v3 .bcard .benefit-note{
  grid-area:badge; justify-self:end; align-self:start;
  font-size:12px; font-weight:800; padding:6px 10px; white-space:nowrap;
  border-radius:999px; border:1px solid #d6ead8; background:#e8f5e9; color:#1b5e20;
}
.benefits-v3 .bcard .benefit-paid{ background:#fff3e0; border-color:#ffe1b8; color:#b56200 }

/* ---------- Hero banners ---------- */
.hero{ margin-bottom:24px }
.hero .carousel{ border-radius:14px; overflow:hidden; box-shadow:var(--shadow-md) }
.hero .main img{ height:300px; object-fit:cover }
.hero .mini img{ height:145px; object-fit:cover }

/* ---------- Group chips + categories ---------- */
.group-bar-wrapper{
  background:#fff; border:1px solid var(--border);
  border-radius:var(--radius); padding:8px 12px; display:flex; align-items:center; gap:8px;
  box-shadow:var(--shadow-sm);
}
.group-bar-scroll{ display:flex; gap:10px; overflow:auto; scrollbar-width:none }
.group-bar-scroll::-webkit-scrollbar{ display:none }
.group-chip{
  display:inline-flex; align-items:center; gap:8px;
  padding:8px 14px; border-radius:10px; border:1px solid var(--border);
  background:#fff; color:var(--main); font-weight:700; white-space:nowrap; cursor:pointer;
  transition:var(--tr);
}
.group-chip:hover{ background:#f1f7f1 }
.group-chip.active{ background:var(--grad); color:#fff; border-color:transparent; box-shadow:0 3px 10px rgba(46,125,50,.22) }
.group-chip .chip-icon img{ width:22px; height:22px; object-fit:contain }

.group-arrow,.cat-arrow{
  border:0; background:#fff; color:var(--main);
  width:34px; height:34px; border-radius:50%;
  display:flex; align-items:center; justify-content:center;
  box-shadow:var(--shadow-sm); font-size:22px; transition:var(--tr);
}
.group-arrow:hover,.cat-arrow:hover{ background:var(--grad); color:#fff; transform:translateY(-1px) }
.group-arrow.is-disabled,.cat-arrow.is-disabled{ opacity:.45; pointer-events:none }

/* Category strip */
.category-box{
  background:#fff; border:1px solid var(--border);
  border-radius:var(--radius); padding:12px; margin-top:14px; box-shadow:var(--shadow-sm);
}
.category-scroll{
  display:grid; grid-template-columns:repeat(auto-fill,minmax(120px,1fr));
  gap:14px;
}
.category-item{
  background:#fff; border:1px solid var(--border); border-radius:10px;
  text-align:center; padding:10px; cursor:pointer; transition:var(--tr);
}
.category-item:hover{ background:#f3f7f3 }
.category-item.active{ background:var(--grad); color:#fff; border-color:transparent }
.category-item img{ width:48px; height:48px; margin:0 auto 8px; object-fit:contain }

/* ---------- Stats row + pagination ---------- */
.stats-row{
  background:#fff; border:1px solid var(--border); border-radius:var(--radius);
  padding:10px 12px; box-shadow:var(--shadow-sm); margin: 8px 0 10px 0;
}
.found-count .lbl{ margin-right:6px; color:#415a41; font-weight:600 }
.pager-bar{ display:flex; justify-content:flex-end }
.page-select{ min-width:160px }

/* ---------- Product grid ---------- */
#productGrid{ margin-top:12px }
.cardx{
  background:#fff; border:1px solid var(--border); border-radius:10px;
  box-shadow:var(--shadow-sm); overflow:hidden; display:flex; flex-direction:column; height:100%;
  transition:var(--tr);
}
.cardx:hover{ transform:translateY(-3px); box-shadow:var(--shadow-md) }
.thumb-wrap{ position:relative }
.cardx img.thumb{ width:100%; height:200px; object-fit:cover; border-bottom:1px solid var(--border) }
.note-chip{
  position:absolute; top:10px; left:10px; font-size:11px; padding:3px 8px; border-radius:999px;
  background:var(--accent); color:#fff;
}
.cardx .meta{ padding:10px; display:flex; flex-direction:column; gap:4px }
.cardx .id{ font-weight:700; color:var(--main) }
.cardx .details{ font-size:13px; color:var(--muted) }
.cardx .price{ font-weight:800; color:#d32f2f; margin-top:auto }

/* ---------- Workshop & Suppliers ---------- */
.workshop-box{
  background:linear-gradient(180deg,#e8f5e9,#cfe7d0);
  border:1px solid #bfe0c1; border-radius:var(--radius); padding:14px; box-shadow:var(--shadow-sm)
}
.link-preview{
  display:flex; align-items:center; gap:10px; padding:8px; background:#fff;
  border:1px solid var(--border); border-radius:10px; transition:var(--tr); color:inherit;
}
.link-preview:hover{ background:#f8fcf8; transform:translateY(-1px) }
.link-preview img{ width:48px; height:48px; border-radius:8px; object-fit:cover }
.link-preview .title{ font-weight:700; color:var(--main-dark) }
.link-preview .desc{ font-size:12px; color:var(--muted) }

/* Suppliers (offcanvas list) */
.supplier-list .supplier-card{
  border:1px solid var(--border); border-radius:10px; background:#fff; padding:10px;
}
.supplier-list .supplier-card .title{ font-weight:700 }
.supplier-list .chip{
  display:inline-block; padding:4px 8px; border-radius:999px; background:#eef5ef;
  font-size:12px; margin-right:6px; border:1px solid #dfebdf
}
.supplier-list .chip.ok{ background:#e8f5e9; color:#1b5e20; border-color:#d5ead5 }
.supplier-list .chip.muted{ background:#f3f3f3; color:#666 }

/* ---------- FABs ---------- */
.fabs{ position:fixed; bottom:20px; right:20px; display:flex; flex-direction:column; gap:12px; z-index:1200 }
.fab{
  width:56px; height:56px; border-radius:50%; display:flex; align-items:center; justify-content:center;
  background:#fff; color:var(--main); font-size:24px; box-shadow:var(--shadow-md); cursor:pointer; transition:var(--tr)
}
.fab:hover{ transform:translateY(-2px); box-shadow:var(--shadow-lg); background:var(--grad); color:#fff }
.fab-badge{
  position:absolute; top:5px; right:8px; background:#e53935; color:#fff; font-size:11px;
  padding:1px 5px; line-height:1.25; border-radius:10px
}

/* ---------- Offcanvas tweaks ---------- */
.offcanvas .form-control, .offcanvas .form-select{ border-radius:10px }
.summary-box{
  border:1px dashed var(--border); border-radius:10px; padding:10px; background:#fafdfa; margin:8px 0
}

/* ---------- Footer ---------- */
footer.text-light{
  background:linear-gradient(180deg,#2e7d32,#1b5e20); color:#fff; margin-top:48px; padding:48px 0;
  border-top:4px solid var(--main-dark)
}
footer.text-light h6{ color:var(--accent) }
footer.text-light a{ color:#fff }
footer.text-light a:hover{ text-decoration:underline }

/* ---------- Detail modal ---------- */
.dtl-backdrop{ position:fixed; inset:0; background:rgba(0,0,0,.35); display:grid; place-items:center; z-index:1300 }
.dtl-dialog{
  background:#fff; border-radius:14px; max-width:900px; width:92%; max-height:90vh; overflow:auto;
  box-shadow:var(--shadow-lg); padding:20px; position:relative
}
.dtl-close{
  position:absolute; top:10px; right:10px; width:36px; height:36px; border:0; border-radius:50%;
  background:#f1f5f2; font-size:20px; cursor:pointer
}
.dtl-head{ display:flex; align-items:center; gap:16px }
.dtl-head img{ width:100px; height:100px; object-fit:cover; border-radius:10px }
.dtl-badges .tag{ display:inline-block; padding:4px 8px; border-radius:999px; background:#e8f5e9; color:#1b5e20; font-size:12px; margin:4px 6px 0 0 }
.dtl-rows{ display:grid; grid-template-columns:repeat(auto-fill,minmax(240px,1fr)); gap:10px; margin-top:10px }
.dtl-row{ border:1px solid var(--border); background:#fafdfb; border-radius:10px; padding:10px }
.dtl-row .k{ font-size:12px; color:var(--muted); text-transform:uppercase }
.dtl-row .v{ font-size:13px; color:var(--text) }
.btn-main{ background:var(--grad); color:#fff; border:0; border-radius:10px; padding:8px 14px; font-weight:700; cursor:pointer }
.btn-main:hover{ opacity:.92 }

/* ---------- Utilities ---------- */
.badge{ font-weight:700 }
.text-muted{ color:#6b7d6b !important }
.small{ font-size:12.5px }

/* ---------- Responsive ---------- */
@media (max-width: 1200px){
  .category-scroll{ grid-template-columns:repeat(auto-fill,minmax(110px,1fr)) }
}
@media (max-width: 992px){
  .hero .main img{ height:240px }
  .benefits-v3 .bcard{ grid-template-columns:44px 1fr 200px }
}
@media (max-width: 768px){
  body{ padding-top:66px }
  .site-header{ height:66px }
  .site-header img.logo{ width:96px }
  .header-search .form-control, .header-search .btn{ height:40px }
  .top-banner{ height:36px }

  .hero .main img{ height:220px }
  .hero .mini img{ height:120px }

  /* Benefit items x·∫øp 2 h√†ng ‚Äì badge l√™n c·∫°nh ti√™u ƒë·ªÅ */
  .benefits-v3 .bcard{
    grid-template-columns:44px 1fr;
    grid-template-areas:
      "ic ttl"
      "ic sub";
  }
  .benefits-v3 .bcard .benefit-note{
    grid-area: ttl; justify-self:end; margin-left:8px
  }

  .category-scroll{ grid-template-columns:repeat(auto-fill,minmax(100px,1fr)) }
  .cardx img.thumb{ height:160px }
}
@media (max-width: 480px){
  .category-scroll{ grid-template-columns:repeat(auto-fill,minmax(92px,1fr)) }
  .cardx img.thumb{ height:150px }
}

</style>

   
</head>
<body class="theme-bamboo">

<header class="site-header">
  <div class="wrap">
    <a id="logoLink" href="#" class="d-flex align-items-center text-decoration-none">
      <img src="https://drive.google.com/thumbnail?id=1e9N6rgsTP5vYtKl4Lwq801dfteYLbx_F&sz=w160" class="logo" alt="2606AI logo">
    </a>
    <form id="filter-form" class="header-search d-flex gap-2 m-0" onsubmit="return false;">
      <div class="input-group w-100">
        <input id="searchBox" class="form-control" placeholder="T√¨m s·∫£n ph·∫©m... (ID, m√¥ t·∫£)" aria-label="T√¨m s·∫£n ph·∫©m">
        <button id="searchBtn" class="btn btn-primary" type="button">T√¨m</button>
      </div>
    </form>
  </div>
</header>

<div class="top-banner" role="region" aria-label="Th√¥ng b√°o">
  <div class="wrap">
    <div class="marquee">
      ƒê·ªÉ ƒë·∫£m b·∫£o quy·ªÅn l·ª£i h√£y th√¥ng b√°o v·ªõi 2606AI.VN khi b·∫°n ƒë√£ ch·ªët ƒë∆°n h√†ng &nbsp; ‚Ä¢ &nbsp;
      Ngu·ªìn thu c·ªßa 2606AI.VN ƒë·∫øn t·ª´ qu·∫£ng c√°o &nbsp; ‚Ä¢ &nbsp;
      C√≥ s·ª± h·ªó tr·ª£ c·ªßa 2606AI.VN t·ª± tin s·∫£n xu·∫•t m·ªçi s·∫£n ph·∫©m
    </div>
  </div>
</div>

<div class="container-fluid my-3">
  <div class="row g-3">
    <!-- Sidebar -->
<div id="leftCol" class="col-lg-3 col-md-4">

  <!-- ===== Benefits ===== -->
  <div class="sidebar-box benefits-v3">
    <h6 class="mb-2">Ch√∫ng t√¥i c√≥ g√¨ cho b·∫°n...</h6>
    <div class="grid">

      <div class="bcard" data-benefit="b1" role="button" tabindex="0" aria-label="Tham kh·∫£o 10,000+ m·∫´u s·∫£n ph·∫©m">
        <span class="benefit-note benefit-free">Mi·ªÖn ph√≠</span>
        <div class="ic">üß©</div>
        <div class="ttl">1. Tham kh·∫£o 10,000+ m·∫´u s·∫£n ph·∫©m</div>
        <div class="sub">Kh√¥ng lo thi·∫øu √Ω t∆∞·ªüng</div>
      </div>

      <div class="bcard" data-benefit="b2" role="button" tabindex="0" aria-label="500+ nh√† cung c·∫•p v√† x∆∞·ªüng s·∫£n xu·∫•t">
        <span class="benefit-note benefit-free">Mi·ªÖn ph√≠</span>
        <div class="ic">üè≠</div>
        <div class="ttl">2. H∆°n 500+ nh√† cung c·∫•p v√† x∆∞·ªüng s·∫£n xu·∫•t</div>
        <div class="sub">B√°o gi√° nhanh, ƒëa d·∫°ng, d·ªÖ d√†ng so s√°nh gi√°</div>
      </div>

      <div class="bcard" data-benefit="b3" role="button" tabindex="0" aria-label="H·ªó tr·ª£ t∆∞ v·∫•n s·∫£n xu·∫•t">
        <span class="benefit-note benefit-free">Mi·ªÖn ph√≠</span>
        <div class="ic">üí¨</div>
        <div class="ttl">3. H·ªó tr·ª£ t∆∞ v·∫•n s·∫£n xu·∫•t</div>
        <div class="sub">Ph·∫£n h·ªìi nhanh, ƒë√°p ·ª©ng nhi·ªÅu nhu c·∫ßu</div>
      </div>

      <div class="bcard" data-benefit="b4" role="button" tabindex="0" aria-label="H·ªó tr·ª£ thi·∫øt k·∫ø 2D, 3D s·∫£n xu·∫•t">
        <span class="benefit-note benefit-free">Mi·ªÖn ph√≠</span>
        <div class="ic">üé®</div>
        <div class="ttl">4. H·ªó tr·ª£ thi·∫øt k·∫ø 2D, 3D s·∫£n xu·∫•t</div>
        <div class="sub">Mockup mi·ªÖn ph√≠ cho c√°c ƒë∆°n h√†ng ch·ªët</div>
      </div>

      <div class="bcard" data-benefit="b5" role="button" tabindex="0" aria-label="H·∫≠u c·∫ßn v·∫≠n chuy·ªÉn v√† ƒë√≥ng g√≥i h√†ng">
        <span class="benefit-note benefit-paid">C√≥ ph√≠</span>
        <div class="ic">üì¶</div>
        <div class="ttl">5. H·∫≠u c·∫ßn v·∫≠n chuy·ªÉn v√† ƒë√≥ng g√≥i h√†ng</div>
        <div class="sub">D·ªãch v·ª• nhanh chuy√™n nghi·ªáp</div>
      </div>

      <div class="bcard" data-benefit="b6" role="button" tabindex="0" aria-label="H·ªó tr·ª£ gi·∫£i quy·∫øt tranh ch·∫•p">
        <span class="benefit-note benefit-paid">C√≥ ph√≠</span>
        <div class="ic">üõ°Ô∏è</div>
        <div class="ttl">6. H·ªó tr·ª£ gi·∫£i quy·∫øt tranh ch·∫•p</div>
        <div class="sub">B·∫£o v·ªá quy·ªÅn l·ª£i kh√°ch h√†ng</div>
      </div>

    </div>
  </div>
  <!-- /Benefits -->

  <!-- ===== X∆Ø·ªûNG ƒê·ªÄ XU·∫§T ===== -->
  <div id="workshopBox" class="sidebar-box workshop-box">
    <h6 class="fw-bold mb-2 d-flex align-items-center justify-content-between">
      <span class="d-inline-flex align-items-center gap-2">
        X∆∞·ªüng ƒë·ªÅ xu·∫•t
        <span id="workshopCount" class="badge rounded-pill text-bg-primary" style="display:none">0</span>
      </span>
    </h6>

    <div id="workshopList" class="d-flex flex-column gap-2"></div>
    <div id="workshopEmpty" class="small text-muted">(debug) Box ƒë√£ hi·ªÉn th·ªã ‚Äì ch·ªù d·ªØ li·ªáu qu·∫£ng c√°o.</div>

    <div class="mt-2 text-center">
      <a id="workshopContactBtn2" href="#" target="_blank" rel="noopener"
         class="btn btn-sm fw-bold px-3"
         style="border-radius:999px;background:#ffca28;color:#0d47a1;border:none">
        üì¢ LI√äN H·ªÜ ƒê·∫∂T QU·∫¢NG C√ÅO
      </a>
    </div>
  </div>
  <!-- /X∆Ø·ªûNG ƒê·ªÄ XU·∫§T -->

</div>


    <!-- Content -->
    <div class="col-lg-9 col-md-8">
      <!-- HERO -->
      <div class="hero row g-2">
        <div class="col-md-8 main">
          <div id="heroMain" class="carousel slide" data-bs-ride="carousel" data-bs-interval="4000">

            <div class="carousel-inner">
              <div class="carousel-item active"><img loading="lazy" class="d-block w-100" src="https://picsum.photos/1200/300?random=11" alt="Banner 1"></div>
              <div class="carousel-item"><img loading="lazy" class="d-block w-100" src="https://picsum.photos/1200/300?random=12" alt="Banner 2"></div>
              <div class="carousel-item"><img loading="lazy" class="d-block w-100" src="https://picsum.photos/1200/300?random=13" alt="Banner 3"></div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#heroMain" data-bs-slide="prev"><span class="carousel-control-prev-icon"></span></button>
            <button class="carousel-control-next" type="button" data-bs-target="#heroMain" data-bs-slide="next"><span class="carousel-control-next-icon"></span></button>
          </div>
        </div>
        <div class="col-md-4 d-flex flex-column gap-2 mini">
          <div id="heroRight1" class="carousel slide" data-bs-ride="carousel" data-bs-interval="3500">
            <div class="carousel-inner">
              <div class="carousel-item active"><img loading="lazy" src="https://picsum.photos/600/145?random=21" class="d-block w-100" alt="Promo 1"></div>
              <div class="carousel-item"><img loading="lazy" src="https://picsum.photos/600/145?random=22" class="d-block w-100" alt="Promo 2"></div>
            </div>
          </div>
          <div id="heroRight2" class="carousel slide" data-bs-ride="carousel" data-bs-interval="4200">
            <div class="carousel-inner">
              <div class="carousel-item active"><img loading="lazy" src="https://picsum.photos/600/145?random=23" class="d-block w-100" alt="Promo 3"></div>
              <div class="carousel-item"><img loading="lazy" src="https://picsum.photos/600/145?random=24" class="d-block w-100" alt="Promo 4"></div>
            </div>
          </div>
        </div>
      </div>
<!-- QUICK CATEGORY (√¥ l·ªõn KH√ÅC, QU√Ä T·∫∂NG...) -->
<div id="quickCatsTop" class="mt-3 mb-3"></div>

    <!-- Danh m·ª•c (Group chips + Category scroller) -->
<div class="category-box mb-3">
  <!-- Dots indicator -->
<div id="groupDots" class="group-dots" aria-label="V·ªã tr√≠ trang nh√≥m"></div>

  <!-- GROUP BAR -->
  <div class="group-bar-wrapper">
  <button class="group-arrow left" id="groupPrev">‚Äπ</button>
  <div class="group-bar-scroll" id="groupBar">
    <!-- JS render chip group v√†o ƒë√¢y -->
  </div>
  <button class="group-arrow right" id="groupNext">‚Ä∫</button>
</div>


 <div class="category-wrapper">
  <button id="catPrev" class="cat-arrow left"  type="button" aria-label="prev">‚Äπ</button>
  <div id="categoryScroll" class="category-scroll"></div>
  <button id="catNext" class="cat-arrow right" type="button" aria-label="next">‚Ä∫</button>
</div>


<script>
(function(){
  const wrap = document.getElementById('categoryScroll');
  const prev = document.getElementById('catPrev');
  const next = document.getElementById('catNext');
  if (!wrap || !prev || !next) return;

  const eps  = 4; // ch·ªëng sai s·ªë 1-2px
  const getMax = () => Math.max(0, wrap.scrollWidth - wrap.clientWidth);
  const step   = () => Math.max(240, Math.round(wrap.clientWidth * 0.9));
  const clamp  = (n, min, max) => Math.min(max, Math.max(min, n));

  function go(dir){
    const max = getMax();
    const target = clamp(wrap.scrollLeft + dir * step(), 0, max);
    wrap.scrollTo({ left: target, behavior: 'smooth' });
    // backup: ƒë·∫£m b·∫£o c·∫≠p nh·∫≠t state k·ªÉ c·∫£ khi event scroll kh√¥ng b·∫Øn
    setTimeout(update, 350);
  }

  function update(){
    const max = getMax();
    const atStart = wrap.scrollLeft <= eps;
    const atEnd   = wrap.scrollLeft >= (max - eps);
    const noScroll = max <= eps;

    prev.disabled = atStart || noScroll;
    next.disabled = atEnd   || noScroll;

    prev.classList.toggle('is-disabled', prev.disabled);
    next.classList.toggle('is-disabled', next.disabled);
  }

  prev.addEventListener('click', () => go(-1));
  next.addEventListener('click', () => go( 1));
  wrap.addEventListener('scroll', update, { passive:true });
  window.addEventListener('resize', () => setTimeout(update, 50));

  update();
  setTimeout(update, 300); // khi ·∫£nh/render xong
})();

 
</script>


      <!-- Th·ªëng k√™ + Pagination -->
<div class="stats-row row g-2 align-items-center">
  <!-- B√™n tr√°i -->
  <div class="col-auto d-flex align-items-center found-count">
    <span class="lbl">T√¨m th·∫•y</span>
    <span id="totalCount" class="badge text-bg-primary">0</span>
    <button id="clearFiltersBtn2" class="btn btn-sm btn-outline-danger ms-2">X√≥a b·ªô l·ªçc</button>
  </div>

  <!-- B√™n ph·∫£i -->
  <div class="col text-end">
    <div id="pagerTop" class="d-inline-flex"></div>
  </div>
</div>



      <!-- Grid -->
      <div id="productGrid" class="row row-cols-2 row-cols-md-3 row-cols-lg-6 g-2" aria-live="polite"></div>

      <!-- Pagination Bottom -->
      <div id="pagerBottom" class="mt-3 pager-bar"></div>

      <!-- ===== Hero qu·∫£ng c√°o ƒë·∫∑t d∆∞·ªõi b·∫£ng card (FOOTER workshop) ===== -->
      <div class="hero-workshop my-3">
        <div id="footerworkshop" class="carousel slide" data-bs-ride="carousel" data-bs-interval="4000">
          <div class="carousel-inner">
            <div class="carousel-item active">
              <img loading="lazy" src="https://picsum.photos/1200/200?random=91" class="d-block w-100" alt="Qu·∫£ng c√°o 1">
            </div>
            <div class="carousel-item">
              <img loading="lazy" src="https://picsum.photos/1200/200?random=92" class="d-block w-100" alt="Qu·∫£ng c√°o 2">
            </div>
            <div class="carousel-item">
              <img loading="lazy" src="https://picsum.photos/1200/200?random=93" class="d-block w-100" alt="Qu·∫£ng c√°o 3">
            </div>
          </div>
          <button class="carousel-control-prev" type="button" data-bs-target="#footerworkshop" data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
          </button>
          <button class="carousel-control-next" type="button" data-bs-target="#footerworkshop" data-bs-slide="next">
            <span class="carousel-control-next-icon"></span>
          </button>
        </div>
      </div>
      <!-- ===== /Hero qu·∫£ng c√°o ===== -->

    </div>
  </div>
</div>

<!-- Offcanvas: Gi·ªè h√†ng -->
<div class="offcanvas offcanvas-end" tabindex="-1" id="cartCanvas" aria-labelledby="cartCanvasLabel">
  <div class="offcanvas-header">
    <h5 id="cartCanvasLabel" class="mb-0">Gi·ªè h√†ng</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
  </div>
  <div class="offcanvas-body">
    <div id="cartList"></div>

    <div class="summary-box d-flex justify-content-between align-items-center">
      <span>T·ªïng c·ªông</span><span id="cartTotal">0 ƒë</span>
    </div>

    <button class="btn btn-danger w-100 mb-2" id="clearCartBtn">X√≥a to√†n b·ªô</button>

    <input id="buyerName" class="form-control mb-2" placeholder="H·ªç v√† t√™n" aria-label="H·ªç v√† t√™n">
    <input id="buyerEmail" class="form-control mb-2" placeholder="Email" aria-label="Email">
    <input id="buyerPhone" class="form-control mb-2" placeholder="S·ªë ƒëi·ªán tho·∫°i" aria-label="S·ªë ƒëi·ªán tho·∫°i">
    <input id="buyerAddress" class="form-control mb-2" placeholder="ƒê·ªãa ch·ªâ nh·∫≠n h√†ng" aria-label="ƒê·ªãa ch·ªâ nh·∫≠n h√†ng">
    <textarea id="buyerNote" class="form-control mb-2" placeholder="Ghi ch√∫" aria-label="Ghi ch√∫"></textarea>

    <label class="form-label mt-2">T·∫£i t·ªáp y√™u c·∫ßu / thi·∫øt k·∫ø (t√πy ch·ªçn)</label>
    <input id="buyerFile" type="file" class="form-control mb-2" accept=".pdf,.doc,.docx,.xls,.xlsx,.png,.jpg,.jpeg,.zip">

    <div class="row g-2">
      <div class="col-12">
        <label class="form-label">D·ªãch v·ª• L·∫§Y B√ÅO GI√Å H·ªò (t√πy ch·ªçn)</label>
        <select id="servicePlan" class="form-select">
          <option value="">‚Äî Kh√¥ng ch·ªçn ‚Äî</option>
          <option value="100000-3">100.000 ƒë / 3 b√°o gi√°</option>
          <option value="500000-10">500.000 ƒë / 10 b√°o gi√°</option>
        </select>
      </div>
      <div class="col-12">
        <div class="form-check mt-2">
          <input class="form-check-input" type="checkbox" id="fileQuote">
          <label class="form-check-label" for="fileQuote">B√°o gi√° theo t·ªáp t·∫£i l√™n</label>
        </div>
      </div>
    </div>

    <div class="alert alert-secondary mt-3 mb-2" style="font-size:12px">
      <div><strong>H∆∞·ªõng d·∫´n:</strong></div>
      <div>1) B·∫°n c·∫ßn l√†m gi·ªëng m·∫´u n√†o ho·∫∑c mua s·∫£n ph·∫©m g√¨ b·∫•m g·ª≠i, ch√∫ng t√¥i s·∫Ω s·ªõm li√™n h·ªá l·∫°i sau.</div>
      <div>2) Ghi r√µ y√™u c·∫ßu s·∫Ω gi√∫p ch√∫ng t√¥i t∆∞ v·∫•n cho b·∫°n d·ªÖ d√†ng h∆°n.</div>
      <div>3) CSKH c·ªßa 2606ai.vn s·∫Ω tr·ª±c ti·∫øp li√™n h·ªá b·∫°n trong v√≤ng 24h (n·∫øu qu√° th·ªùi gian n√†y, vui l√≤ng li√™n h·ªá l·∫°i).</div>
    </div>

    <button class="btn btn-success w-100" id="submitOrderBtn">G·ª≠i ƒë∆°n h√†ng</button>
  </div>
</div>

<!-- Offcanvas: B·ªô l·ªçc -->
<div class="offcanvas offcanvas-end" tabindex="-1" id="filterPanel" aria-labelledby="filterPanelLabel">
  <div class="offcanvas-header">
    <h5 id="filterPanelLabel" class="mb-0">B·ªô l·ªçc n√¢ng cao</h5>
    <div class="d-flex gap-2">
      <button type="button" class="btn btn-outline-danger btn-sm" id="clearFiltersBtn">X√≥a b·ªô l·ªçc</button>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
    </div>
  </div>
  <div class="offcanvas-body">
    <h6>·∫§N PH·∫®M TH∆Ø∆†NG HI·ªÜU</h6><div id="brandBox" class="mb-3"></div>
    <h6>TYPE</h6><div id="typeBox" class="mb-3"></div>
    <h6>LO·∫†I S·∫¢N PH·∫®M</h6><div id="loaiBox" class="mb-3"></div>
    <h6>CH√ö √ù</h6><div id="noteBox" class="mb-3"></div>
     <h6>GROUP (NH√ìM)</h6><div id="groupBox" class="mb-3"></div>

  </div>
</div>

<!-- Offcanvas: Danh s√°ch x∆∞·ªüng -->
<div class="offcanvas offcanvas-end" tabindex="-1" id="suppliersCanvas" aria-labelledby="suppliersLabel">
  <div class="offcanvas-header">
    <h5 id="suppliersLabel" class="mb-0">Danh s√°ch x∆∞·ªüng</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
  </div>
  <div class="offcanvas-body">
    <div class="sup-toolbar">
      <div class="row g-2 align-items-center">
        <div class="col-12">
          <input id="supSearch" class="form-control" placeholder="T√¨m theo t√™n, ƒë·ªãa ch·ªâ, ch·ª©ng nh·∫≠n‚Ä¶">
        </div>
        <div class="col-7 d-flex align-items-center gap-2">
          <select id="supSort" class="form-select form-select-sm" style="max-width:210px">
            <option value="name">S·∫Øp x·∫øp A‚ÜíZ (T√™n)</option>
            <option value="addr">Theo ƒë·ªãa ch·ªâ</option>
          </select>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="supHasSite">
            <label class="form-check-label small" for="supHasSite">Ch·ªâ x∆∞·ªüng c√≥ website</label>
          </div>
        </div>
        <div class="col-5">
          <div class="counter justify-content-end">
            <span class="pill" id="suppliersCount">0</span>
            <span class="small">x∆∞·ªüng ph√π h·ª£p</span>
          </div>
        </div>
      </div>
    </div>

    <div id="suppliersList" class="supplier-list">Ch∆∞a c√≥ d·ªØ li·ªáu.</div>

    <div class="mt-3">
      <a id="workshopContactBtn" href="#" target="_blank" rel="noopener"
         class="btn btn-primary w-100">LI√äN H·ªÜ ƒê·∫∂T QU·∫¢NG C√ÅO</a>
    </div>
  </div>
</div>

<!-- ===== Modal chi ti·∫øt L·ª£i √≠ch ===== -->
<div class="modal fade" id="benefitModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content" style="border-radius:16px">
      <div class="modal-header" style="background:var(--main-grad);color:#fff;border:0">
        <h5 class="modal-title" id="benefitTitle">Chi ti·∫øt</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" style="filter:invert(1)"></button>
      </div>
      <div class="modal-body">
        <div id="benefitLead" class="text-muted mb-2"></div>
        <ul id="benefitList" class="mb-2"></ul>
        <div id="benefitNote" class="small text-muted"></div>
      </div>
      <div class="modal-footer" style="border:0">
        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">ƒê√£ hi·ªÉu</button>
      </div>
    </div>
  </div>
</div>

<!-- === FABs ‚Äì C·ª§M N√öT N·ªîI ƒê·ªíNG NH·∫§T === -->
<div id="fabs" class="fabs">

  <!-- N√∫t m·ªü b·ªô l·ªçc -->
  <button id="filterFab" class="fab" aria-label="M·ªü b·ªô l·ªçc">
    <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24"
         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <polygon points="22 3 2 3 10 12 10 19 14 21 14 12 22 3"></polygon>
    </svg>
    <span id="filterFabCount" class="fab-badge">0</span>
  </button>

  <!-- N√∫t gi·ªè h√†ng -->
  <button id="cartFab" class="fab" aria-label="M·ªü gi·ªè h√†ng">
    üõí
    <span id="cartFabCount" class="fab-badge">0</span>
  </button>

  <!-- N√∫t danh s√°ch x∆∞·ªüng -->
  <button id="suppliersFab" class="fab" aria-label="Danh s√°ch x∆∞·ªüng">
    üè≠
  </button>

  <!-- N√∫t chat Zalo -->
  <a id="zaloFab" class="fab" aria-label="Li√™n h·ªá Zalo" href="https://zalo.me/123456789"
     target="_blank" rel="noopener">
    üí¨
  </a>

</div>

<!-- ======= CSS: FABs ‚Äì ƒë·ªìng nh·∫•t gi·ªØa m·ªçi thi·∫øt b·ªã ======= -->

<div id="errbox" role="alert" aria-live="assertive"></div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
window.ZALO_URL = "https://zalo.me/123456789";   // <-- thay link th·∫≠t c·ªßa b·∫°n
window.WORKSHOP_CONTACT_URL = "https://zalo.me/123456789"; // n·∫øu mu·ªën d√πng chung
  
/* ===== ERROR ===== */
(function(){
  const box=document.getElementById('errbox');
  function show(msg){ box.style.display='block'; box.textContent='[ERROR] '+msg; console.error(msg); }
  window.addEventListener('error', e=>show(e.message+(e.filename?(' @ '+e.filename+':'+e.lineno):'')));
  window.addEventListener('unhandledrejection', e=>show('Promise rejected: '+((e.reason&&e.reason.message)||e.reason)));
})();

document.addEventListener('DOMContentLoaded', () => {
  /* ==== CONFIG ===== */
   window.API_URL = "https://script.google.com/macros/s/AKfycbzq7L4h05H8JJEPsStlsixbrNJ1bFbe7M8A8Qsn5AoodHw35DMNfIBPUOcgQwmKoBFC/exec";
   window.API_KEY = "";
   window.AUTO_OPEN_ON_ADD = false;

  // ‚úÖ ƒêo·∫°n th√™m m·ªõi: di chuy·ªÉn #groupDots ra ngo√†i .category-box
  const catBox = document.querySelector('.category-box');
  const dots   = document.getElementById('groupDots');
  if (catBox && dots && catBox.contains(dots)) {
    catBox.after(dots);
  }


  // === StatsBar: ƒë·ªïi nh√£n & ƒë∆∞a pagerTop l√™n c√πng h√†ng ===
const statsRow = document.querySelector('#statsBar .d-flex.align-items-center');
if (statsRow) {
  const lbl = statsRow.querySelector('.fw-semibold');
  if (lbl) lbl.textContent = 'T√¨m th·∫•y';

  // cho 2 b√™n ƒë·ª©ng c√πng h√†ng (tr√°i: nh√£n + badge + x√≥a; ph·∫£i: pager)
  statsRow.classList.add('justify-content-between','flex-wrap','w-100');

  const pagerTop = document.getElementById('pagerTop');
  if (pagerTop) {
    pagerTop.classList.remove('mb-2');     // b·ªè margin th·ª´a
    statsRow.appendChild(pagerTop);        // ƒë∆∞a pagerTop l√™n c√πng h√†ng
  }
}
/* === Helper: chia m·∫£ng th√†nh c√°c trang theo s·ªë c·ªôt/ trang === */
function chunk(arr, size){ const out=[]; for(let i=0;i<arr.length;i+=size) out.push(arr.slice(i,i+size)); return out; }
/* s·ªë c·ªôt/ trang hi·ªán t·∫°i (theo CSS var --cols) */
function getCols(){
  const el = document.querySelector('.group-bar-scroll') || document.getElementById('groupBar');
  const n = getComputedStyle(el).getPropertyValue('--cols');
  return Math.max(1, parseInt(n,10) || 4);
}

// Map t√™n nh√≥m -> icon (URL) ho·∫∑c emoji
const GROUP_ICONS = {
  "QU√Ä T·∫∂NG 247 EXPRESS (ƒê·ªëi t√°c)":"https://drive.google.com/thumbnail?id=1ixc_p6X925a0JpSG4YIWwpyauVmhRakI&sz=w1000",
  "QU√Ä T·∫∂NG ·∫§N PH·∫®M TH∆Ø∆†NG HI·ªÜU":"https://img.icons8.com/fluency/96/advertising.png",
  "QU√Ä T·∫∂NG S·∫¢N PH·∫®M TH∆Ø∆†NG HI·ªÜU":"https://img.icons8.com/fluency/96/product.png",
  "QU√Ä T·∫∂NG T·ªî CH·ª®C S·ª∞ KI·ªÜN":"https://img.icons8.com/fluency/96/conference-foreground-selected.png",
  "QU√Ä T·∫∂NG PH·ª§ KI·ªÜN TH∆Ø∆†NG HI·ªÜU":"https://img.icons8.com/fluency/96/electronics.png",
  "KH√ÅC":"https://img.icons8.com/fluency/96/more.png"
};

function iconForGroup(name){
  return GROUP_ICONS[name] || GROUP_ICONS["KH√ÅC"];
}

// === TH·ª® T·ª∞ HI·ªÇN TH·ªä NH√ìM (TR√ÅI ‚Üí PH·∫¢I) ===
const GROUP_ORDER_RAW = [
  "QU√Ä T·∫∂NG 247 EXPRESS (ƒê·ªëi t√°c)",
  "QU√Ä T·∫∂NG T·ªî CH·ª®C S·ª∞ KI·ªÜN",
  "QU√Ä T·∫∂NG PH·ª§ KI·ªÜN TH∆Ø∆†NG HI·ªÜU",
  "QU√Ä T·∫∂NG S·∫¢N PH·∫®M TH∆Ø∆†NG HI·ªÜU",
  "QU√Ä T·∫∂NG ·∫§N PH·∫®M TH∆Ø∆†NG HI·ªÜU",
  "KH√ÅC"
];

// chu·∫©n ho√° (b·ªè d·∫•u, lower, trim)
function _normalizeVN(s){
  return String(s || '')
    .toLowerCase()
    .normalize('NFD')
    .replace(/[\u0300-\u036f]/g, '')
    .trim();
}

// l·∫•y t√™n nh√≥m d√π l√† string hay object
function _nameOf(g){
  if (typeof g === 'string') return g;
  return g?.label || g?.name || g?.id || '';
}

// cache m·∫£ng chu·∫©n ho√° ƒë·ªÉ so nhanh
const GROUP_ORDER_NORM = GROUP_ORDER_RAW.map(_normalizeVN);

// S·∫Øp x·∫øp theo th·ª© t·ª± ƒë·ªãnh nghƒ©a
window.orderGroups = function(groups){
  const arr = (groups || []).slice();

  arr.sort((a, b) => {
    const na = _normalizeVN(_nameOf(a));
    const nb = _normalizeVN(_nameOf(b));

    const ai = GROUP_ORDER_NORM.indexOf(na);
    const bi = GROUP_ORDER_NORM.indexOf(nb);

    if (ai !== -1 && bi !== -1) return ai - bi; // c·∫£ 2 ƒë·ªÅu c√≥ trong b·∫£ng
    if (ai !== -1) return -1;                   // a c√≥ ∆∞u ti√™n ‚Üí l√™n tr∆∞·ªõc
    if (bi !== -1) return 1;                    // b c√≥ ∆∞u ti√™n ‚Üí l√™n tr∆∞·ªõc

    // c√≤n l·∫°i: alpha nh·∫π theo t√™n ƒë√£ chu·∫©n ho√°
    return na.localeCompare(nb, 'vi');
  });

  return arr;
};



function renderGroups(groups){
  const bar  = document.getElementById('groupBar');
  const dotsBox = document.getElementById('groupDots');
  if(!bar || !dotsBox) return;

  const list = groups || [];

  bar.innerHTML = list.map(g => `
    <div class="group-chip ${state.group===g?'active':''}"
         data-action="select-group" data-val="${esc(g)}">
      <span class="chip-icon">
        <img src="${esc(iconForGroup(g))}" alt="">
      </span>
      <span class="chip-text">${esc(g)}</span>
    </div>
  `).join('');

  // Dots (n·∫øu v·∫´n mu·ªën gi·ªØ)
  dotsBox.innerHTML = list.map((_,i)=>
    `<span class="dot ${state.group===list[i]?'active':''}" data-idx="${i}"></span>`
  ).join('');

  window._lastGroups = list;
}

/* === M≈©i t√™n & Dots === */
const groupBarEl = document.getElementById('groupBar');
const dotBox     = document.getElementById('groupDots');
const btnPrev    = document.getElementById('groupPrev');
const btnNext    = document.getElementById('groupNext');

function currentPage(){
  if(!groupBarEl) return 0;
  const w = groupBarEl.clientWidth || 1;
  return Math.round(groupBarEl.scrollLeft / w);
}
function pagesCount(){
  return groupBarEl ? Math.ceil(groupBarEl.scrollWidth / (groupBarEl.clientWidth||1)) : 1;
}
function scrollToPage(p){
  const w = groupBarEl.clientWidth;
  groupBarEl.scrollTo({ left: p*w, behavior: 'smooth' });
}

function updateGroupArrows(){
  if(!groupBarEl || !btnPrev || !btnNext) return;
  const p = currentPage(), pc = pagesCount();
  btnPrev.disabled = (p <= 0);
  btnNext.disabled = (p >= pc-1);
}
function updateGroupDots(){
  const dots = document.querySelectorAll('#groupDots .dot');
  const chips = document.querySelectorAll('#groupBar .group-chip');
  let activeIdx = -1;
  chips.forEach((c,i)=>{ if(c.dataset.val === (state.group||'')) activeIdx = i; });
  dots.forEach((d,i)=> d.classList.toggle('active', i===activeIdx));
}

btnPrev?.addEventListener('click', ()=> scrollToPage(Math.max(0, currentPage()-1)));
btnNext?.addEventListener('click', ()=> scrollToPage(Math.min(pagesCount()-1, currentPage()+1)));
groupBarEl?.addEventListener('scroll', ()=>{
  // debounce nh·∫π cho m∆∞·ª£t
  clearTimeout(groupBarEl._t); groupBarEl._t = setTimeout(()=>{
    updateGroupArrows(); updateGroupDots();
  }, 60);
});
dotBox?.addEventListener('click', (e)=>{
  const dot = e.target.closest('.dot'); if(!dot) return;
  const idx = Number(dot.dataset.idx)||0;
  const chips = document.querySelectorAll('#groupBar .group-chip');
  const chip = chips[idx];
  if(chip){
    state.group = chip.dataset.val || '';
    state.page = 1;
    updateGroupUI();       // ƒë·ªïi active chip + ink-bar
    updateGroupDots();     // ch·∫•m ƒë·ªïi m√†u
    fetchPage();           // n·∫°p d·ªØ li·ªáu theo group
    // Scroll chip ƒë√≥ ra gi·ªØa (n·∫øu c·∫ßn; v·ªõi layout grid s·∫Ω kh√¥ng cu·ªôn, nh∆∞ng ƒë·ªÉ ph√≤ng)
    chip.scrollIntoView({behavior:'smooth', inline:'center', block:'nearest'});
  }
});

window.addEventListener('resize', ()=>{
  // Re-render khi ƒë·ªïi breakpoint ƒë·ªÉ s·ªë c·ªôt/ trang c·∫≠p nh·∫≠t
  if(window._repaint_t){ clearTimeout(window._repaint_t); }
  window._repaint_t = setTimeout(()=> renderGroups((window._lastGroups)||[]), 120);
});

// Base & ·∫£nh d·ª± ph√≤ng (d√πng link tuy·ªát ƒë·ªëi)
const ICON_FALLBACK = 'https://placehold.co/44x44?text=%20&bg=E8F5E9&fc=2E7D32';

// N·∫øu b·∫°n c√≥ th∆∞ m·ª•c icon ri√™ng, c√≥ th·ªÉ d√πng th√™m base:
const ICON_BASE = ''; // vd: 'https://2606ai.github.io/web2606/assets/cat/'

// Helper: nh·∫≠n t√™n file ho·∫∑c URL tuy·ªát ƒë·ªëi ‚Üí tr·∫£ URL h·ª£p l·ªá
function iconUrl(u){
  if (!u) return ICON_FALLBACK;
  if (/^https?:\/\//i.test(u)) return u;          // ƒë√£ l√† URL ƒë·∫ßy ƒë·ªß
  if (ICON_BASE) return new URL(u, ICON_BASE).href;
  return ICON_FALLBACK;
}
/* === Quick Category strip (√¥ l·ªõn ph√≠a tr√™n) ‚Äì render t·ª´ CAT_CONFIG === */
function buildQuickCatsTopHTML(){
  return `
  <div class="category-scroll" data-quick-cats>
    ${CAT_CONFIG.map(cat => {
      const label = (cat.filters && cat.filters.category) ? cat.filters.category : cat.label;
      const icon = cat.icon || '';
      return `
      <a class="category-item" href="#"
         data-action="select-category"
         data-val="${label}">
         ${icon ? `<img class="cat-icon" src="${icon}" alt="${label}">` : ''}
         <div class="cat-title">${label}</div>
      </a>
      `;
    }).join('')}
  </div>`;
}


/* G·ªçi h√†m render cho v√πng √¥ l·ªõn ‚Äì b·∫°n c·∫ßn c√≥ s·∫µn container #quickCatsTop trong HTML */
function renderQuickCatsTop(allowedGroups){
  const box = document.getElementById('quickCatsTop');
  if (!box) return; // ch∆∞a c√≥ container th√¨ b·ªè qua
  box.innerHTML = buildQuickCatsTopHTML(allowedGroups);
}



/* G·ªçi h√†m render cho v√πng √¥ l·ªõn ‚Äì b·∫°n c·∫ßn c√≥ s·∫µn container #quickCatsTop trong HTML */
function renderQuickCatsTop(){
  const box = document.getElementById('quickCatsTop');
  if (!box) return;           // ch∆∞a c√≥ container th√¨ b·ªè qua
  box.innerHTML = buildQuickCatsTopHTML();
}
   
 // ===== CATEGORY CONFIG (m·ªói √¥ = 1 c·∫•u h√¨nh ri√™ng) =====
const CAT_CONFIG = [
  { id:'huy-chuong-phoi-san', label:'Huy ch∆∞∆°ng ph√¥i s·∫µn',
    icon:'https://drive.google.com/thumbnail?id=1e9N6rgsTP5vYtKl4Lwq801dfteYLbx_F&sz=w200', link:'#',
    filters:{ category:'Huy ch∆∞∆°ng ph√¥i s·∫µn' } },

  { id:'huy-chuong-chay-bo', label:'Huy ch∆∞∆°ng s·ª± ki·ªán ch·∫°y b·ªô',
    icon:'https://drive.google.com/thumbnail?id=1e9N6rgsTP5vYtKl4Lwq801dfteYLbx_F&sz=w200', link:'#',
    filters:{ category:'Huy ch∆∞∆°ng s·ª± ki·ªán ch·∫°y b·ªô' } },

  { id:'moc-khoa-cao-su', label:'M√≥c kh√≥a cao su',
    icon:'https://drive.google.com/thumbnail?id=1e9N6rgsTP5vYtKl4Lwq801dfteYLbx_F&sz=w200', link:'#',
    filters:{ category:'M√≥c kh√≥a cao su' } },

  { id:'moc-khoa-hop-kim', label:'M√≥c kh√≥a h·ª£p kim',
    icon:'https://drive.google.com/thumbnail?id=1e9N6rgsTP5vYtKl4Lwq801dfteYLbx_F&sz=w200', link:'#',
    filters:{ category:'M√≥c kh√≥a h·ª£p kim' } },

  { id:'moc-khoa-tet-2025', label:'M√≥c kh√≥a t·∫øt 2025',
    icon:'https://drive.google.com/thumbnail?id=1e9N6rgsTP5vYtKl4Lwq801dfteYLbx_F&sz=w200', link:'#',
    filters:{ category:'M√≥c kh√≥a t·∫øt 2025' } },

  { id:'moc-khoa-tet-2026', label:'M√≥c kh√≥a t·∫øt 2026',
    icon:'https://drive.google.com/thumbnail?id=1e9N6rgsTP5vYtKl4Lwq801dfteYLbx_F&sz=w200', link:'#',
    filters:{ category:'M√≥c kh√≥a t·∫øt 2026' } },

  { id:'moc-khoa-tet-2027', label:'M√≥c kh√≥a t·∫øt 2027',
    icon:'https://drive.google.com/thumbnail?id=1e9N6rgsTP5vYtKl4Lwq801dfteYLbx_F&sz=w200', link:'#',
    filters:{ category:'M√≥c kh√≥a t·∫øt 2027' } },

  { id:'moc-khoa-tet-2030', label:'M√≥c kh√≥a t·∫øt 2030',
    icon:'https://drive.google.com/thumbnail?id=1e9N6rgsTP5vYtKl4Lwq801dfteYLbx_F&sz=w200', link:'#',
    filters:{ category:'M√≥c kh√≥a t·∫øt 2030' } },

  { id:'moc-khoa-tet-2031', label:'M√≥c kh√≥a t·∫øt 2031',
    icon:'https://drive.google.com/thumbnail?id=1e9N6rgsTP5vYtKl4Lwq801dfteYLbx_F&sz=w200', link:'#',
    filters:{ category:'M√≥c kh√≥a t·∫øt 2031' } },

  { id:'moc-khoa-tet-2032', label:'M√≥c kh√≥a t·∫øt 2032',
    icon:'https://drive.google.com/thumbnail?id=1e9N6rgsTP5vYtKl4Lwq801dfteYLbx_F&sz=w200', link:'#',
    filters:{ category:'M√≥c kh√≥a t·∫øt 2032' } },

  { id:'moc-khoa-tet-2036', label:'M√≥c kh√≥a t·∫øt 2036',
    icon:'https://drive.google.com/thumbnail?id=1e9N6rgsTP5vYtKl4Lwq801dfteYLbx_F&sz=w200', link:'#',
    filters:{ category:'M√≥c kh√≥a t·∫øt 2036' } },
];

function renderCategoriesFromConfig(){
  const wrap = document.getElementById('categoryScroll'); // d√πng wrapper s·∫µn c√≥
  if (!wrap) return;

  wrap.innerHTML = CAT_CONFIG.map(c => `
    <a class="category-item"
       href="#"
       data-action="select-category"
       data-val="${c.filters?.category || ''}">
      <div class="icon">
        <img src="${c.icon}" alt="${c.label}" style="width:100%;height:100%;object-fit:contain">
      </div>
      <div class="label">${c.label}</div>
    </a>
  `).join('');
}


  
/* === GHI ƒê√à buildCategoryFromFacets ‚Üí g·ªçi renderGroups m·ªõi === */
function buildCategoryFromFacets(facets){
  const groups = facets?.groups_all || facets?.groups || [];

 // S·∫ÆP X·∫æP TH·ª® T·ª∞ NH√ìM TR∆Ø·ªöC KHI V·∫º
const orderedGroups = orderGroups(groups);
window._lastGroups = orderedGroups;
renderGroups(orderedGroups);


  // hi·ªáu ·ª©ng m·ªù nh·∫π khi c·∫≠p nh·∫≠t
  const catEl = document.getElementById('categoryScroll');
  if (catEl) catEl.classList.add('fade-out');

  // üîÅ THAY D√íNG N√ÄY
  // buildCategory(facets?.categories || []);
    buildCategory(facets?.categories || []);


  // c√°c box l·ªçc kh√°c gi·ªØ nguy√™n
  buildFilterBox('groupBox',  groups || [], 'group');
  buildFilterBox('typeBox',   facets?.types     || [], 'type');
  buildFilterBox('loaiBox',   facets?.loais     || [], 'loai');
  buildFilterBox('noteBox',   facets?.notes     || [], 'note');
  buildFilterBox('brandBox',  facets?.categories|| [], 'category');

  requestAnimationFrame(()=> catEl && catEl.classList.remove('fade-out'));
}


/* STATE */
/* STATE (global, safe) */
window.state = window.state || {
  page: 1,
  pageSize: 36,
  q: '',
  group: '',
  type: '',
  loai: '',
  note: '',
  category: '',
  totalPages: 1
};
const state = window.state;   // alias ƒë·ªÉ ph·∫ßn code d∆∞·ªõi v·∫´n d√πng `state`
// Th√™m 2 bi·∫øn to√†n c·ª•c c√≤n thi·∫øu
window.cart = window.cart || [];
window.products = window.products || {};


/* UTILS */
const fmtVND = n => (Number(n)||0).toLocaleString('vi-VN') + ' ƒë';
const esc = s => (s??'').toString().replace(/[&<>"]/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c]));
function badgeColor(txt){ if(!txt) return "#555"; const t=txt.toLowerCase(); if(t.includes("m·∫´u")||t.includes("sample")) return "#4caf50"; if(t.includes("gi·∫£m")||t.includes("sale")||t.includes("km")) return "#ff9800"; if(t.includes("g·∫•p")||t.includes("urgent")) return "#d32f2f"; return "#555"; }
function hostnameFromUrl(u){ try{ return new URL(u).hostname; }catch(e){ return (u||'').replace(/^https?:\/\//,''); } }
function firstLink(s){ if(!s) return ''; const parts=String(s).split(/[\s,;|\n]+/).filter(Boolean); for(const p of parts) if(/^https?:\/\//i.test(p)) return p; return parts[0]||''; }

/* N√¢ng ch·∫•t l∆∞·ª£ng thumbnail Google Drive/Gusercontent */
function upgradeThumbQuality(u){
  try{
    if(!u) return u;
    const url = new URL(u, location.href);
    if (url.hostname.includes('googleusercontent') || url.hostname.includes('google.com')) {
      if (url.searchParams.has('sz')) url.searchParams.set('sz','w800');
      else url.searchParams.append('sz','w800');
      return url.toString();
    }
  }catch(_){
    return String(u).replace(/([?&])sz=w\d+/,'$1sz=w800');
  }
  return u;
}

/* Logo reload */
document.getElementById('logoLink').addEventListener('click', (e)=>{ e.preventDefault(); window.scrollTo({top:0,behavior:'smooth'}); setTimeout(()=>location.reload(),150); });

/* Product card */
function productCardHtml(it){
  products[it.id]=it;
  const giftUrl   = firstLink(it.imageClick);
  const showGift  = !!giftUrl;
  const giftLabel = (it.loai || 'Nh·∫≠n qu√†').toString().trim();

  const thumbSrc = upgradeThumbQuality(it.img);
  const linkHref = esc(it.linkFull || it.img || '#');

  return `<div class="col">
  <div class="cardx product-card" data-id="${esc(it.id)}">
    <div class="thumb-wrap">
      <a href="${linkHref}" target="_blank" rel="noopener">
        <img loading="lazy" class="thumb" src="${esc(thumbSrc)}" alt="S·∫£n ph·∫©m ${esc(it.id)}"
             onerror="this.src='https://via.placeholder.com/300x300?text=No+Image'">
      </a>
      ${it.note?`<span class="note-chip" style="background:${badgeColor(it.note)}">${esc(it.note)}</span>`:''}
    </div>

  <!-- BOX CHI TI·∫æT S·∫¢N PH·∫®M -->
<div id="detailModal" class="dtl-backdrop" hidden>
  <div class="dtl-dialog" role="dialog" aria-modal="true" aria-labelledby="dtlTitle">
    <button class="dtl-close" type="button" data-close="detailModal" aria-label="ƒê√≥ng">√ó</button>

    <div class="dtl-head">
      <img id="dtlImg" src="" alt="">
      <div>
        <h4 id="dtlTitle">Chi ti·∫øt</h4>
        <div id="dtlSub" class="dtl-sub"></div>
        <div id="dtlBadges" class="dtl-badges"></div>
      </div>
    </div>

    <!-- C√°c h√†ng th√¥ng tin ƒë·∫ßy ƒë·ªß (k·ªÉ c·∫£ m√¥ t·∫£ d√†i) s·∫Ω render ·ªü ƒë√¢y -->
    <div id="dtlRows" class="dtl-rows"></div>

    <div class="dtl-actions">
      <a id="dtlOpenImg" class="btn-ghost" href="#" target="_blank" rel="noopener">M·ªü ·∫£nh g·ªëc</a>
      <button type="button" class="btn-main" data-close="detailModal">ƒê√≥ng</button>
    </div>
  </div>
</div>



/* ========= PAGER (m≈©i t√™n + dropdown) ========= */
/* ========= PAGER (m≈©i t√™n + dropdown) ========= */
function renderPagination(totalItems, pageSize, currentPage){
  const totalPages = Math.max(1, Math.ceil((totalItems || 0) / (pageSize || 1)));
  state.totalPages = totalPages;

  const block = (where) => `
    <div class="d-inline-flex align-items-center gap-1" data-where="${where}">
      <button type="button" class="btn btn-sm btn-outline-secondary" data-action="page-prev" ${currentPage<=1?'disabled':''}>&lsaquo;</button>
      <select class="form-select form-select-sm page-select" style="width:auto">
        ${Array.from({length: totalPages}, (_, i) => {
          const p = i + 1;
          return `<option value="${p}" ${p===currentPage?'selected':''}>Trang ${p}/${totalPages}</option>`;
        }).join('')}
      </select>
      <button type="button" class="btn btn-sm btn-outline-secondary" data-action="page-next" ${currentPage>=totalPages?'disabled':''}>&rsaquo;</button>
    </div>
  `;
}
  // Render l√™n 2 v·ªã tr√≠ c√≥ s·∫µn
  const top = document.getElementById('pagerTop');
  const bot = document.getElementById('pagerBottom');
  if (top) top.innerHTML = block('top');
  if (bot) bot.innerHTML = block('bottom');

  // S·ª± ki·ªán ƒë·ªïi trang b·∫±ng select
  document.querySelectorAll('#pagerTop .page-select, #pagerBottom .page-select')
    .forEach(sel => {
      sel.onchange = (e) => {
        state.page = parseInt(e.target.value, 10) || 1;
        fetchPage();
      };
    });

  // ƒê∆∞a pagerTop s√°t n√∫t "X√≥a b·ªô l·ªçc"
  const leftBlock = document.querySelector('.found-count'); // kh·ªëi "T√¨m th·∫•y + X√≥a b·ªô l·ªçc"
  if (leftBlock && top) {
    leftBlock.appendChild(top);      // nh√©t pager v√†o ngay sau n√∫t X√≥a b·ªô l·ªçc
    top.classList.add('ms-2');       // c√°ch nh·∫π 1 x√≠u
  }
}

/* ========= ICON cho t·ª´ng Category (d√πng thumbnail Google Drive) ========= */
/* Map t√™n ‚Üí ·∫£nh. ƒêi·ªÅn FILE_ID theo icon b·∫°n mu·ªën cho t·ª´ng m·ª•c. */
const CATEGORY_ICONS = {
  "QUA TANG 247 EXPRESS (DOI TAC)": "https://drive.google.com/thumbnail?id=1ixc_p6X925a0JpSG4YIWwpyauVmhRakI&sz=w200",
  "QUA TANG AN PHAM THUONG HIEU":   "https://drive.google.com/thumbnail?id=1ixc_p6X925a0JpSG4YIWwpyauVmhRakI&sz=w48",
  "QUA TANG SAN PHAM THUONG HIEU":  "https://drive.google.com/thumbnail?id=1ixc_p6X925a0JpSG4YIWwpyauVmhRakI&sz=w48",
  "QUA TANG KY NIEM EVENT THUONG HIEU":"https://drive.google.com/thumbnail?id=1ixc_p6X925a0JpSG4YIWwpyauVmhRakI&sz=w48",
  "QUA TANG PHU KIEN THUONG HIEU":  "https://drive.google.com/thumbnail?id=1ixc_p6X925a0JpSG4YIWwpyauVmhRakI&sz=w48",
  "KHAC":                           "https://drive.google.com/thumbnail?id=1ixc_p6X925a0JpSG4YIWwpyauVmhRakI&sz=w48",
  "__DEFAULT__":                    "https://drive.google.com/thumbnail?id=1ixc_p6X925a0JpSG4YIWwpyauVmhRakI&sz=w48" // fallback
};

/* Chu·∫©n ho√° t√™n: b·ªè d·∫•u, b·ªè s·ªë th·ª© t·ª± "1. ", vi·∫øt hoa ƒë·ªÉ map 1-1 ·ªïn ƒë·ªãnh */
function normKey(s){
  return String(s||'')
    .normalize('NFD').replace(/[\u0300-\u036f]/g,'') // b·ªè d·∫•u
    .replace(/^\s*\d+\.\s*/,'')                      // b·ªè ti·ªÅn t·ªë "1. "
    .replace(/\s+/g,' ').trim()
    .toUpperCase();
}
function iconForCat(name){
  const k = normKey(name);
  return CATEGORY_ICONS[k] || CATEGORY_ICONS["__DEFAULT__"];
}

/* Render thanh category (pager) ‚Äì icon l·∫•y t·ª´ map theo t√™n, l·ªçc v·∫´n d√πng data-val t·ª´ Sheet */
function renderCategoryPager(items){
  const box = document.getElementById('categoryScroll');
  const slice = items.slice(catIndex, catIndex + catsPerView);

  box.innerHTML = slice.map(val => `
    <div class="category-item ${state.category===val ? 'active' : ''}"
         data-action="select-category" data-val="${esc(val)}">
      <div class="icon">
        <img src="${esc(iconForCat(val))}" alt="${esc(val)}"
             onerror="this.src='${esc(CATEGORY_ICONS['__DEFAULT__'])}'">
      </div>
      <span>${esc(val || 'Kh√°c')}</span>
    </div>
  `).join('');
}
let catIndex = 0;
const catsPerView = 12;   // hi·ªÉn th·ªã 12 danh m·ª•c m·ªói trang (6 c·ªôt x 2 h√†ng)
let allCategories = [];

function scrollCats(dir){
  const total = allCategories.length;
  catIndex += dir * catsPerView;
  if(catIndex < 0) catIndex = 0;
  if(catIndex >= total) catIndex = Math.max(0, total - catsPerView);
  renderCategoryPager(allCategories);
}
function buildCategory(items){
  allCategories = items || [];
  catIndex = 0;
  renderCategoryPager(allCategories);
}


function selectCategory(val){
  state.category = val;
  state.page = 1;
  fetchPage();

  // C·∫≠p nh·∫≠t active cho danh m·ª•c ƒëang click
  document.querySelectorAll('#categoryScroll .category-item')
    .forEach(el => el.classList.toggle('active', el.dataset.val === val));

  // üîÑ ƒê·ªìng b·ªô 2 d·∫£i danh m·ª•c (tr√™n + d∆∞·ªõi)
  if (typeof syncQuickCatsActive === 'function') syncQuickCatsActive();

  // üî¢ C·∫≠p nh·∫≠t l·∫°i badge b·ªô l·ªçc
  if (typeof updateFilterCount === 'function') updateFilterCount();
}


/* Highlight UI khi ch·ªçn group */
function buildFilterBox(boxId, items, field){
  const box=document.getElementById(boxId);
  if(!box) return;
  box.classList.add("filter-box-group");
  box.innerHTML=(items||[]).map(val=>`
    <div class="filter-tag ${state[field]===val?'active':''}"
      data-action="set-filter" data-field="${field}" data-val="${esc(val)}" role="button" tabindex="0">
      ${esc(val||'T·∫•t c·∫£')}
    </div>
  `).join('');
}
function updateFilterCount(){
  // ƒê·∫øm t·ªïng s·ªë b·ªô l·ªçc ƒëang ƒë∆∞·ª£c √°p d·ª•ng
  let c = 0;
  if (state.group)    c++;
  if (state.type)     c++;
  if (state.loai)     c++;
  if (state.note)     c++;
  if (state.category) c++;
  // N·∫øu mu·ªën t√≠nh c·∫£ √¥ t√¨m ki·∫øm:
  // if (state.q)        c++;

  const fb = document.getElementById('filterFabCount');
  if (fb){
    fb.textContent = c > 99 ? '99+' : String(c);
    fb.style.display = c > 0 ? 'inline-block' : 'none';
  }
}
/* ƒê·ªìng b·ªô tr·∫°ng th√°i active cho C·∫¢ 2 d·∫£i danh m·ª•c (tr√™n + d∆∞·ªõi) */
function syncQuickCatsActive(){
  const norm = (s) => String(s||'')
    .trim()
    .replace(/\s+/g,' ')
    .toLowerCase()
    .normalize('NFD').replace(/[\u0300-\u036f]/g,''); // b·ªè d·∫•u

  const cur = norm((window.state && state.category) || '');

  const getVal = (el) =>
    el.dataset?.val ||
    el.dataset?.cat ||
    el.getAttribute?.('data-category') ||
    el.textContent || '';

  document.querySelectorAll(
    '[data-quick-cats] [data-action="select-category"],' +
    '[data-quick-cats] [data-cat],' +
    '[data-quick-cats] .category-item,' +
    '[data-quick-cats] .chip'
  ).forEach(el => {
    const same = cur && norm(getVal(el)) === cur;
    el.classList.toggle('active', same);
  });
}

/* Link preview API */
function fetchLinkPreview(url){
  const qs = new URLSearchParams({ action:'preview', url });
  return fetch(API_URL + '?' + qs.toString()).then(r => r.json());
}

/* ===== X∆Ø·ªûNG ƒê·ªÄ XU·∫§T ===== */
let workshopData = [];
function renderWorkshops(items){
  workshopData = items || [];
  const list = document.getElementById('workshopList');
  const empty = document.getElementById('workshopEmpty');
  const badge = document.getElementById('workshopCount');

  if(!list) return;
  list.innerHTML = workshopData.map(it => {
    const url = it.url || it.link || '';
    const img = it.img || it.thumb || '';
    const title = it.title || it.name || 'ƒê∆°n v·ªã';
    const desc = it.desc || it.description || '';
    const site = url ? (new URL(url, location.href).hostname) : '';
    return `
      <a class="link-preview text-decoration-none" href="${esc(url||'#')}" target="_blank" rel="noopener">
        <img class="thumb" src="${esc(img)}" alt="${esc(title)}" onerror="this.src='https://via.placeholder.com/64?text=%20'">
        <div class="flex-grow-1">
          <div class="title">${esc(title)}</div>
          ${desc ? `<div class="desc">${esc(desc)}</div>` : ``}
          ${site ? `<div class="site">${esc(site)}</div>` : ``}
        </div>
      </a>
    `;
  }).join('');

  if (badge){
    badge.textContent = workshopData.length;
    badge.style.display = workshopData.length ? 'inline-block' : 'none';
  }
  if (empty){
    empty.style.display = workshopData.length ? 'none' : 'block';
  }
}

function fetchWorkshops(){
  const qs = new URLSearchParams({
    action:'workshop',
    q:state.q, group:state.group, type:state.type, loai:state.loai, note:state.note, category:state.category
  });
  fetch(API_URL + '?' + qs.toString())
    .then(r=>r.json())
    .then(r=>renderWorkshops(r.items||[]))
    .catch(()=>renderWorkshops([]));
}


/* Cart */
function addToCartById(id){ const it=products[id]; if(!it) return; const f=cart.find(p=>p.id===id); if(f) f.qty++; else cart.push({...it,qty:1}); updateCart(); if (AUTO_OPEN_ON_ADD) cartOffcanvas.show(); }
function changeQty(id,delta){ const it=cart.find(p=>p.id===id); if(!it) return; it.qty+=delta; if(it.qty<=0) cart.splice(cart.indexOf(it),1); updateCart(); }
function removeItem(id){ const i=cart.findIndex(p=>p.id===id); if(i>=0) cart.splice(i,1); updateCart(); }
function clearCart(){ if(confirm("X√≥a to√†n b·ªô gi·ªè h√†ng?")){ cart.length=0; updateCart(); } }
function updateCart(){
  const count = cart.reduce((a,b)=>a+b.qty,0);
  const fabCount = document.getElementById('cartFabCount');
  if(fabCount){ fabCount.textContent=count; fabCount.style.display = count>0 ? 'inline-block' : 'none'; }
  const list=document.getElementById('cartList'); let total=0;
  list.innerHTML=cart.map(it=>{
    const sub=it.qty*(Number(it.price)||0); total+=sub;
    return `<div class="d-flex align-items-center gap-2 border-bottom py-2">
      <img src="${esc(it.img)}" alt="·∫¢nh ${esc(it.id)}" style="width:50px;height:50px;object-fit:cover;border-radius:4px;border:1px solid #ddd">
      <div class="flex-grow-1">
        <div class="fw-semibold small">${esc(it.details||it.id)}</div>
        <div class="text-muted small">${fmtVND(it.price)}</div>
      </div>
      <div class="d-flex align-items-center gap-1">
        <button class="btn btn-sm btn-outline-secondary" data-action="qty" data-id="${esc(it.id)}" data-delta="-1">-</button>
        <span>${it.qty}</span>
        <button class="btn btn-sm btn-outline-secondary" data-action="qty" data-id="${esc(it.id)}" data-delta="1">+</button>
      </div>
      <div style="min-width:90px;text-align:right" class="small">${fmtVND(sub)}</div>
      <button class="btn btn-sm btn-link text-danger" data-action="remove" data-id="${esc(it.id)}" aria-label="X√≥a ${esc(it.id)}">&times;</button>
    </div>`;
  }).join('');
  document.getElementById('cartTotal').innerText=fmtVND(total);
}

/* G·ª¨I ƒê∆†N ‚Äì h·ªó tr·ª£ file */
async function submitOrder(){
  if(cart.length===0){ alert("Gi·ªè h√†ng tr·ªëng!"); return; }
  const name=document.getElementById("buyerName").value.trim();
  const email=document.getElementById("buyerEmail").value.trim();
  const phone=document.getElementById("buyerPhone").value.trim();
  const address=document.getElementById("buyerAddress").value.trim();
  const note=document.getElementById("buyerNote").value.trim();
  const file=document.getElementById("buyerFile").files[0]||null;
  const servicePlan=document.getElementById("servicePlan").value;
  const fileQuote=document.getElementById("fileQuote").checked;

  if(!name||!email||!phone||!address){ alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin!"); return; }

  const order={
    customer:{name,email,phone,address,note, servicePlan, fileQuote},
    items:cart.map(({id,details,type,price,qty,img,linkFull,group,loai,category,note})=>({id,details,type,price,qty,img,linkFull,group,loai,category,note})),
    total:cart.reduce((a,b)=>a+b.qty*(Number(b.price)||0),0)
  };

  try{
    let resp;
    if(file){
      const fd=new FormData();
      fd.append('action','order');
      fd.append('data', JSON.stringify(order));
      if(API_KEY) fd.append('key', API_KEY);
      fd.append('file', file);
      resp = await fetch(API_URL, { method:'POST', body:fd });
    }else{
      resp = await fetch(API_URL, {
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({action:"order", data:order, key:API_KEY||""})
      });
    }
    const res = await resp.json();
    if(res && (res.ok||res.success)){
      const mailState = res.mail || 'ok';
      alert(mailState==='ok' ? "ƒê√£ g·ª≠i ƒë∆°n h√†ng th√†nh c√¥ng!" : "ƒê√£ l∆∞u ƒë∆°n h√†ng. G·ª≠i email b·ªã l·ªói ‚Äî ch√∫ng t√¥i s·∫Ω ki·ªÉm tra l·∫°i.");
      cart.length=0; updateCart();
    }else{
      alert("G·ª≠i ƒë∆°n h√†ng th·∫•t b·∫°i.");
    }
  }catch(_){
    alert("Kh√¥ng th·ªÉ g·ª≠i ƒë∆°n h√†ng. Ki·ªÉm tra API_URL.");
  }
}

/* Suppliers (offcanvas) */
let suppliersAll = [];
function normalize(s){ return (s||'').toString().toLowerCase().trim(); }
function supplierCardHTML(s){
 const hasSite = !!s.url;
const hasDoc = s.cert && /^https?:\/\//i.test(s.cert);

return `
  <div class="supplier-card mb-2">
    <div class="title">${(s.name||'').trim()}</div>

    ${hasSite
      ? `<a href="${esc(s.url)}" target="_blank" rel="noopener" class="small text-truncate d-inline-block" style="max-width:100%">${esc(s.url)}</a>`
      : `<div class="small text-muted">(Kh√¥ng c√≥ website c·ª• th·ªÉ)</div>`}

    ${s.address ? `<div class="meta mt-1">üìç ${esc(s.address)}</div>` : ''}

    <div class="chips">
      <span class="chip ${hasSite?'ok':''}">${hasSite?'C√≥ website':'Ch∆∞a c√≥ website'}</span>

      <!-- Tr·∫°ng th√°i t·ªáp/gi·∫•y t·ªù -->
      ${
        hasDoc
          ? `<span class="chip">
              <a href="${esc(s.cert)}" target="_blank" rel="noopener">Xem t·ªáp</a>
             </span>`
          : `<span class="chip muted" data-doc-status="empty">Ch∆∞a c√≥ t·ªáp</span>
             <button class="chip btn-upload-doc" data-supplier="${esc(s.name)}" title="T·∫£i t·ªáp gi·∫•y t·ªù">
               T·∫£i t·ªáp
             </button>`
      }

      ${s.contact ? `<span class="chip">Li√™n h·ªá: ${esc(s.contact)}</span>` : ''}
    </div>
  </div>
`;
}

function renderSuppliersList(items){
  const box = document.getElementById('suppliersList');
  const counter = document.getElementById('suppliersCount');
  counter.textContent = `${items.length}/${suppliersAll.length}`;
  box.innerHTML = items.length ? items.map(supplierCardHTML).join('') : '<div class="text-muted">Kh√¥ng t√¨m th·∫•y x∆∞·ªüng ph√π h·ª£p.</div>';
}
// URL Web App c·ªßa Apps Script
const API_BASE = API_URL;   // d√πng chung API_URL

(function initUploworkshopupplierDoc(){
  const list = document.getElementById('suppliersList') || document; 
  const fileInput = document.getElementById('uploworkshopupplierFile');

  if (!list || !fileInput) return;

  let currentSupplier = '';

  list.addEventListener('click', (ev) => {
    const btn = ev.target.closest('.btn-upload-doc');
    if (!btn) return;
    currentSupplier = btn.getAttribute('data-supplier') || '';
    fileInput.value = '';
    fileInput.click();
  });

  fileInput.addEventListener('change', async () => {
    if (!fileInput.files || !fileInput.files[0]) return;
    const f = fileInput.files[0];

    const btn = document.querySelector(`.btn-upload-doc[data-supplier="${CSS.escape(currentSupplier)}"]`);
    if (btn) {
      btn.disabled = true;
      btn.textContent = 'ƒêang t·∫£i...';
    }

    try{
      const fd = new FormData();
      fd.append('action', 'uploworkshopupplierDoc');
      fd.append('supplier', currentSupplier);
      fd.append('file', f, f.name);

      const res = await fetch(API_BASE, { method:'POST', body: fd });
      const json = await res.json();

      if (json && json.ok && json.url){
        const card = btn && btn.closest('.supplier-card');
        if (card){
          const status = card.querySelector('[data-doc-status="empty"]');
          if (status){
            status.outerHTML = `<span class="chip"><a href="${json.url}" target="_blank" rel="noopener">Xem t·ªáp</a></span>`;
          }
          btn.remove();
        }
        alert('ƒê√£ t·∫£i t·ªáp th√†nh c√¥ng.');
      }else{
        alert('T·∫£i t·ªáp th·∫•t b·∫°i.');
      }
    }catch(err){
      alert('C√≥ l·ªói khi t·∫£i t·ªáp.');
    }finally{
      if (btn){
        btn.disabled = false;
        btn.textContent = 'T·∫£i t·ªáp';
      }
    }
  });
})();

function applySupFilters(){
  const q = normalize(document.getElementById('supSearch').value);
  const hasSite = document.getElementById('supHasSite').checked;
  const sortBy  = document.getElementById('supSort').value;

  let out = suppliersAll.filter(s=>{
    if(hasSite && !s.url) return false;
    if(!q) return true;
    const hay = normalize([s.name, s.address, s.cert, s.url].join(' '));
    return hay.includes(q);
  });

  if(sortBy === 'addr'){
    out.sort((a,b)=> normalize(a.address).localeCompare(normalize(b.address)));
  } else {
    out.sort((a,b)=> normalize(a.name).localeCompare(normalize(b.name)));
  }
  renderSuppliersList(out);
}
function debounce(fn, ms){ let t; return (...a)=>{ clearTimeout(t); t=setTimeout(()=>fn.apply(this,a),ms); }; }
function loworkshopuppliers(){
  const box=document.getElementById('suppliersList');
  box.innerHTML='ƒêang t·∫£i‚Ä¶';
  fetch(API_URL+'?action=suppliers')
    .then(r=>r.json())
    .then(res=>{
      if(!res||!res.ok||!res.items){ suppliersAll=[]; applySupFilters(); return; }
      suppliersAll = res.items.map(s=>({
        name: s.name || '', url:  s.url  || '', address: s.address || '', cert: s.cert || '', contact: s.contact || ''
      }));
      applySupFilters();
    })
    .catch(()=>{ box.innerHTML='<div class="text-danger">Kh√¥ng t·∫£i ƒë∆∞·ª£c danh s√°ch.</div>'; });
}

/* G·∫ÆN S·ª∞ KI·ªÜN CHO B·ªò L·ªåC X∆Ø·ªûNG (b·∫£n v√°) */
(function bindSuppliersFilterEvents(){
  const $q  = document.getElementById('supSearch');
  const $ok = document.getElementById('supHasSite');
  const $so = document.getElementById('supSort');
  if($q)  $q.addEventListener('input', debounce(applySupFilters, 250));
  if($ok) $ok.addEventListener('change', applySupFilters);
  if($so) $so.addEventListener('change', applySupFilters);
})();

/* Offcanvas instances */
const cartOffcanvas   = bootstrap.Offcanvas.getOrCreateInstance(document.getElementById('cartCanvas'));
const filterOffcanvas = bootstrap.Offcanvas.getOrCreateInstance(document.getElementById('filterPanel'));
const suppliersOffcanvas = bootstrap.Offcanvas.getOrCreateInstance(document.getElementById('suppliersCanvas'));

/* Events */
/* ==== EVENT DELEGATION (click chung) ==== */
document.addEventListener('click', (ev) => {
  const el = ev.target;

  // ch·∫∑n link #
  if (el.matches('[data-action="goto-page"], [data-action="page-prev"], [data-action="page-next"]')) {
    ev.preventDefault();
  }

  /* === T√åM KI·∫æM === */
  if (el.matches('#searchBtn')) {
    state.q = document.getElementById('searchBox').value.trim();
    state.page = 1;
    fetchPage();
    return;
  }

  /* === PH√ÇN TRANG === */
  if (el.matches('[data-action="page-prev"]'))  { if (state.page > 1) { state.page--; fetchPage(); } return; }
  if (el.matches('[data-action="page-next"]'))  { if (state.page < state.totalPages) { state.page++; fetchPage(); } return; }
  if (el.matches('[data-action="goto-page"]'))  {
    const p = Number(el.dataset.page) || 0;
    if (p && p !== state.page) { state.page = p; fetchPage(); }
    return;
  }

  /* === CATEGORY === */
  const catEl = el.closest('[data-action="select-category"]');
  if (catEl) { selectCategory(catEl.dataset.val || ''); return; }

  /* === GROUP === */
  if (el.matches('[data-action="select-group"]')) {
    state.group = el.dataset.val || '';
    state.page  = 1;
    updateGroupUI();
    updateGroupDots?.();
    fetchPage();
    updateFilterCount();
    return;
  }

  /* === FILTER TAGS === */
  if (el.matches('[data-action="set-filter"]')) {
    const field = el.dataset.field;
    state[field] = el.dataset.val || '';
    state.page = 1;
    fetchPage();
    updateFilterCount();
    return;
  }

  /* === GI·ªé H√ÄNG === */
  if (el.matches('[data-action="add-to-cart"]')) { addToCartById(el.dataset.id); return; }
  if (el.matches('[data-action="remove"]'))     { removeItem(el.dataset.id);    return; }
  if (el.matches('[data-action="qty"]'))        { changeQty(el.dataset.id, Number(el.dataset.delta)||0); return; }
  if (el.matches('#clearCartBtn'))              { clearCart(); return; }
});


/* Enter ƒë·ªÉ t√¨m ki·∫øm */
document.getElementById('searchBox')
  .addEventListener('keydown', e => {
    if (e.key === 'Enter') {
      e.preventDefault();
      document.getElementById('searchBtn').click();
    }
  });

/* ==== Hi·ªÉn th·ªã t√™n t·ªáp khi ch·ªçn (T√ÅCH RA NGO√ÄI) ==== */
document.addEventListener('change', (e) => {
  const input = e.target.closest('.doc-input');
  if (!input) return;
  const card = input.closest('.supplier-card');
  const preview = card.querySelector('.doc-preview');
  const f = input.files && input.files[0];
  preview.textContent = f
    ? `ƒê√£ ch·ªçn: ${f.name} (${Math.round(f.size / 1024)} KB)`
    : 'Ch∆∞a ch·ªçn t·ªáp';
});

/* ==== Upload t·ªáp l√™n Apps Script (T√ÅCH RA NGO√ÄI) ==== */
document.addEventListener('click', async (e) => {
  const btn = e.target.closest('.doc-upload');
  if (!btn) return;

  const card    = btn.closest('.supplier-card');
  const input   = card.querySelector('.doc-input');
  const preview = card.querySelector('.doc-preview');
  const file    = input.files && input.files[0];

  if (!file) {
    alert('Vui l√≤ng ch·ªçn t·ªáp tr∆∞·ªõc!');
    return;
  }

  try {
    const fd = new FormData();
    fd.append('action', 'uploworkshopupplierDoc');
    fd.append('supplier', card.dataset.supplier || '');
    fd.append('file', file);
    if (API_KEY) fd.append('key', API_KEY);

    btn.disabled = true;
    btn.textContent = 'ƒêang t·∫£i...';

    // d√πng chung webapp
    const resp = await fetch(API_URL, { method: 'POST', body: fd });
    const json = await resp.json();

    if (json && json.ok) {
      const url = json.url || '#';
      preview.innerHTML = `ƒê√£ t·∫£i l√™n: <a href="${esc(url)}" target="_blank" rel="noopener">Xem t·ªáp</a>`;
      input.value = '';
    } else {
      alert('T·∫£i l√™n th·∫•t b·∫°i. Vui l√≤ng th·ª≠ l·∫°i.');
    }
  } catch (err) {
    alert('Kh√¥ng th·ªÉ t·∫£i t·ªáp. Ki·ªÉm tra k·∫øt n·ªëi/API_URL.');
  } finally {
    btn.disabled = false;
    btn.textContent = 'T·∫£i l√™n';
  }
});


/* FAB */
document.getElementById('cartFab').addEventListener('click', () => cartOffcanvas.toggle());
document.getElementById('filterFab').addEventListener('click', () => filterOffcanvas.toggle());
document.getElementById('suppliersFab').addEventListener('click', ()=>{ loworkshopuppliers(); suppliersOffcanvas.show(); });
document.getElementById('zaloFab').setAttribute('href', ZALO_URL);
document.getElementById('workshopContactBtn').setAttribute('href', WORKSHOP_CONTACT_URL);
document.getElementById('workshopContactBtn2').setAttribute('href', WORKSHOP_CONTACT_URL);

function clearAllFilters(){
  Object.assign(state, { type:'', loai:'', note:'', category:'', group:'', q:'', page:1 });
  const sb = document.getElementById('searchBox'); if (sb) sb.value = '';
  document.querySelectorAll('.group-chip.active, .category-item.active, .filter-tag.active')
    .forEach(el => el.classList.remove('active'));
  if (typeof updateFilterCount === 'function') updateFilterCount();
  fetchPage();
}

// G·∫Øn s·ª± ki·ªán an to√†n (n·∫øu thi·∫øu n√∫t s·∫Ω kh√¥ng l·ªói)
document.getElementById('clearFiltersBtn')?.addEventListener('click', clearAllFilters);
document.getElementById('clearFiltersBtn2')?.addEventListener('click', clearAllFilters);

/* Helper setFilter + delegate click (ch·ªëng ‚Äúl·ªçc c·ª©ng‚Äù) */
function setFilter(key, val){
  state[key] = (val == null ? '' : String(val));
  state.page = 1;
  fetchPage();
}
document.addEventListener('click', (e)=>{
  const catEl = e.target.closest('[data-action="select-category"]');
  if (catEl) {
    e.preventDefault();  // tr√°nh nh·∫£y l√™n ƒë·∫ßu trang
    setFilter('category', catEl.dataset.val || '');
  }

  const grpEl = e.target.closest('[data-action="select-group"]');
  if (grpEl) setFilter('group', grpEl.dataset.val || '');
});



document.addEventListener('DOMContentLoaded', () => {
  if (window.__initDone) return;
  window.__initDone = true;

  // reset state
  Object.assign(state, { page:1, q:'', group:'', type:'', loai:'', note:'', category:'' });

  renderQuickCatsTop(); // <-- TH√äM D√íNG N√ÄY

  if (typeof updateFilterCount === 'function') updateFilterCount();
  fetchPage();
});



/* G·ª≠i ƒë∆°n h√†ng */
document.getElementById('submitOrderBtn')?.addEventListener('click', submitOrder);

/* ===== Modal Chi ti·∫øt L·ª£i √≠ch ===== */
const BENEFIT_DETAIL = {
  b1:{ title:'Tham kh·∫£o 10,000+ m·∫´u s·∫£n ph·∫©m', lead:'Kho √Ω t∆∞·ªüng l·ªõn, c·∫≠p nh·∫≠t th∆∞·ªùng xuy√™n.', bullets:[
      'T√¨m nhanh theo ID, t·ª´ kh√≥a, lo·∫°i s·∫£n ph·∫©m','·∫¢nh/Link ngu·ªìn tham kh·∫£o r√µ r√†ng','L∆∞u m·∫´u y√™u th√≠ch v√†o gi·ªè ƒë·ªÉ xin b√°o gi√°' ] },
  b2:{ title:'500+ nh√† cung c·∫•p & x∆∞·ªüng s·∫£n xu·∫•t', lead:'K·∫øt n·ªëi nhanh ‚Äì ƒëa d·∫°ng ‚Äì so s√°nh gi√° d·ªÖ d√†ng.', bullets:[
      'L·ªçc theo lo·∫°i h√¨nh/xu·∫•t x·ª©/ghi ch√∫','G·ª£i √Ω x∆∞·ªüng ngay trong ‚ÄúX∆∞·ªüng ƒë·ªÅ xu·∫•t‚Äù','C√≥ th·ªÉ g·ª≠i c√πng l√∫c cho nhi·ªÅu ƒë∆°n v·ªã' ] },
  b3:{ title:'H·ªó tr·ª£ t∆∞ v·∫•n s·∫£n xu·∫•t (Mi·ªÖn ph√≠)', lead:'ƒê·ªôi ng≈© CSKH ph·∫£n h·ªìi nhanh v√† c·ª• th·ªÉ.', bullets:[
      'T∆∞ v·∫•n v·∫≠t li·ªáu, quy c√°ch, ƒë·ªãnh m·ª©c','∆Ø·ªõc t√≠nh chi ph√≠ s∆° b·ªô','ƒê·ªãnh h∆∞·ªõng ph∆∞∆°ng √°n t·ªëi ∆∞u theo ng√¢n s√°ch' ] },
  b4:{ title:'H·ªó tr·ª£ thi·∫øt k·∫ø 2D, 3D s·∫£n xu·∫•t', lead:'Ph·ª•c v·ª• tr·ª±c ti·∫øp cho ƒë∆°n h√†ng ƒë√£ ch·ªët.', bullets:[
      'D·ª±ng mockup/khung k·ªπ thu·∫≠t c∆° b·∫£n','Xu·∫•t file .SVG, .PDF theo y√™u c·∫ßu x∆∞·ªüng','Mi·ªÖn ph√≠ cho ƒë∆°n ƒë√£ x√°c nh·∫≠n ƒë·∫∑t h√†ng' ] },
  b5:{ title:'H·∫≠u c·∫ßn v·∫≠n chuy·ªÉn & ƒë√≥ng g√≥i (C√≥ ph√≠)', lead:'ƒê·∫£m b·∫£o giao nh·∫≠n ƒë√∫ng h·∫πn ‚Äì an to√†n.', bullets:[
      'Nh·∫≠n ƒë√≥ng g√≥i ‚Äì d√°n tem ‚Äì chia ki·ªán','Theo d√µi tracking ‚Äì x·ª≠ l√Ω ph√°t sinh','B√°o ph√≠ r√µ r√†ng tr∆∞·ªõc khi tri·ªÉn khai' ], note:'Ph√≠ d·ªãch v·ª• s·∫Ω c·ªông ri√™ng v√†o t·ªïng ƒë∆°n theo b√°o gi√°.' },
  b6:{ title:'H·ªó tr·ª£ gi·∫£i quy·∫øt tranh ch·∫•p (C√≥ ph√≠)', lead:'TƒÉng c∆∞·ªùng b·∫£o v·ªá quy·ªÅn l·ª£i kh√°ch h√†ng khi ph√°t sinh s·ª± c·ªë.', bullets:[
      'Thu th·∫≠p ch·ª©ng c·ª© ‚Äì l√†m vi·ªác v·ªõi x∆∞·ªüng','ƒê·ªÅ xu·∫•t ph∆∞∆°ng √°n kh·∫Øc ph·ª•c/ho√†n ti·ªÅn','ƒê·ªìng h√†nh cho ƒë·∫øn khi k·∫øt th√∫c v·ª• vi·ªác' ], note:'Ch·ªâ √°p d·ª•ng cho ƒë∆°n h√†ng ƒë√£ th√¥ng b√°o cho 2606AI.' }
};
(function attachBenefitModal(){
  const modalEl = document.getElementById('benefitModal');
  const modal = bootstrap.Modal.getOrCreateInstance(modalEl);
  const $title = document.getElementById('benefitTitle');
  const $lead  = document.getElementById('benefitLead');
  const $list  = document.getElementById('benefitList');
  const $note  = document.getElementById('benefitNote');
  function openDetail(key){
    const d = BENEFIT_DETAIL[key]; if(!d) return;
    $title.textContent = d.title || 'Chi ti·∫øt';
    $lead.textContent  = d.lead  || '';
    $list.innerHTML    = (d.bullets||[]).map(li=>`<li>${li}</li>`).join('');
    $note.textContent  = d.note || '';
    modal.show();
  }
  document.querySelectorAll('.benefits-v3 .bcard[data-benefit]').forEach(card=>{
    const key = card.getAttribute('data-benefit');
    card.addEventListener('click', ()=>openDetail(key));
    card.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' ') { e.preventDefault(); openDetail(key); }});
    card.style.cursor = 'pointer';
  });
})();
// === GROUP BAR: b·∫Øt click 1 l·∫ßn tr√™n container ===
const groupBar = document.getElementById('groupBar');

groupBar.addEventListener('click', (e) => {
  const chip = e.target.closest('.group-chip');
  if (!chip || !groupBar.contains(chip)) return;

  const val = chip.dataset.val || '';
  if (state.group === val) return;

  state.group = val;
  state.page = 1;
  fetchPage();

  groupBar.querySelectorAll('.group-chip')
    .forEach(c => c.classList.toggle('active', c === chip));
});

// === CATEGORY: c≈©ng b·∫Øt click tr√™n container ===
const catScroll = document.getElementById('categoryScroll');

catScroll.addEventListener('click', (e) => {
  const item = e.target.closest('.category-item');
  if (!item || !catScroll.contains(item)) return;

  const val = item.dataset.val || '';
  selectCategory(val);
});
// === QUICK CATS TOP: b·∫Øt click tr√™n c·ª•m √¥ l·ªõn ph√≠a tr√™n ===
const quickTop = document.getElementById('quickCatsTop');
if (quickTop){
  quickTop.addEventListener('click', (e) => {
    const item = e.target.closest('.category-item, [data-action="select-category"], [data-cat]');
    if (!item || !quickTop.contains(item)) return;
    e.preventDefault();

    // L·∫•y gi√° tr·ªã danh m·ª•c
    const val = item.dataset.val
             || item.dataset.cat
             || item.getAttribute('data-category')
             || (item.textContent || '').trim();

    // Toggle: b·∫•m l·∫°i c√πng danh m·ª•c => b·ªè l·ªçc
    const cur  = state.category || '';
    const next = (cur === val) ? '' : val;

    // C·∫≠p nh·∫≠t state + n·∫°p d·ªØ li·ªáu
    state.category = next;
    state.page = 1;
    fetchPage();

    // ƒê·ªìng b·ªô 2 d·∫£i + c·∫≠p nh·∫≠t badge
    if (typeof syncQuickCatsActive === 'function') syncQuickCatsActive();
    if (typeof updateFilterCount   === 'function') updateFilterCount();
  });
}


// G·∫Øn click cho to√†n b·ªô .category-item
document.querySelectorAll('.category-item').forEach(el=>{
  el.addEventListener('click', ()=>{
    const val = el.dataset.val || '';
    selectCategory(val);
  });
});

function render(res = {}, fromCache){
  const items = res.items || [];
  const grid  = document.getElementById('productGrid');

  // Grid: gi·ªØ nguy√™n
  grid.innerHTML = items.length
    ? items.map(productCardHtml).join('')
    : '<div class="text-muted">ƒêang t·∫£i d·ªØ li·ªáu...</div>';

  // üîÅ Rebuild facets khi ƒë·ªïi
const newHash = hashFacets(res?.facets || {});
if (newHash !== _lastFacetsHash){
  _lastFacetsHash = newHash;
  buildCategoryFromFacets(res?.facets || {});
  fetchWorkshops();   // <-- thay cho renderSuppliers(...)
} else {
  // ph√≤ng tr∆∞·ªùng h·ª£p l·∫ßn ƒë·∫ßu ch∆∞a c√≥ g√¨ trong supBox
  if (!document.querySelector('#workshopList')?.children?.length){
    fetchWorkshops(); // <-- thay cho renderSuppliers(...)
  }
}


  document.getElementById('totalCount').textContent = Number(res?.total||0).toLocaleString('vi-VN');
  renderPagination(res?.total||0, state.pageSize, state.page);
  updateGroupUI();
  updateGroupDots?.();

  // (Tu·ª≥ ch·ªçn) log ngu·ªìn d·ªØ li·ªáu
  // console.debug('[render]', fromCache ? 'CACHE' : 'NETWORK', state);
}

/* ===== Fetch t·ªëi ∆∞u: debounce + abort + cache (LRU) ===== */
const FETCH_DEBOUNCE = 160;                 // ms
let _fetchTimer = 0;
let _inflightCtl = null;

// LRU cache: key -> {time, payload}
const _cache = new Map();
const CACHE_LIMIT = 30;
function cacheKeyFromState(s){
  // ch·ªâ key c√°c tham s·ªë ·∫£nh h∆∞·ªüng t·ªõi d·ªØ li·ªáu
  return [
    'list', s.page, s.pageSize,
    s.q||'', s.group||'', s.type||'', s.loai||'', s.note||'', s.category||''
  ].join('|');
}
function cacheGet(key){
  if(!_cache.has(key)) return null;
  const v = _cache.get(key);
  // l√†m m·ªõi th·ª© t·ª± LRU
  _cache.delete(key); _cache.set(key, v);
  return v.payload;
}
function cacheSet(key, payload){
  _cache.set(key, { time: Date.now(), payload });
  if(_cache.size > CACHE_LIMIT){
    const firstKey = _cache.keys().next().value;
    _cache.delete(firstKey);
  }
}

// so s√°nh facets ƒë·ªÉ tr√°nh rebuild UI kh√¥ng c·∫ßn thi·∫øt
let _lastFacetsHash = '';
function hashFacets(facets){
  try{ return JSON.stringify(facets||{}); }catch{ return ''; }
}

/* Ch·ªâ g·ªçi public API n√†y ·ªü m·ªçi n∆°i thay v√¨ g·ªçi tr·ª±c ti·∫øp _doFetch */
/* Ch·ªâ g·ªçi public API n√†y ·ªü m·ªçi n∆°i thay v√¨ g·ªçi tr·ª±c ti·∫øp _doFetch */
function fetchPage(){
  clearTimeout(_fetchTimer);
  _fetchTimer = setTimeout(_doFetch, FETCH_DEBOUNCE);
}

async function _doFetch(){
  // Hu·ª∑ request tr∆∞·ªõc (n·∫øu c√≤n)
  try{ _inflightCtl?.abort(); }catch(_){}
  _inflightCtl = new AbortController();

  const params = new URLSearchParams({
    action:'list',
    page:state.page, pageSize:state.pageSize,
    q:state.q, group:state.group, type:state.type, loai:state.loai, note:state.note, category:state.category
  });

  // ===== Cache key theo state hi·ªán t·∫°i
  const key = cacheKeyFromState(state);
  const cached = cacheGet(key);
  if (cached){
    // ‚ö° render ngay t·ª´ cache ƒë·ªÉ UI ph·∫£n h·ªìi t·ª©c th√¨
    render(cached, /*fromCache*/true);
  }

  try{
    const url = API_URL + '?' + params.toString();
fetch(url, { redirect: 'follow', mode: 'cors' })
  .then(async (r) => {
    const txt = await r.text();
    console.log('[API RAW]', txt.slice(0, 400));  // xem th·ª≠ server tr·∫£ g√¨
    // c·ªë parse JSON: m·ªôt s·ªë deployment c√≥ th·ªÉ kh√¥ng set content-type JSON ho·∫∑c c√≥ ti·ªÅn t·ªë
    try {
      return JSON.parse(txt);
    } catch (_) {
      // lo·∫°i c√°c ti·ªÅn t·ªë XSSI / BOM n·∫øu c√≥ r·ªìi parse l·∫°i
      const cleaned = txt.replace(/^\)\]\}'[^\n]*\n?/, '').replace(/^\uFEFF/, '').trim();
      return JSON.parse(cleaned);
    }
  })
  .then((json) => {
  // Ki·ªÉm tra schema d·ªØ li·ªáu
  if (!json || json.ok === false || !Array.isArray(json.items)) {
    throw new Error('Bad JSON schema or empty data');
  }

  // Render d·ªØ li·ªáu ch√≠nh
  render(json, true);

  // C·∫≠p nh·∫≠t badge l·ªçc
  updateFilterBadge();

  // ƒê·ªìng b·ªô tr·∫°ng th√°i gi·ªØa c√°c c·ª•m danh m·ª•c (A+B)
  if (typeof syncQuickCatsActive === 'function') syncQuickCatsActive();

  // L√†m m·ªõi 2 d·∫£i danh m·ª•c theo d·ªØ li·ªáu m·ªõi
  if (typeof refreshFacetStripsByData === 'function') {
    refreshFacetStripsByData(json.items);
  } else {
    // N·∫øu ch∆∞a c√≥ h√†m th√¨ t·∫°o lu√¥n t·∫°i ƒë√¢y
    const _norm = (s) => String(s || '')
      .trim()
      .replace(/\s+/g, ' ')
      .toLowerCase()
      .normalize('NFD')
      .replace(/[\u0300-\u036f]/g, ''); // b·ªè d·∫•u

    const computeFacets = (items) => {
      const groupsNorm = new Set();
      const catsRaw = new Set();
      (items || []).forEach(it => {
        if (it.group) groupsNorm.add(_norm(it.group));
        if (it.category) catsRaw.add(it.category);
      });
      return { groupsNorm, catsRaw };
    };

    const refreshFacetStripsByData = (items) => {
      const { groupsNorm, catsRaw } = computeFacets(items || []);

      // C·∫≠p nh·∫≠t d·∫£i A (√¥ l·ªõn ph√≠a tr√™n)
      if (typeof renderQuickCatsTop === 'function')
        renderQuickCatsTop(groupsNorm);

      // C·∫≠p nh·∫≠t d·∫£i B (√¥ nh·ªè ph√≠a d∆∞·ªõi)
      if (typeof buildCategory === 'function')
        buildCategory(Array.from(catsRaw));

      // ƒê·ªìng b·ªô active + badge
      if (typeof syncQuickCatsActive === 'function') syncQuickCatsActive();
      if (typeof updateFilterCount === 'function') updateFilterCount();
    };

    // G·∫Øn v√†o ph·∫°m vi global ƒë·ªÉ c√≥ th·ªÉ g·ªçi l·∫°i
    window.refreshFacetStripsByData = refreshFacetStripsByData;

    // G·ªçi ngay l·∫ßn ƒë·∫ßu
    refreshFacetStripsByData(json.items);
  }

})
.catch((err) => {
  console.error('[API ERR]', err);
  const box = document.getElementById('errbox');
  if (box) {
    box.style.display = 'block';
    box.textContent = '[ERROR] Kh√¥ng t·∫£i ƒë∆∞·ª£c d·ªØ li·ªáu.';
  }
});


// Chu·∫©n ho√° chu·ªói (so s√°nh kh√¥ng d·∫•u/hoa-th∆∞·ªùng)
function _norm(s){
  return String(s||'').trim().replace(/\s+/g,' ')
    .toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,'');
}

// T√≠nh facet t·ª´ danh s√°ch items ƒë√£ render (json.items)
function computeFacets(items){
  const groups = new Set();     // facet cho A (√¥ l·ªõn)
  const cats   = new Set();     // facet cho B (d·∫£i d∆∞·ªõi)
  (items||[]).forEach(it=>{
    if (it.group)    groups.add(_norm(it.group));
    if (it.category) cats.add(_norm(it.category));
  });
  return { groups, cats };
}

    const json = await resp.json();

    // L∆∞u cache v√† render
    cacheSet(key, json);
    render(json, /*fromCache*/false);
     updateFilterBadge();
     syncQuickCatsActive();
     refreshFacetStripsByData(json.items);
     applyFacetVisibility(json.items);  // <-- TH√äM D√íNG N√ÄY

// Chu·∫©n ho√° chu·ªói ƒë·ªÉ so s√°nh
function _norm(s){
  return String(s||'').trim().replace(/\s+/g,' ')
    .toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,'');
}

// L·∫•y facet (nh√≥m A v√† danh m·ª•c B) t·ª´ items
function computeFacets(items){
  const groups = new Set();
  const cats   = new Set();
  (items||[]).forEach(it=>{
    if (it.group)    groups.add(_norm(it.group));
    if (it.category) cats.add(_norm(it.category));
  });
  return { groups, cats };
}

// ·∫®n/hi·ªán item theo facet (KH√îNG v·∫Ω l·∫°i DOM)
function applyFacetVisibility(items){
  const { groups, cats } = computeFacets(items||[]);

  // A (√¥ l·ªõn ph√≠a tr√™n)
  document.querySelectorAll('#quickCatsTop [data-action="select-category"], #quickCatsTop .category-item')
    .forEach(el=>{
      const val = el.dataset.val || el.dataset.cat || el.getAttribute('data-category') || el.textContent || '';
      const show = groups.has(_norm(val));
      el.style.display = show ? '' : 'none';
      el.classList.toggle('is-disabled', !show);
    });

  // B (d·∫£i danh m·ª•c ph√≠a d∆∞·ªõi)
  document.querySelectorAll('#categoryScroll .category-item')
    .forEach(el=>{
      const val = el.dataset.val || el.textContent || '';
      const show = cats.has(_norm(val));
      el.style.display = show ? '' : 'none';
      el.classList.toggle('is-disabled', !show);
    });
}


    // Tr√¨ ho√£n workshop 1 nh·ªãp ƒë·ªÉ nh∆∞·ªùng CPU cho grid
    setTimeout(fetchWorkshops, 200);

    // (Optional) Preload trang k·∫ø ti·∫øp n·∫øu c√≤n
    if (json?.total && state.page * state.pageSize < json.total){
      const nextState = { ...state, page: state.page + 1 };
      const nextKey   = cacheKeyFromState(nextState);
      if (!cacheGet(nextKey)){
        const p2 = new URLSearchParams({
          action:'list',
          page:nextState.page, pageSize:nextState.pageSize,
          q:nextState.q, group:nextState.group, type:nextState.type,
          loai:nextState.loai, note:nextState.note, category:nextState.category
        });
        // fire-and-forget
        fetch(API_URL + '?' + p2.toString())
          .then(r=>r.json()).then(j=>cacheSet(nextKey, j)).catch(()=>{});
      }
    }
  }catch(err){
    if (err?.name === 'AbortError') return; // b·ªã hu·ª∑ b·ªüi l·∫ßn g·ªçi m·ªõi ‚Üí b·ªè qua
    document.getElementById('productGrid').innerHTML =
      '<div class="text-danger">ƒêang t·∫£i d·ªØ li·ªáu...</div>';
  }
}


/* === C·∫≠p nh·∫≠t UI cho GROUP BAR (+ ink-bar tab danh m·ª•c) === */
function updateGroupUI(){
  // Toggle active tr√™n chip group
  const chips = document.querySelectorAll('#groupBar .group-chip');
  let activeEl = null;
  chips.forEach(chip=>{
    const on = chip.dataset.val === (state.group||'');
    chip.classList.toggle('active', on);
    if(on) activeEl = chip;
  });

  // B·ªçc khu danh m·ª•c khi c√≥ group
  const catBox = document.querySelector('.category-box');
  if(catBox){
    const has = !!state.group;
    catBox.classList.toggle('group-active', has);
    catBox.classList.toggle('group-highlight', has);
    catBox.classList.toggle('tab-mode', has);
  }

  // Ink-bar: cƒÉn theo v·ªã tr√≠ chip active ƒë·ªÉ "n·ªëi m√†u" v·ªõi khu danh m·ª•c
  if(activeEl && catBox){
    const wrap = document.querySelector('.group-bar-wrapper');
    const r1 = wrap.getBoundingClientRect();
    const r2 = activeEl.getBoundingClientRect();
    const left = Math.max(0, r2.left - r1.left);
    const width = r2.width;
    catBox.style.setProperty('--ink-left', left + 'px');
    catBox.style.setProperty('--ink-width', width + 'px');
  }else if(catBox){
    catBox.style.removeProperty('--ink-left');
    catBox.style.removeProperty('--ink-width');
  }
}

/* === expose global for inline handlers === */
Object.assign(window, {
  fetchPage,
  scrollCats,
  selectCategory,
  clearAllFilters
});
/* Swipe-to-close cho t·∫•t c·∫£ Bootstrap Offcanvas tr√™n mobile */
(function () {
  const MIN_SWIPE_X = 60;  // k√©o ngang t·ªëi thi·ªÉu 60px
  const MAX_SWIPE_Y = 40;  // l·ªách d·ªçc t·ªëi ƒëa 40px

  function enableSwipeClose(el) {
    if (!el) return;
    let startX = 0, startY = 0, tracking = false;

    const onStart = (e) => {
      if (window.innerWidth > 768) return; // ch·ªâ √°p d·ª•ng mobile
      const t = e.touches ? e.touches[0] : e;
      startX = t.clientX;
      startY = t.clientY;
      tracking = true;
    };

    const onMove = (e) => {
      if (!tracking) return;
      const t = e.touches ? e.touches[0] : e;
      const dx = t.clientX - startX;
      const dy = Math.abs(t.clientY - startY);

      // Vu·ªët sang ph·∫£i ƒë·ªß xa v√† kh√¥ng l·ªách d·ªçc nhi·ªÅu
      if (dx > MIN_SWIPE_X && dy < MAX_SWIPE_Y) {
        tracking = false;
        const inst = bootstrap.Offcanvas.getOrCreateInstance(el);
        inst.hide();
      }
    };

    const onEnd = () => (tracking = false);

    // G·∫Øn s·ª± ki·ªán l√™n panel
    el.addEventListener('touchstart', onStart, { passive: true });
    el.addEventListener('touchmove', onMove, { passive: true });
    el.addEventListener('touchend', onEnd, { passive: true });

    // G·∫Øn th√™m l√™n backdrop khi panel m·ªü
    document.addEventListener('shown.bs.offcanvas', (ev) => {
      if (ev.target !== el) return;
      const backdrop = document.querySelector('.offcanvas-backdrop');
      if (backdrop) {
        backdrop.addEventListener('touchstart', onStart, { passive: true });
        backdrop.addEventListener('touchmove', onMove, { passive: true });
        backdrop.addEventListener('touchend', onEnd, { passive: true });
      }
    });
  }

// Ch·ªâ cho click card khi b·∫•m v√†o ·∫£nh icon .thumb
document.addEventListener('click', function(e){
  const a = e.target.closest('a.link-preview');
  if (!a) return;
  const onThumb = e.target.closest('.thumb');
  if (!onThumb) {
    e.preventDefault(); // b·∫•m ch·ªó kh√°c kh√¥ng ƒëi link
  }
});

   
  // Qu√©t to√†n b·ªô offcanvas hi·ªán c√≥ tr√™n trang
  document.querySelectorAll('.offcanvas').forEach(el => enableSwipeClose(el));
})();


/* === INIT === */
fetchPage();
updateFilterCount();

/* Ph√≠m t·∫Øt nhanh m·ªü search */
document.addEventListener('keydown', (e) => {
  if ((e.ctrlKey || e.metaKey) && String(e.key || '').toLowerCase() === 'k') {
    e.preventDefault();
    document.getElementById('searchBox')?.focus();
  }
});
});
</script>


<!-- ===== FOOTER ===== -->
<footer class="text-light w-100">
  <div class="container-fluid px-5">
    <div class="row pt-5 pb-3">
      <!-- C·ªôt 1: Logo + m√¥ t·∫£ -->
      <div class="col-md-3 mb-4 text-center">
        <img 
          src="https://drive.google.com/uc?export=view&id=1e9N6rgsTP5vYtKl4Lwq801dfteYLbx_F" 
          alt="2606AI logo" 
          class="mb-3 d-block mx-auto" 
          style="max-width:160px;height:auto">
        <p class="small mb-0 opacity-90">
          D·ªãch v·ª• h·ªó tr·ª£ s·∫£n xu·∫•t ·∫•n ph·∫©m th∆∞∆°ng hi·ªáu t·ª´ thi·∫øt k·∫ø ƒë·∫øn th√†nh ph·∫©m.  
          <br>Tham kh·∫£o m·∫´u - T∆∞ v·∫•n - Thi·∫øt k·∫ø - L·∫•y b√°o gi√° - ƒê·∫∑t h√†ng - ƒê√≥ng g√≥i - V·∫≠n chuy·ªÉn. 
        </p>
      </div>

      <!-- C·ªôt 2: Li√™n k·∫øt nhanh -->
      <div class="col-md-3 mb-4">
        <h6 class="fw-bold text-uppercase mb-3" style="color:#d4af37;">Li√™n k·∫øt nhanh</h6>
        <ul class="list-unstyled mb-0">
          <li class="mb-2"><a class="link-light text-decoration-none" href="about.html">V·ªÅ ch√∫ng t√¥i</a></li>
          <li class="mb-2"><a class="link-light text-decoration-none" href="#">Danh m·ª•c s·∫£n ph·∫©m</a></li>
          <li class="mb-2"><a class="link-light text-decoration-none" href="#">B√°o gi√° nhanh</a></li>
          <li class="mb-2"><a class="link-light text-decoration-none" href="#">C√¢u h·ªèi th∆∞·ªùng g·∫∑p</a></li>
        </ul>
      </div>

      <!-- C·ªôt 3: Ch√≠nh s√°ch -->
      <div class="col-md-3 mb-4">
        <h6 class="fw-bold text-uppercase mb-3" style="color:#d4af37;">Ch√≠nh s√°ch</h6>
        <ul class="list-unstyled mb-0">
          <li class="mb-2"><a class="link-light text-decoration-none" href="#">Ch√≠nh s√°ch v·∫≠n chuy·ªÉn</a></li>
          <li class="mb-2"><a class="link-light text-decoration-none" href="#">Ch√≠nh s√°ch ƒë·ªïi tr·∫£</a></li>
          <li class="mb-2"><a class="link-light text-decoration-none" href="#">H∆∞·ªõng d·∫´n ƒë·∫∑t h√†ng</a></li>
          <li class="mb-2"><a class="link-light text-decoration-none" href="#">Ch√≠nh s√°ch b·∫£o m·∫≠t</a></li>
        </ul>
      </div>

      <!-- C·ªôt 4: Li√™n h·ªá -->
      <div class="col-md-3 mb-4">
        <h6 class="fw-bold text-uppercase mb-3" style="color:#d4af37;">Li√™n h·ªá</h6>
        <ul class="list-unstyled small mb-3">
          <li class="mb-2"><i class="bi bi-geo-alt me-2"></i>ƒê·ªãa ch·ªâ: 123 ƒê∆∞·ªùng ABC, Qu·∫≠n 1, TP.HCM</li>
          <li class="mb-2"><i class="bi bi-telephone me-2"></i>Hotline:
            <a class="link-light text-decoration-none" href="tel:0909123456">0909 123 456</a></li>
          <li class="mb-2"><i class="bi bi-envelope me-2"></i>Email:
            <a class="link-light text-decoration-none" href="mailto:info@2606ai.vn">info@2606ai.vn</a></li>
        </ul>

        <div class="small opacity-90 mt-3">
          <div class="fw-bold text-uppercase mb-1">H·ªò KINH DOANH D·ªäCH V·ª§ MARKETING VINA GASE</div>
          M√£ s·ªë thu·∫ø: <strong>12333211232</strong><br>
          Li√™n h·ªá: <strong>012345678</strong><br>
          Email: <a class="text-light text-decoration-none" href="mailto:lienhengay@gmail.com">lienhengay@gmail.com</a>
        </div>

        <div class="d-flex align-items-center gap-3 mt-3">
          <a href="#" class="link-light" aria-label="Facebook"><i class="bi bi-facebook"></i></a>
          <a href="#" class="link-light" aria-label="Messenger"><i class="bi bi-messenger"></i></a>
          <a href="#" class="link-light" aria-label="Telegram"><i class="bi bi-telegram"></i></a>
          <a href="#" class="link-light" aria-label="YouTube"><i class="bi bi-youtube"></i></a>
        </div>
      </div>
    </div>
<!-- ===========================
   üåø SCRIPT CU·ªêI TRANG 2606AI
   =========================== -->
<script>
/* ===== ƒê·∫¢M B·∫¢O WORKSHOP BOX ·ªû ƒê√öNG V·ªä TR√ç ===== */
document.addEventListener('DOMContentLoaded', () => {
  const workshop  = document.getElementById('workshopBox');
  const left =
    document.getElementById('leftCol') ||
    document.querySelector('.row .col-lg-3.col-md-4') ||
    document.querySelector('.row .col-xl-3, .row .left-col, [data-left-col]');

  // Di chuy·ªÉn box ‚ÄúX∆∞·ªüng ƒë·ªÅ xu·∫•t‚Äù v·ªÅ ƒë√∫ng c·ªôt tr√°i
  if (workshop && left && !left.contains(workshop)) {
    left.appendChild(workshop);
  }

  // √âp hi·ªÉn th·ªã n·∫øu b·ªã ·∫©n do CSS responsive
  if (workshop){
    workshop.style.display    = 'block';
    workshop.style.visibility = 'visible';
    workshop.style.opacity    = '1';
  }
});
</script>

<script>
/* ===== C·∫¨P NH·∫¨T BADGE S·ªê B·ªò L·ªåC TR√äN N√öT FAB ===== */
(function(){
  const FAB_SELECTORS = ['#fabFilters', '.fab-filter', '[data-fab="filters"]'];

  function findFab(){
    for (const s of FAB_SELECTORS){
      const el = document.querySelector(s);
      if (el) return el;
    }
    return null;
  }

  // ƒê·∫øm s·ªë b·ªô l·ªçc ƒëang √°p d·ª•ng (∆∞u ti√™n state.filters n·∫øu c√≥)
  function countActiveFilters(){
    if (window.state && state.filters){
      const ignore = new Set(['page','limit','sort','q']);
      return Object.entries(state.filters).reduce((n,[k,v])=>{
        if (ignore.has(k) || v==null || v==='') return n;
        if (Array.isArray(v)) return n + v.filter(Boolean).length;
        if (typeof v==='object') return n + Object.values(v).filter(Boolean).length;
        return n + 1;
      },0);
    }
    return document.querySelectorAll('.chip.active, .chip.is-active, .filter-tag.active').length;
  }

  // Render badge
  function renderBadge(){
    const fab = findFab();
    if (!fab) return;

    let badge = fab.querySelector('.fab-badge');
    if (!badge){
      badge = document.createElement('span');
      badge.className = 'fab-badge';
      fab.style.position = fab.style.position || 'relative';
      fab.appendChild(badge);
    }

    const n = countActiveFilters();
    if (n > 0){
      badge.textContent = n > 99 ? '99+' : String(n);
      badge.style.display = 'inline-block';
      fab.setAttribute('data-has-filters', '1');
      fab.setAttribute('aria-label', `ƒêang √°p d·ª•ng ${n} b·ªô l·ªçc`);
    } else {
      badge.style.display = 'none';
      fab.removeAttribute('data-has-filters');
      fab.setAttribute('aria-label', 'Kh√¥ng c√≥ b·ªô l·ªçc');
    }
  }

  // G·ªçi khi trang t·∫£i xong
  document.addEventListener('DOMContentLoaded', renderBadge);

  // T·ª± ƒë·ªông c·∫≠p nh·∫≠t khi ng∆∞·ªùi d√πng t∆∞∆°ng t√°c v·ªõi filter
  ['click','change'].forEach(ev=>{
    document.addEventListener(ev, (e)=>{
      if (e.target.closest('.quick-filter, .chip, .filter-chip, [data-filter], #btnClearFilters, .btn-clear-filters')){
        setTimeout(renderBadge, 0);
      }
    });
  });

  // Cho ph√©p code kh√°c g·ªçi th·ªß c√¥ng
  window.updateFilterBadge = renderBadge;
})();
</script>

<!-- ===== MODAL CHI TI·∫æT S·∫¢N PH·∫®M ===== -->
<div id="detailModal" class="dtl-backdrop" hidden>
  <div class="dtl-dialog" role="dialog" aria-modal="true" aria-labelledby="dtlTitle">
    <button class="dtl-close" data-close="detailModal" aria-label="ƒê√≥ng">√ó</button>

    <div class="dtl-head">
      <img id="dtlImg" alt="" />
      <div>
        <h3 id="dtlTitle">Ti√™u ƒë·ªÅ</h3>
        <div id="dtlSub" class="dtl-sub"></div>
      </div>
    </div>

    <div id="dtlBadges" class="dtl-badges"></div>
    <div id="dtlRows" class="dtl-rows"><!-- rows auto render --></div>

    <div class="dtl-actions">
      <a id="dtlOpenImg" class="btn-ghost" target="_blank" rel="noopener">M·ªü ·∫£nh</a>
      <button class="btn-main" data-close="detailModal">ƒê√≥ng</button>
    </div>
  </div>
</div>
<!-- ===========================
   üåø K·∫æT TH√öC SCRIPT 2606AI
   =========================== -->

</body>
</html>
