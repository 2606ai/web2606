<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>PCGbrand - Qu·∫£ng b√° x∆∞·ªüng s·∫£n xu·∫•t</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;600;700;800&display=swap" rel="stylesheet">

<style>
:root{
  --main:#0018a8;
  --accent:#d4af37;
  --bg:#f5f6fa;
  --border:#e9e9ee;
}
body{font-family:'Be Vietnam Pro',sans-serif;background:var(--bg);color:#222;font-size:14px}
.container-xl{max-width:1320px}

/* NAVBAR */
.navbar{background:#fff;border-bottom:1px solid var(--border)}
.brand{font-weight:800;color:var(--main)}
.search-input{border:1px solid #ddd;border-radius:10px;padding:8px 12px;width:100%}
.btn-cart{background:var(--main);color:#fff;border:none;border-radius:10px;padding:8px 12px;font-weight:600}
.btn-cart .count{background:#fff;color:#111;border-radius:999px;padding:2px 8px;margin-left:6px;font-weight:800}

/* SIDEBAR */
.sidebar{position:sticky;top:90px}
.side-card{background:#fff;border:1px solid var(--border);border-radius:16px;
  box-shadow:0 6px 18px rgba(0,0,0,.06);padding:14px;margin-bottom:16px}
.side-title{font-weight:800;margin-bottom:8px}
.service-list,.factory-list{display:flex;flex-direction:column;gap:10px}
.service-item{display:flex;gap:10px;align-items:center;padding:8px;
  border:1px solid #eef0f4;border-radius:12px;background:#fff;transition:.2s}
.service-item:hover{background:#f9f9ff}
.service-icon{flex:0 0 36px;width:36px;height:36px;border-radius:8px;display:flex;
  align-items:center;justify-content:center;font-size:18px;background:#eef2ff;color:var(--main)}
.factory-item{display:flex;gap:10px;align-items:center;padding:10px;
  border:1px solid #eef0f4;border-radius:12px;background:#fff}
.factory-logo{flex:0 0 50px;width:50px;height:50px;border-radius:8px;overflow:hidden}
.factory-logo img{width:100%;height:100%;object-fit:cover}
.factory-body{flex:1}
.factory-name{font-weight:700;font-size:14px}
.factory-desc{font-size:12px;color:#666}
.factory-cta a{font-size:12px;background:var(--main);color:#fff;
  padding:6px 10px;border-radius:8px;text-decoration:none}
.factory-cta a:hover{opacity:.9}

/* CATEGORIES */
.cats{display:flex;gap:8px;overflow:auto;padding:8px}
.cat-btn{white-space:nowrap;border:1px solid var(--border);padding:6px 14px;
  border-radius:999px;background:#fff;cursor:pointer;font-weight:600;transition:.15s;font-size:13px}
.cat-btn:hover,.cat-btn.active{background:var(--accent);color:#fff;border-color:var(--accent)}

/* PRODUCT GRID */
.product-section{background:#fff;padding:12px;border-radius:18px;
  border:1px solid var(--border);box-shadow:0 10px 30px rgba(11,20,64,.05)}
.grid{display:grid;gap:12px;grid-template-columns:repeat(5,1fr)}
.cardx{border:0;background:#fff;transition:.2s;cursor:pointer;border-radius:12px;
  overflow:hidden;position:relative;box-shadow:0 2px 6px rgba(0,0,0,.05)}
.cardx:hover{transform:translateY(-2px);box-shadow:0 6px 12px rgba(0,0,0,.12)}
.thumb{width:100%;height:180px;object-fit:cover;display:block;background:#f2f2f2}
.meta{padding:6px;border-top:1px solid #eee}
.id{font-weight:700;font-size:12px}
.details{color:#555;font-size:11px;margin-top:2px;
  display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.type-badge{display:inline-block;margin-top:2px;padding:1px 5px;font-size:10px;border-radius:4px;
  background:#eef2ff;color:#334;border:1px solid #dde3f0}
.price{color:#0066cc;font-weight:700;font-size:12px}
.row-meta{display:flex;justify-content:space-between;align-items:center}
.add-btn{width:24px;height:24px;border-radius:6px;border:none;background:var(--main);color:#fff;
  font-size:16px;font-weight:700;display:flex;align-items:center;justify-content:center}
.add-btn:hover{background:#000f66}
.note-badge{position:absolute;top:6px;left:6px;background:#ffc107;color:#111;
  font-weight:700;padding:1px 6px;border-radius:4px;font-size:11px}

/* FOOTER */
footer{margin-top:24px;padding:18px;background:var(--main);color:#fff;text-align:center;font-size:13px}
</style>
</head>
<body>

<!-- NAVBAR -->
<nav class="navbar">
  <div class="container-xl d-flex align-items-center gap-2 py-2">
    <div class="brand me-2">PCGbrand</div>
    <input id="searchBox" class="search-input" placeholder="T√¨m s·∫£n ph·∫©m... (ID, m√¥ t·∫£, TYPE)">
    <button id="searchBtn" class="btn-cart ms-2">üîç</button>
    <button class="btn-cart ms-auto" type="button">
      üõí Gi·ªè h√†ng <span id="cartCount" class="count">0</span>
    </button>
  </div>
</nav>

<!-- CATEGORY FILTER -->
<div class="cats-wrap">
  <div id="categoryBox" class="cats"></div>
</div>

<!-- MAIN CONTENT -->
<div class="main-wrap container-xl mt-3">
  <div class="row g-3">
    <!-- SIDEBAR -->
    <div class="col-lg-3">
      <aside class="sidebar">
        <!-- Quy·ªÅn l·ª£i -->
        <div class="side-card mb-3">
          <div class="side-title">Quy·ªÅn l·ª£i khi ƒë·∫∑t h√†ng qua 2606ai.vn</div>
          <div class="service-list">
            <div class="service-item"><div class="service-icon">‚ö°</div><div>B√°o gi√° nhanh 24h</div></div>
            <div class="service-item"><div class="service-icon">üé®</div><div>Thi·∫øt k·∫ø & ch·ªânh s·ª≠a file mi·ªÖn ph√≠</div></div>
            <div class="service-item"><div class="service-icon">üëÅÔ∏è</div><div>Duy·ªát m·∫´u tr∆∞·ªõc khi s·∫£n xu·∫•t</div></div>
            <div class="service-item"><div class="service-icon">‚úÖ</div><div>QC 2 l·ªõp & b·∫£o h√†nh</div></div>
            <div class="service-item"><div class="service-icon">üöö</div><div>Giao h√†ng to√†n qu·ªëc</div></div>
          </div>
        </div>
        <!-- X∆∞·ªüng s·∫£n xu·∫•t -->
        <div class="side-card" id="factories">
          <div class="side-title">X∆∞·ªüng s·∫£n xu·∫•t uy t√≠n</div>
          <div class="factory-list" id="factoryList"></div>
        </div>
      </aside>
    </div>

    <!-- PRODUCT GRID -->
    <div class="col-lg-9">
      <div class="product-section">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <h6 class="m-0">Danh s√°ch s·∫£n ph·∫©m</h6>
          <div class="d-flex gap-2">
            <button id="prevBtn" class="btn btn-light btn-sm">‚Üê Tr∆∞·ªõc</button>
            <button id="nextBtn" class="btn btn-light btn-sm">Sau ‚Üí</button>
          </div>
        </div>
        <div class="grid" id="productGrid"></div>
      </div>
    </div>
  </div>
</div>

<footer>¬© 2025 2606ai.vn ‚Äì All rights reserved</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
const API_URL = "https://script.google.com/macros/s/AKfycbzASzlggc3PXo390AaRwU3_kopkmS10J7vKIQBnvE5BybgzA3RQ4Vd2vdzFT0RcsZEc/exec";

const state={page:1,pageSize:30,q:'',group:''};
const fmtVND=n=>(Number(n)||0).toLocaleString('vi-VN')+' ƒë';
function hiRes(url,w=250){return (url||'').replace(/=s\\d+/,'=s'+w);}
function esc(s){return(s??'').toString().replace(/&/g,'&amp;').replace(/</g,'&lt;');}

function productCardHtml(it){
  const img=hiRes(it.img,250); const full=it.full||img;
  return `
    <div class="cardx" data-full="${esc(full)}">
      ${it.chuy?`<span class="note-badge">${esc(it.chuy)}</span>`:''}
      <img class="thumb" src="${img}" loading="lazy" 
        onerror="this.src='https://via.placeholder.com/250x250?text=No+Image'">
      <div class="meta">
        <div class="id">${esc(it.id)}</div>
        <div class="details">${esc(it.details)}</div>
        ${it.type?`<div class="type-badge">${esc(it.type)}</div>`:''}
        <div class="row-meta mt-1">
          <div class="price">${fmtVND(it.price)}</div>
          <button class="add-btn" title="Th√™m v√†o gi·ªè"
            data-add='${JSON.stringify(it).replace(/'/g,"&apos;")}'>+</button>
        </div>
      </div>
    </div>`;
}

function buildCategoriesOnce(groups){
  const box=document.getElementById('categoryBox');
  const all=`<button class="cat-btn ${!state.group?'active':''}" data-group="">T·∫•t c·∫£</button>`;
  const btns=(groups||[]).map(g=>{
    const val=(g||'').trim();
    const act=(state.group||'').toLowerCase()===val.toLowerCase()?'active':'';
    return `<button class="cat-btn ${act}" data-group="${esc(val)}">${esc(val)}</button>`;
  }).join('');
  box.innerHTML=all+btns;
  box.addEventListener('click',e=>{
    const btn=e.target.closest('.cat-btn'); if(!btn) return;
    state.group=(btn.dataset.group||'').trim(); state.page=1; fetchPage();
  });
}

function fetchPage(){
  document.getElementById('productGrid').innerHTML='<div>ƒêang t·∫£i...</div>';
  fetch(`${API_URL}?action=list&page=${state.page}&pageSize=${state.pageSize}&q=${encodeURIComponent(state.q||'')}&group=${encodeURIComponent(state.group||'')}`)
    .then(r=>r.json())
    .then(res=>{
      if(res?.facets?.groups) buildCategoriesOnce(res.facets.groups);
      const grid=document.getElementById('productGrid');
      grid.innerHTML=(res.items||[]).map(it=>productCardHtml(it)).join('')||'<div>Kh√¥ng c√≥ s·∫£n ph·∫©m.</div>';
    })
    .catch(err=>{console.error(err);document.getElementById('productGrid').innerHTML='<div>L·ªói t·∫£i d·ªØ li·ªáu</div>';});
}

document.getElementById('prevBtn').onclick=()=>{if(state.page>1){state.page--;fetchPage();}};
document.getElementById('nextBtn').onclick=()=>{state.page++;fetchPage();};
document.getElementById('searchBtn').onclick=()=>{state.q=document.getElementById('searchBox').value.trim();state.page=1;fetchPage();};
document.getElementById('searchBox').addEventListener('keypress',e=>{if(e.key==='Enter'){state.q=e.target.value.trim();state.page=1;fetchPage();}});

document.addEventListener('DOMContentLoaded',()=>{fetchPage();});
</script>
</body>
</html>
