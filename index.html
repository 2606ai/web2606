<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>2606AI</title>

<!-- Bootstrap & Icons -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

<style>
/* =========================
   2606AI – CLEAN BASE CSS
   ========================= */

/* ---- Theme tokens ---- */
:root{
  --main:#0018a8;
  --accent:#d4af37;
  --bg:#f5f6fa;

  --text:#1f2937;
  --muted:#6b7280;

  --card:#ffffff;
  --border:#e7ecf7;

  --shadow-sm:0 1px 2px rgba(0,0,0,.06);
  --shadow-md:0 2px 8px rgba(0,0,0,.08);
  --shadow-lg:0 6px 16px rgba(0,0,0,.16);
}

/* ---- Base ---- */
html,body{height:100%}
body{
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
  font-size:14px;
  color:var(--text);
  background:var(--bg);
  padding-top:70px;
}
img{max-width:100%;display:block}

/* Container width to match header/footer */
.container-fluid,.wrap{max-width:1400px;margin:0 auto}

/* ---- Header ---- */
.site-header{
  position:fixed; inset:0 0 auto 0; z-index:1055;
  background:#fff; border-bottom:1px solid #eee;
  box-shadow:var(--shadow-sm);
  padding:10px 15px;
}
.site-header .wrap{display:flex;align-items:center;gap:12px}
.site-header img.logo{width:84px;aspect-ratio:3/2;object-fit:contain;cursor:pointer}
.header-search{flex:1}
.header-search .form-control{font-size:13px;padding:6px 10px}
@media (max-width:992px){
  .site-header img.logo{width:72px}
}

/* ---- Top banner (marquee) ---- */
.top-banner{
  position:sticky; top:70px; z-index:1054;
  height:32px; display:flex; align-items:center; justify-content:center;
  background:var(--main); color:#fff; font-weight:700; line-height:32px;
  overflow:hidden
}
.top-banner .marquee{
  white-space:nowrap; display:inline-block;
  animation:marquee 60s linear infinite
}
@keyframes marquee{0%{transform:translateX(100%)}100%{transform:translateX(-100%)}}

/* ---- Sidebar generic block ---- */
.sidebar-box{
  background:var(--card); border:1px solid var(--border);
  border-radius:12px; padding:12px; box-shadow:var(--shadow-sm); margin-bottom:15px
}
.sidebar-box h6{font-weight:700;font-size:15px;margin-bottom:8px}

/* ---- Benefits (6 items) ---- */
.benefits-v3 .grid{display:grid;grid-template-columns:1fr;gap:8px}
.benefits-v3 .bcard{
  background:#fff;border:1px solid #eef2ff;border-radius:12px;padding:12px;
  display:flex;gap:10px;align-items:center;min-height:60px;position:relative;box-shadow:var(--shadow-sm)
}
.benefits-v3 .ic{width:36px;height:36px;border-radius:8px;background:#f1f4ff;display:inline-flex;align-items:center;justify-content:center}
.benefits-v3 .ttl{font-weight:600;font-size:12px;line-height:1.3}
.benefits-v3 .sub{font-size:12px;color:var(--muted)}
.benefit-note{position:absolute;top:6px;right:8px;font-size:11px;font-weight:700;padding:2px 6px;border-radius:999px;color:#fff}
.benefit-free{background:#4caf50}
.benefit-paid{background:#d32f2f}

/* ---- Hero banners ---- */
.hero{margin-bottom:15px}
.hero .carousel{border-radius:12px;overflow:hidden;box-shadow:var(--shadow-sm)}
.hero .mini img{height:145px;object-fit:cover;border-radius:12px}
.hero .main img{height:300px;object-fit:cover;border-radius:12px}
.hero .carousel .carousel-indicators [data-bs-target]{width:8px;height:8px;border-radius:50%}

/* =========================================================
   GROUP BAR (BIG tiles, fill full row) + DOTS = groups count
   ========================================================= */

/* wrapper */
.group-bar-wrapper{
  background:#fff;border:1px solid var(--border);border-radius:12px;
  padding:10px 12px; box-shadow:var(--shadow-sm); margin-bottom:6px;
  position:relative;
}
/* Arrows for group bar */
.group-arrow{
  position:absolute;
  top:50%;
  transform:translateY(-50%);
  background:transparent;
  border:none;
  font-size:22px;
  color:var(--main);
  cursor:pointer;
  z-index:2;
}
.group-arrow.left{ left:-4px }
.group-arrow.right{ right:-4px }

/* grid that auto-fits columns so tiles are big and flush */
.group-bar-scroll{
  display:flex !important;
  gap:10px;
  overflow-x:auto;
  overflow-y:hidden;
  scroll-behavior:smooth;
  scrollbar-width:none;
}
.group-bar-scroll::-webkit-scrollbar{ display:none; }


/* tile */
.group-chip{
  display:flex !important; align-items:center; justify-content:center;
  min-height:48px;
  padding:10px 16px !important;
  text-align:center; white-space:normal !important; overflow-wrap:anywhere;
  font-size:14px !important; font-weight:700 !important;
  color:#0a33cc !important;
  background:#f8faff !important;
  border:1.5px solid #dce3f5 !important;
  border-radius:10px !important;
  cursor:pointer; user-select:none;
  transition:transform .12s ease, box-shadow .12s ease, background .12s ease, color .12s ease, border-color .12s ease;
}
.group-chip:hover{transform:translateY(-1px);box-shadow:var(--shadow-md)}
.group-chip.active{
  background:var(--main) !important; color:#fff !important; border-color:var(--main) !important;
  box-shadow:0 6px 16px rgba(0,24,168,.18)
}

/* dots (equal to group count) */
.group-dots{display:flex;justify-content:center;gap:8px;margin:6px 0 10px}
.group-dots .dot{
  width:8px;height:8px;border-radius:50%;background:#c9d6ff;transition:transform .15s, background .15s
}
.group-dots .dot.active{background:var(--main);transform:scale(1.25)}

/* =========================================================
   CATEGORY SCROLLER (two rows grid + small arrows)
   ========================================================= */
.category-box{background:#fff;border-radius:12px;padding:10px;box-shadow:var(--shadow-sm);border:1px solid var(--border)}
.category-wrapper{position:relative}
.category-scroll{
  display:grid;
  grid-template-columns:repeat(6,1fr);
  grid-template-rows:repeat(2,auto);
  gap:12px; overflow:hidden
}
.category-item{
  text-align:center;padding:10px;border-radius:10px;cursor:pointer;transition:.15s; border:1px solid transparent
}
.category-item:hover{background:#f8f9ff}
.category-item.active{background:#e8f1ff;border-color:#a7c4ff}
.category-item .icon{width:48px;height:48px;border-radius:12px;background:#f1f4ff;display:inline-flex;align-items:center;justify-content:center;margin-bottom:6px}
.category-item .icon img{width:28px;height:28px;object-fit:contain}
.category-item span{font-size:13px;display:block}

.cat-arrow{
  position:absolute; top:45%; transform:translateY(-50%);
  background:transparent; border:none; font-size:22px; color:var(--main); cursor:pointer; z-index:2
}
.cat-arrow.left{left:-4px} .cat-arrow.right{right:-4px}

@media (max-width:1200px){
  .category-scroll{grid-template-columns:repeat(5,1fr)}
}
@media (max-width:992px){
  .category-scroll{grid-template-columns:repeat(4,1fr)}
}
@media (max-width:768px){
  .category-scroll{grid-template-columns:repeat(3,1fr)}
}
@media (max-width:576px){
  .category-scroll{grid-template-columns:repeat(2,1fr)}
}

/* ---- Stats/Pager ---- */
#statsBar{
  background:#fff;border:1px solid var(--border);border-radius:10px;
  padding:8px 12px; box-shadow:var(--shadow-sm)
}
.pager-bar{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end}
.pager-bar .btn{min-width:40px}

/* =========================================================
   PRODUCT CARD GRID
   ========================================================= */
.cardx{
  border:none;border-radius:12px;background:#fff;overflow:hidden;
  box-shadow:var(--shadow-sm);transition:transform .1s ease, box-shadow .1s ease;height:100%;display:flex;flex-direction:column
}
.cardx:hover{transform:translateY(-2px);box-shadow:var(--shadow-md)}
.cardx .thumb-wrap{position:relative;background:#fff}
.cardx img.thumb{width:100%;height:180px;object-fit:cover;aspect-ratio:4/3}
.cardx .note-chip{
  position:absolute;top:8px;right:8px;padding:2px 6px;border-radius:999px;font-size:10px;font-weight:400;color:#fff;background:#555
}
.cardx .meta{padding:10px;display:flex;flex-direction:column;gap:6px}
.cardx .id{font-weight:700;color:var(--main);font-size:13px}
.cardx .details{font-size:12px;color:#666;min-height:2.2em;line-height:1.2}
.cardx .type-badge{display:inline-block;background:#e0f0ff;color:#0056b3;font-size:11px;font-weight:700;padding:2px 6px;border-radius:12px}
.cardx .price{font-weight:400;color:#d32f2f;font-size:1rem;margin-top:2px}
.cardx .meta-actions{display:flex;align-items:center;justify-content:space-between;gap:8px}
.cardx .btn-gift{
  background:#fff;border:1px solid var(--main);color:var(--main);font-weight:700;
  padding:6px 10px;border-radius:999px;font-size:12px;line-height:1;display:inline-flex;align-items:center;gap:6px;text-decoration:none;max-width:70%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis
}
.cardx .btn-gift:hover{background:var(--main);color:#fff;text-decoration:none}
.add-btn{
  border:none;background:var(--main);color:#fff;border-radius:50%;
  width:32px;height:32px;font-size:18px;font-weight:800;display:flex;align-items:center;justify-content:center
}

/* ---- Ads list (sidebar) ---- */
.ads-box{
  background:linear-gradient(180deg,#e3f2fd 0%,#bbdefb 100%);
  border:1px solid #90caf9;border-radius:12px;padding:12px
}
#adsList{max-height:62vh;overflow:auto;padding-right:4px;scroll-behavior:smooth;content-visibility:auto;contain-intrinsic-size:800px}
#adsList .link-preview{
  display:flex;gap:10px;background:#fff;border:1px solid #e3f2fd;border-radius:10px;padding:10px;box-shadow:var(--shadow-sm)
}
#adsList .title{font-weight:700}
#adsList .desc{font-size:12px;color:var(--muted)}
#adsList .site{font-size:12px;color:#1565c0}

/* ---- Suppliers Offcanvas ---- */
.offcanvas{z-index:4000}
.offcanvas-backdrop{z-index:3990}

.sup-toolbar{
  position:sticky; top:0; z-index:2; background:#fff; margin:-12px -12px 12px; padding:12px;
  border-bottom:1px solid var(--border); border-radius:12px 12px 0 0
}
.sup-toolbar .counter{font-size:12px;color:var(--muted);display:flex;align-items:center;gap:8px}
.sup-toolbar .pill{background:#eef3ff;color:var(--main);border:1px solid #dbe3ff;padding:2px 8px;border-radius:999px;font-weight:700;font-size:12px}
.supplier-list{max-height:62vh;overflow:auto;padding-right:4px}
.supplier-card{
  border:1px solid var(--border);border-radius:12px;padding:10px;background:#fff;
  box-shadow:var(--shadow-sm)
}
.supplier-card .title{font-weight:700;font-size:14px}
.supplier-card .meta{font-size:12px;color:var(--muted)}
.supplier-card .chips{display:flex;gap:6px;flex-wrap:wrap;margin-top:6px}
.supplier-card .chip{font-size:11px;padding:2px 8px;border-radius:999px;background:#f6f7fb;border:1px solid #e5e9ff;color:#475569}
.supplier-card .chip.ok{background:#e8f7ee;border-color:#c7ead5;color:#256c3b}

/* ---- Cart Offcanvas ---- */
#cartCanvas .offcanvas-header{
  background:var(--main); color:#fff; border:0; border-radius:12px 12px 0 0
}
#cartCanvas .offcanvas-body{font-size:13px;padding:16px}
#cartCanvas input.form-control,#cartCanvas textarea.form-control,#cartCanvas select.form-select{
  border-radius:10px;font-size:13px;border:1px solid #dbe3ff
}
#cartCanvas input:focus,#cartCanvas textarea:focus,#cartCanvas select:focus{
  border-color:var(--main); box-shadow:0 0 0 0.2rem rgba(0,24,168,0.15)
}
#cartCanvas .btn{border-radius:999px;font-weight:600;font-size:13px}
#cartCanvas #clearCartBtn{background:#fbe9e7;color:#d32f2f;border:1px solid #ffcdd2}
#cartCanvas #clearCartBtn:hover{background:#ffcdd2}
#cartCanvas #submitOrderBtn{background:#2e7d32;border:none}
#cartCanvas #submitOrderBtn:hover{background:#1b5e20}
#cartCanvas .alert{border-radius:10px;font-size:12px;background:#f4f6fd;color:#333;border:1px solid #dbe3ff}
#cartCanvas .summary-box{background:#fff8e1;border:1px solid #ffe082;border-radius:10px;padding:8px 12px;margin-bottom:12px}
#cartCanvas #cartTotal{font-weight:700;font-size:16px;color:#d32f2f}

/* ---- Filter panel ---- */
#filterPanel h6{font-weight:700;font-size:14px;margin:16px 0 8px;color:var(--main);text-transform:uppercase;letter-spacing:.3px}
.filter-box-group{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:12px}
.filter-tag{
  border:1px solid #dbe3ff;background:#f9faff;border-radius:20px;padding:6px 12px;
  font-size:13px;font-weight:500;color:#333;cursor:pointer;transition:.15s
}
.filter-tag:hover{background:#eef3ff;border-color:#b3c8ff}
.filter-tag.active{background:var(--main);color:#fff;border-color:var(--main);box-shadow:0 2px 8px rgba(0,24,168,.25)}

/* ---- Floating Action Buttons ---- */
.cart-fab,.filter-fab,.suppliers-fab,.zalo-fab{
  position:fixed; right:16px; width:54px; height:54px; border:none; border-radius:50%;
  color:#fff; font-size:22px; line-height:54px; box-shadow:0 6px 16px rgba(0,0,0,.25);
  z-index:2500; cursor:pointer; display:flex; align-items:center; justify-content:center
}
.filter-fab{background:#6c757d;bottom:212px}
.cart-fab{background:var(--main);bottom:148px}
.suppliers-fab{background:#0d6efd;bottom:84px}
.zalo-fab{background:#25D366;bottom:20px}
.fab-badge{position:absolute;top:-6px;right:-6px;background:#d32f2f;color:#fff;border-radius:999px;padding:2px 6px;font-size:12px;font-weight:700;display:none}

/* ---- Footer ---- */
.site-footer{background:#fff;border-top:1px solid #eee;padding:16px 0;margin-top:20px;font-size:13px;color:#555}
.site-footer .brand{font-weight:700;color:var(--main)}
.site-footer a{color:inherit;text-decoration:none}
.site-footer a:hover{text-decoration:underline}
.footer-social{display:flex;gap:8px}
.footer-social .social{width:36px;height:36px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;color:#fff;font-weight:800;text-decoration:none}
.footer-social .social-zalo{background:#0068ff}
.footer-social .social-fb{background:#1877F2}
@media (max-width:576px){.footer-social{justify-content:flex-start;margin-top:8px}}

/* ---- Error toast ---- */
#errbox{
  position:fixed;left:8px;right:8px;bottom:8px;z-index:3000;
  background:#ffefef;border:1px solid #e99;border-radius:8px;padding:8px;
  display:none;white-space:pre-wrap;font-family:ui-monospace,Consolas,monospace
}

/* ---- Footer hero ads ---- */
.hero-ads img{height:180px;object-fit:cover;border-radius:12px}

/* Minor helpers */
.small{font-size:.875rem}

/* ====== Giữ nguyên style nhóm/tabs Tiki đã chọn (nhẹ hóa) ===== */
.category-box{ --cat-radius:12px; }
.category-box .group-bar-wrapper{
  margin: 0 0 10px 0 !important; padding: 0 !important; background: transparent !important; border: 0 !important;
  border-radius:0 !important; box-shadow:none !important;
}
#groupBar{ display:flex; gap:10px !important; overflow-x:auto; scrollbar-width:none; align-items:center; }
#groupBar::-webkit-scrollbar{ display:none; }
#groupBar .group-chip{
  border:0 !important; background:transparent !important; color:#0a33cc !important;
  border-radius:999px !important; padding:10px 16px !important; font-weight:600 !important; text-transform:none !important;
  line-height:1.1; white-space:nowrap; transition:background .12s ease, color .12s ease;
}
#groupBar .group-chip:hover{ background:rgba(0,24,168,.08) !important; }
#groupBar .group-chip.active{ background:#0018a8 !important; color:#fff !important; }
#groupDots{ margin:6px 0 12px !important; gap:6px; }
#groupDots .dot{ width:6px; height:6px; border-radius:50%; background:#c9d6ff; }
#groupDots .dot.active{ background:#0018a8; transform:scale(1.2); }
.category-box .category-wrapper{
  border:0 !important; border-radius:12px !important; padding:14px !important; background:#fff !important;
  box-shadow:0 2px 10px rgba(0,0,0,.04) !important;
}
.category-scroll{ gap:16px !important; }
.category-item{ border:0 !important; background:transparent !important; padding:8px 6px !important; border-radius:12px !important; transition: transform .12s ease, background .12s ease; }
.category-item:hover{ background:#f7f9ff !important; transform: translateY(-1px); }
.category-item .icon{ width:56px !important; height:56px !important; border-radius:16px !important; background:#f2f6ff !important; display:inline-flex; align-items:center; justify-content:center; box-shadow:0 4px 12px rgba(0,0,0,.06); margin-bottom:8px !important; }
.category-item .icon img{ width:32px !important; height:32px !important; object-fit:contain; }
.category-item span{ font-size:12px !important; line-height:1.25; color:#111; display:block; }
.category-item.active span{ color:#0018a8; font-weight:700; }

/* Thống kê + Pager cùng hàng, không đổi bố cục */
.stats-row{ display:flex; align-items:center; justify-content:space-between; gap:8px; flex-wrap:nowrap; overflow-x:auto; margin-bottom:8px; }
#pagerTop .btn, #pagerBottom .btn{ height:32px; padding:.35rem .6rem; font-size:.875rem; line-height:1.2; border-radius:.25rem; min-width:40px; }
#pagerTop .form-select, #pagerBottom .form-select{ min-width:110px; }

/* Ẩn chấm dưới carousel/pagination nội bộ như cũ */
.carousel-indicators, #groupDots.hidden { display:none !important; }

/* ==== SKELETON cho card khi tải (chỉ thêm UI, không đổi nội dung) ==== */
.card-skeleton {
  border-radius:12px; background:#fff; box-shadow:var(--shadow-sm);
  height:100%; padding:0; overflow:hidden;
}
.card-skeleton .sk-thumb { height:180px; background:#eef2ff; }
.card-skeleton .sk-line  { height:10px; background:#f1f4ff; margin:8px 10px; border-radius:6px; }
.card-skeleton .sk-line.w60{ width:60% } .card-skeleton .sk-line.w80{ width:80% } .card-skeleton .sk-line.w40{ width:40% }
   /* subtle fade when categories rebuild */
.fade-out{
  opacity:.85;
  transition:opacity .15s ease;
}

   
</style>
</head>
<body>

<header class="site-header">
  <div class="wrap">
    <a id="logoLink" href="#" class="d-flex align-items-center text-decoration-none">
      <img src="https://drive.google.com/thumbnail?id=1e9N6rgsTP5vYtKl4Lwq801dfteYLbx_F&sz=w160" class="logo" alt="2606AI logo">
    </a>
    <form id="filter-form" class="header-search d-flex gap-2 m-0" onsubmit="return false;">
      <div class="input-group w-100">
        <input id="searchBox" class="form-control" placeholder="Tìm sản phẩm... (ID, mô tả)" aria-label="Tìm sản phẩm">
        <button id="searchBtn" class="btn btn-primary" type="button">Tìm</button>
      </div>
    </form>
  </div>
</header>

<div class="top-banner" role="region" aria-label="Thông báo">
  <div class="wrap">
    <div class="marquee">
      Để đảm bảo quyền lợi hãy thông báo với 2606AI.VN khi bạn đã chốt đơn hàng &nbsp; • &nbsp;
      Nguồn thu của 2606AI.VN đến từ quảng cáo &nbsp; • &nbsp;
      Có sự hỗ trợ của 2606AI.VN tự tin sản xuất mọi sản phẩm
    </div>
  </div>
</div>

<div class="container-fluid my-3">
  <div class="row g-3">
    <!-- Sidebar -->
    <div class="col-lg-3 col-md-4">
      <div class="sidebar-box benefits-v3">
        <h6 class="mb-2">Chúng tôi có gì cho bạn...</h6>
        <div class="grid">
          <div class="bcard" data-benefit="b1" role="button" tabindex="0" aria-label="Tham khảo 10,000+ mẫu sản phẩm">
            <span class="benefit-note benefit-free">Miễn phí</span>
            <div class="ic">📚</div>
            <div>
              <div class="ttl">1. Tham khảo 10,000+ mẫu sản phẩm</div>
              <div class="sub">Không lo thiếu ý tưởng</div>
            </div>
          </div>
          <div class="bcard" data-benefit="b2" role="button" tabindex="0" aria-label="500+ nhà cung cấp và xưởng sản xuất">
            <span class="benefit-note benefit-free">Miễn phí</span>
            <div class="ic">🏭</div>
            <div>
              <div class="ttl">2. Hơn 500+ nhà cung cấp và xưởng sản xuất</div>
              <div class="sub">Báo giá nhanh, đa dạng, dễ dàng so sánh giá</div>
            </div>
          </div>
          <div class="bcard" data-benefit="b3" role="button" tabindex="0" aria-label="Hỗ trợ tư vấn sản xuất">
            <span class="benefit-note benefit-free">Miễn phí</span>
            <div class="ic">🎨</div>
            <div>
              <div class="ttl">3. Hỗ trợ tư vấn sản xuất</div>
              <div class="sub">Phản hồi nhanh, đáp ứng nhiều nhu cầu</div>
            </div>
          </div>
          <div class="bcard" data-benefit="b4" role="button" tabindex="0" aria-label="Hỗ trợ thiết kế 2D, 3D sản xuất">
            <span class="benefit-note benefit-free">Miễn phí</span>
            <div class="ic">⚙️</div>
            <div>
              <div class="ttl">4. Hỗ trợ thiết kế 2D, 3D sản xuất</div>
              <div class="sub">Mockup miễn phí cho các đơn hàng chốt</div>
            </div>
          </div>
          <div class="bcard" data-benefit="b5" role="button" tabindex="0" aria-label="Hậu cần vận chuyển và đóng gói">
            <span class="benefit-note benefit-paid">Có phí</span>
            <div class="ic">📦</div>
            <div>
              <div class="ttl">5. Hậu cần vận chuyển và đóng gói hàng hóa</div>
              <div class="sub">Dịch vụ nhanh chuyên nghiệp</div>
            </div>
          </div>
          <div class="bcard" data-benefit="b6" role="button" tabindex="0" aria-label="Hỗ trợ giải quyết tranh chấp">
            <span class="benefit-note benefit-paid">Có phí</span>
            <div class="ic">🤝</div>
            <div>
              <div class="ttl">6. Hỗ trợ giải quyết tranh chấp</div>
              <div class="sub">Bảo vệ quyền lợi khách hàng</div>
            </div>
          </div>
        </div>
      </div>

      <!-- XƯỞNG ĐỀ XUẤT -->
      <div class="sidebar-box ads-box">
        <h6 class="fw-bold mb-2 d-flex align-items-center justify-content-between">
          <span class="d-inline-flex align-items-center gap-2">
            Xưởng đề xuất
            <span id="adsCount" class="badge rounded-pill text-bg-primary" style="font-weight:700;display:none">0</span>
          </span>
        </h6>
      </div>
      <div id="adsList" class="d-flex flex-column gap-2"></div>
      <div id="adsEmpty" class="small text-muted">Chọn bộ lọc để xem đơn vị phù hợp (dựa trên cột “quangcao”).</div>

      <div class="mt-2 text-center">
        <a id="adsContactBtn2" href="#" target="_blank" rel="noopener"
           class="btn btn-sm fw-bold px-3"
           style="border-radius:999px;background:#ffca28;color:#0d47a1;border:none">
           📢 LIÊN HỆ ĐẶT QUẢNG CÁO
        </a>
      </div>
    </div>

    <!-- Content -->
    <div class="col-lg-9 col-md-8">
      <!-- HERO -->
      <div class="hero row g-2">
        <div class="col-md-8 main">
          <div id="heroMain" class="carousel slide" data-bs-ride="carousel" data-bs-interval="4000">
            <div class="carousel-inner">
              <div class="carousel-item active"><img loading="lazy" class="d-block w-100" src="https://picsum.photos/1200/300?random=11" alt="Banner 1"></div>
              <div class="carousel-item"><img loading="lazy" class="d-block w-100" src="https://picsum.photos/1200/300?random=12" alt="Banner 2"></div>
              <div class="carousel-item"><img loading="lazy" class="d-block w-100" src="https://picsum.photos/1200/300?random=13" alt="Banner 3"></div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#heroMain" data-bs-slide="prev"><span class="carousel-control-prev-icon"></span></button>
            <button class="carousel-control-next" type="button" data-bs-target="#heroMain" data-bs-slide="next"><span class="carousel-control-next-icon"></span></button>
          </div>
        </div>
        <div class="col-md-4 d-flex flex-column gap-2 mini">
          <div id="heroRight1" class="carousel slide" data-bs-ride="carousel" data-bs-interval="3500">
            <div class="carousel-inner">
              <div class="carousel-item active"><img loading="lazy" src="https://picsum.photos/600/145?random=21" class="d-block w-100" alt="Promo 1"></div>
              <div class="carousel-item"><img loading="lazy" src="https://picsum.photos/600/145?random=22" class="d-block w-100" alt="Promo 2"></div>
            </div>
          </div>
          <div id="heroRight2" class="carousel slide" data-bs-ride="carousel" data-bs-interval="4200">
            <div class="carousel-inner">
              <div class="carousel-item active"><img loading="lazy" src="https://picsum.photos/600/145?random=23" class="d-block w-100" alt="Promo 3"></div>
              <div class="carousel-item"><img loading="lazy" src="https://picsum.photos/600/145?random=24" class="d-block w-100" alt="Promo 4"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Danh mục (Group chips + Category scroller) -->
      <div class="category-box mb-3">
        <div id="groupDots" class="group-dots" aria-label="Vị trí trang nhóm"></div>

        <div class="group-bar-wrapper">
          <button class="group-arrow left" id="groupPrev">‹</button>
          <div class="group-bar-scroll" id="groupBar"></div>
          <button class="group-arrow right" id="groupNext">›</button>
        </div>

        <div class="category-wrapper">
          <button class="cat-arrow left"  type="button" aria-label="prev" onclick="scrollCats(-1)">‹</button>
          <div id="categoryScroll" class="category-scroll"></div>
          <button class="cat-arrow right" type="button" aria-label="next" onclick="scrollCats(1)">›</button>
        </div>
      </div>

      <!-- Thống kê + Pagination -->
      <div class="stats-row row g-2 align-items-center">
        <div class="col-auto d-flex align-items-center found-count">
          <span class="lbl">Tìm thấy</span>
          <span id="totalCount" class="badge text-bg-primary">0</span>
          <button id="clearFiltersBtn2" class="btn btn-sm btn-outline-danger ms-2">Xóa bộ lọc</button>
        </div>
        <div class="col text-end">
          <div id="pagerTop" class="d-inline-flex"></div>
        </div>
      </div>

      <!-- Grid -->
      <div id="productGrid" class="row row-cols-2 row-cols-md-3 row-cols-lg-6 g-2" aria-live="polite"></div>

      <!-- Pagination Bottom -->
      <div id="pagerBottom" class="mt-3 pager-bar"></div>

      <!-- Footer ads -->
      <div class="hero-ads my-3">
        <div id="footerAds" class="carousel slide" data-bs-ride="carousel" data-bs-interval="4000">
          <div class="carousel-inner">
            <div class="carousel-item active">
              <img loading="lazy" src="https://picsum.photos/1200/200?random=91" class="d-block w-100" alt="Quảng cáo 1">
            </div>
            <div class="carousel-item">
              <img loading="lazy" src="https://picsum.photos/1200/200?random=92" class="d-block w-100" alt="Quảng cáo 2">
            </div>
            <div class="carousel-item">
              <img loading="lazy" src="https://picsum.photos/1200/200?random=93" class="d-block w-100" alt="Quảng cáo 3">
            </div>
          </div>
          <button class="carousel-control-prev" type="button" data-bs-target="#footerAds" data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
          </button>
          <button class="carousel-control-next" type="button" data-bs-target="#footerAds" data-bs-slide="next">
            <span class="carousel-control-next-icon"></span>
          </button>
        </div>
      </div>
      <!-- /Footer ads -->

    </div>
  </div>
</div>

<!-- Offcanvas: Giỏ hàng -->
<div class="offcanvas offcanvas-end" tabindex="-1" id="cartCanvas" aria-labelledby="cartCanvasLabel">
  <div class="offcanvas-header">
    <h5 id="cartCanvasLabel" class="mb-0">Giỏ hàng</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
  </div>
  <div class="offcanvas-body">
    <div id="cartList"></div>

    <div class="summary-box d-flex justify-content-between align-items-center">
      <span>Tổng cộng</span><span id="cartTotal">0 đ</span>
    </div>

    <button class="btn btn-danger w-100 mb-2" id="clearCartBtn">Xóa toàn bộ</button>

    <input id="buyerName" class="form-control mb-2" placeholder="Họ và tên" aria-label="Họ và tên">
    <input id="buyerEmail" class="form-control mb-2" placeholder="Email" aria-label="Email">
    <input id="buyerPhone" class="form-control mb-2" placeholder="Số điện thoại" aria-label="Số điện thoại">
    <input id="buyerAddress" class="form-control mb-2" placeholder="Địa chỉ nhận hàng" aria-label="Địa chỉ nhận hàng">
    <textarea id="buyerNote" class="form-control mb-2" placeholder="Ghi chú" aria-label="Ghi chú"></textarea>

    <label class="form-label mt-2">Tải tệp yêu cầu / thiết kế (tùy chọn)</label>
    <input id="buyerFile" type="file" class="form-control mb-2" accept=".pdf,.doc,.docx,.xls,.xlsx,.png,.jpg,.jpeg,.zip">

    <div class="row g-2">
      <div class="col-12">
        <label class="form-label">Dịch vụ LẤY BÁO GIÁ HỘ (tùy chọn)</label>
        <select id="servicePlan" class="form-select">
          <option value="">— Không chọn —</option>
          <option value="100000-3">100.000 đ / 3 báo giá</option>
          <option value="500000-10">500.000 đ / 10 báo giá</option>
        </select>
      </div>
      <div class="col-12">
        <div class="form-check mt-2">
          <input class="form-check-input" type="checkbox" id="fileQuote">
          <label class="form-check-label" for="fileQuote">Báo giá theo tệp tải lên</label>
        </div>
      </div>
    </div>

    <div class="alert alert-secondary mt-3 mb-2" style="font-size:12px">
      <div><strong>Hướng dẫn:</strong></div>
      <div>1) Bạn cần làm giống mẫu nào hoặc mua sản phẩm gì bấm gửi, chúng tôi sẽ sớm liên hệ lại sau.</div>
      <div>2) Ghi rõ yêu cầu sẽ giúp chúng tôi tư vấn cho bạn dễ dàng hơn.</div>
      <div>3) CSKH của 2606ai.vn sẽ trực tiếp liên hệ bạn trong vòng 24h (nếu quá thời gian này, vui lòng liên hệ lại).</div>
    </div>

    <button class="btn btn-success w-100" id="submitOrderBtn">Gửi đơn hàng</button>
  </div>
</div>

<!-- Offcanvas: Bộ lọc -->
<div class="offcanvas offcanvas-end" tabindex="-1" id="filterPanel" aria-labelledby="filterPanelLabel">
  <div class="offcanvas-header">
    <h5 id="filterPanelLabel" class="mb-0">Bộ lọc nâng cao</h5>
    <div class="d-flex gap-2">
      <button type="button" class="btn btn-outline-danger btn-sm" id="clearFiltersBtn">Xóa bộ lọc</button>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
    </div>
  </div>
  <div class="offcanvas-body">
    <h6>ẤN PHẨM THƯƠNG HIỆU</h6><div id="brandBox" class="mb-3"></div>
    <h6>TYPE</h6><div id="typeBox" class="mb-3"></div>
    <h6>LOẠI SẢN PHẨM</h6><div id="loaiBox" class="mb-3"></div>
    <h6>CHÚ Ý</h6><div id="noteBox" class="mb-3"></div>
  </div>
</div>

<!-- Offcanvas: Danh sách xưởng -->
<div class="offcanvas offcanvas-end" tabindex="-1" id="suppliersCanvas" aria-labelledby="suppliersLabel">
  <div class="offcanvas-header">
    <h5 id="suppliersLabel" class="mb-0">Danh sách xưởng</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
  </div>
  <div class="offcanvas-body">
    <div class="sup-toolbar">
      <div class="row g-2 align-items-center">
        <div class="col-12">
          <input id="supSearch" class="form-control" placeholder="Tìm theo tên, địa chỉ, chứng nhận…">
        </div>
        <div class="col-7 d-flex align-items-center gap-2">
          <select id="supSort" class="form-select form-select-sm" style="max-width:210px">
            <option value="name">Sắp xếp A→Z (Tên)</option>
            <option value="addr">Theo địa chỉ</option>
          </select>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="supHasSite">
            <label class="form-check-label small" for="supHasSite">Chỉ xưởng có website</label>
          </div>
        </div>
        <div class="col-5">
          <div class="counter justify-content-end">
            <span class="pill" id="suppliersCount">0</span>
            <span class="small">xưởng phù hợp</span>
          </div>
        </div>
      </div>
    </div>

    <div id="suppliersList" class="supplier-list">Chưa có dữ liệu.</div>

    <div class="mt-3">
      <a id="adsContactBtn" href="#" target="_blank" rel="noopener"
         class="btn btn-primary w-100">LIÊN HỆ ĐẶT QUẢNG CÁO</a>
    </div>
  </div>
</div>

<!-- Modal chi tiết Lợi ích -->
<div class="modal fade" id="benefitModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content" style="border-radius:16px">
      <div class="modal-header" style="background:var(--main);color:#fff;border:0">
        <h5 class="modal-title" id="benefitTitle">Chi tiết</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" style="filter:invert(1)"></button>
      </div>
      <div class="modal-body">
        <div id="benefitLead" class="text-muted mb-2"></div>
        <ul id="benefitList" class="mb-2"></ul>
        <div id="benefitNote" class="small text-muted"></div>
      </div>
      <div class="modal-footer" style="border:0">
        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Đã hiểu</button>
      </div>
    </div>
  </div>
</div>

<!-- FABs -->
<button id="filterFab" class="filter-fab" aria-label="Mở bộ lọc">
  ⚙️ <span id="filterFabCount" class="fab-badge">0</span>
</button>
<button id="cartFab" class="cart-fab" aria-label="Mở giỏ hàng">
  🛒 <span id="cartFabCount" class="fab-badge">0</span>
</button>
<button id="suppliersFab" class="suppliers-fab" aria-label="Danh sách xưởng">🏭</button>
<a id="zaloFab" class="zalo-fab" aria-label="Zalo" href="#" target="_blank" rel="noopener">💬</a>

<div id="errbox" role="alert" aria-live="assertive"></div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
/* ===== ERROR ===== */
(function(){
  const box=document.getElementById('errbox');
  function show(msg){ box.style.display='block'; box.textContent='[ERROR] '+msg; console.error(msg); }
  window.addEventListener('error', e=>show(e.message+(e.filename?(' @ '+e.filename+':'+e.lineno):'')));
  window.addEventListener('unhandledrejection', e=>show('Promise rejected: '+((e.reason&&e.reason.message)||e.reason)));
})();

document.addEventListener('DOMContentLoaded', () => {
  /* ==== CONFIG ===== */
  const API_URL = "https://script.google.com/macros/s/AKfycbyIFaZx_Y3lTZ0qc06fCvrXGNF3fLxa40A4qqeCgHN6AdKg2UeDoxwgaoMzNPCLv8nf/exec";
  const ZALO_URL = "#";
  const ADS_CONTACT_URL = "#";
  const API_KEY = "";

  /* ===== FAST PAGINATION CACHE (thêm mới – KHÔNG đổi nội dung) ===== */
  const CACHE = new Map();               // key -> { ts, data }
  const CACHE_MAX = 50;
  const CACHE_TTL = 2 * 60 * 1000;       // 2 phút

  function cacheKeyFromState(st = state){
    return JSON.stringify({
      page: st.page, pageSize: st.pageSize, q: st.q,
      group: st.group, type: st.type, loai: st.loai, note: st.note, category: st.category
    });
  }
  function cacheGet(key){
    const it = CACHE.get(key);
    if(!it) return null;
    if(Date.now() - it.ts > CACHE_TTL){ CACHE.delete(key); return null; }
    return it.data;
  }
  function cacheSet(key, data){
    if(CACHE.size >= CACHE_MAX){
      let oldestKey, oldestTs = Infinity;
      for(const [k,v] of CACHE){ if(v.ts < oldestTs){ oldestTs = v.ts; oldestKey = k; } }
      if(oldestKey) CACHE.delete(oldestKey);
    }
    CACHE.set(key, { ts: Date.now(), data });
  }
  function prefetchNext(){
    if(state.page >= state.totalPages) return;
    const nextState = { ...state, page: state.page + 1 };
    const key = cacheKeyFromState(nextState);
    if (CACHE.has(key)) return;
    const params = new URLSearchParams({
      action:'list', page:nextState.page, pageSize:nextState.pageSize,
      q:nextState.q, group:nextState.group, type:nextState.type,
      loai:nextState.loai, note:nextState.note, category:nextState.category
    });
    fetch(API_URL + '?' + params.toString())
      .then(r=>r.json())
      .then(res=> cacheSet(key, res))
      .catch(()=>{});
  }

// ✅ Di chuyển #groupDots ra ngoài .category-box (giữ nguyên UI)
const catBox = document.querySelector('.category-box');
const dots   = document.getElementById('groupDots');   // <-- thêm dòng này

if (catBox && dots && catBox.contains(dots)) {
  catBox.after(dots);
}


  /* === Helpers === */
  function chunk(arr, size){ const out=[]; for(let i=0;i<arr.length;i+=size) out.push(arr.slice(i,i+size)); return out; }
  function getCols(){
    const el = document.querySelector('.group-bar-scroll') || document.getElementById('groupBar');
    const n = getComputedStyle(el).getPropertyValue('--cols');
    return Math.max(1, parseInt(n,10) || 4);
  }

  /* Map tên nhóm -> icon */
  const GROUP_ICONS = {
    "QUÀ TẶNG 247 EXPRESS (Đối tác)":"https://img.icons8.com/fluency/96/parcel.png",
    "QUÀ TẶNG ẤN PHẨM THƯƠNG HIỆU":"https://img.icons8.com/fluency/96/advertising.png",
    "QUÀ TẶNG SẢN PHẨM THƯƠNG HIỆU":"https://img.icons8.com/fluency/96/product.png",
    "QUÀ TẶNG KỶ NIỆM EVENT THƯƠNG HIỆU":"https://img.icons8.com/fluency/96/conference-foreground-selected.png",
    "QUÀ TẶNG PHỤ KIỆN THƯƠNG HIỆU":"https://img.icons8.com/fluency/96/electronics.png",
    "KHÁC":"https://img.icons8.com/fluency/96/more.png"
  };
  function iconForGroup(name){ return GROUP_ICONS[name] || GROUP_ICONS["KHÁC"]; }

function renderGroups(groups){
  const bar = document.getElementById('groupBar');
  const dotsBox = document.getElementById('groupDots');
  if(!bar || !dotsBox) return;

  const list = groups || [];
  bar.innerHTML = list.map(g => `
    <div class="group-chip ${state.group === g ? 'active' : ''}"
         data-action="select-group" data-val="${esc(g)}">
      <span class="chip-text">${esc(g)}</span>
    </div>
  `).join('');

  dotsBox.innerHTML = list.map((_,i) =>
    `<span class="dot ${state.group === list[i] ? 'active' : ''}" data-idx="${i}"></span>`
  ).join('');

  window._lastGroups = list;
  // 👇 thêm 2 dòng này
  updateGroupArrows();
  updateGroupDots();
}


  /* === Mũi tên & Dots === */
  const groupBarEl = document.getElementById('groupBar');
  const dotBox     = document.getElementById('groupDots');
  const btnPrev    = document.getElementById('groupPrev');
  const btnNext    = document.getElementById('groupNext');

  function currentPage(){
    if(!groupBarEl) return 0;
    const w = groupBarEl.clientWidth || 1;
    return Math.round(groupBarEl.scrollLeft / w);
  }
  function pagesCount(){
    return groupBarEl ? Math.ceil(groupBarEl.scrollWidth / (groupBarEl.clientWidth||1)) : 1;
  }
  function scrollToPage(p){
    const w = groupBarEl.clientWidth;
    groupBarEl.scrollTo({ left: p*w, behavior: 'smooth' });
  }
  function updateGroupArrows(){
    if(!groupBarEl || !btnPrev || !btnNext) return;
    const p = currentPage(), pc = pagesCount();
    btnPrev.disabled = (p <= 0);
    btnNext.disabled = (p >= pc-1);
  }
   
  function updateGroupDots(){
  const dotEls = document.querySelectorAll('#groupDots .dot');
  const chips  = document.querySelectorAll('#groupBar .group-chip');
  let activeIdx = -1;
  chips.forEach((c,i)=>{ if(c.dataset.val === (state.group||'')) activeIdx = i; });
  dotEls.forEach((d,i)=> d.classList.toggle('active', i===activeIdx));
}
   
  btnPrev?.addEventListener('click', ()=> scrollToPage(Math.max(0, currentPage()-1)));
  btnNext?.addEventListener('click', ()=> scrollToPage(Math.min(pagesCount()-1, currentPage()+1)));
  groupBarEl?.addEventListener('scroll', ()=>{
    clearTimeout(groupBarEl._t); groupBarEl._t = setTimeout(()=>{ updateGroupArrows(); updateGroupDots(); }, 60);
  });
  dotBox?.addEventListener('click', (e)=>{
    const dot = e.target.closest('.dot'); if(!dot) return;
    const idx = Number(dot.dataset.idx)||0;
    const chips = document.querySelectorAll('#groupBar .group-chip');
    const chip = chips[idx];
    if(chip){
      state.group = chip.dataset.val || '';
      state.page = 1;
      updateGroupUI();
      updateGroupDots();
      fetchPage();
      chip.scrollIntoView({behavior:'smooth', inline:'center', block:'nearest'});
    }
  });
  window.addEventListener('resize', ()=>{
    if(window._repaint_t){ clearTimeout(window._repaint_t); }
    window._repaint_t = setTimeout(()=> renderGroups((window._lastGroups)||[]), 120);
  });

  /* === GHI ĐÈ buildCategoryFromFacets → gọi renderGroups mới === */
  function buildCategoryFromFacets(facets){
    const groups = facets?.groups_all || facets?.groups || [];
    window._lastGroups = groups;
    renderGroups(groups);

    const catEl = document.getElementById('categoryScroll');
    if (catEl) catEl.classList.add('fade-out');
    buildCategory(facets?.categories || []);
    buildFilterBox('typeBox',  facets?.types  || [], 'type');
    buildFilterBox('loaiBox',  facets?.loais  || [], 'loai');
    buildFilterBox('noteBox',  facets?.notes  || [], 'note');
    buildFilterBox('brandBox', facets?.categories || [], 'category');
    requestAnimationFrame(() => catEl && catEl.classList.remove('fade-out'));
  }

  /* STATE (giữ nguyên logic) */
  const AUTO_OPEN_ON_ADD = false;
  const state = { page:1, pageSize:36, q:'', group:'', type:'', loai:'', note:'', category:'', totalPages:1 };
  // (Tuỳ chọn) Giảm pageSize trên mobile để nhẹ trang — KHÔNG đổi UI & nội dung
  if (matchMedia('(max-width: 576px)').matches) { state.pageSize = 24; }

  const cart = []; const products = {};

  /* UTILS */
  const fmtVND = n => (Number(n)||0).toLocaleString('vi-VN') + ' đ';
  const esc = s => (s??'').toString().replace(/[&<>"]/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c]));
  function badgeColor(txt){
  const t = String(txt||'').toLowerCase();
  if(t.includes('mẫu')||t.includes('sample')) return '#4caf50';
  if(t.includes('giảm')||t.includes('sale')||t.includes('km')) return '#ff9800';
  if(t.includes('gấp')||t.includes('urgent')) return '#d32f2f';
  return '#555';
}
  function hostnameFromUrl(u){ try{ return new URL(u).hostname; }catch(e){ return (u||'').replace(/^https?:\/\//,''); } }
  function firstLink(s){ if(!s) return ''; const parts=String(s).split(/[\s,;|\n]+/).filter(Boolean); for(const p of parts) if(/^https?:\/\//i.test(p)) return p; return parts[0]||''; }

  /* Nâng chất lượng thumbnail Google Drive/Gusercontent (giữ nguyên, tối ưu mobile) */
  function upgradeThumbQuality(u){
    try{
      if(!u) return u;
      const url = new URL(u, location.href);
      if (url.hostname.includes('googleusercontent') || url.hostname.includes('google.com')) {
        const isMobile = matchMedia('(max-width: 576px)').matches;
        const w = isMobile ? 'w600' : 'w800';
        if (url.searchParams.has('sz')) url.searchParams.set('sz', w);
        else url.searchParams.append('sz', w);
        return url.toString();
      }
    }catch(_){
      return String(u).replace(/([?&])sz=w\d+/, `$1sz=${matchMedia('(max-width: 576px)').matches?'w600':'w800'}`);
    }
    return u;
  }

  /* Logo reload */
  document.getElementById('logoLink').addEventListener('click', (e)=>{ e.preventDefault(); window.scrollTo({top:0,behavior:'smooth'}); setTimeout(()=>location.reload(),150); });

  /* Product card */
  function productCardHtml(it){
    products[it.id]=it;
    const giftUrl   = firstLink(it.imageClick);
    const showGift  = !!giftUrl;
    const giftLabel = (it.loai || 'Nhận quà').toString().trim();
    const thumbSrc = upgradeThumbQuality(it.img);
    const linkHref = esc(it.linkFull || it.img || '#');

    return `<div class="cardx">
      <div class="thumb-wrap">
        <a href="${linkHref}" target="_blank" rel="noopener">
          <img loading="lazy" decoding="async" class="thumb" src="${esc(thumbSrc)}" alt="Sản phẩm ${esc(it.id)}" onerror="this.src='https://via.placeholder.com/300x300?text=No+Image'">
        </a>
        ${it.note?`<span class="note-chip" style="background:${badgeColor(it.note)}">${esc(it.note)}</span>`:''}
      </div>
      <div class="meta">
        <div class="id">${esc(it.id)}</div>
        <div class="details">${esc(it.details||'')}</div>
        ${it.type ? `<div class="type-badge">${esc(it.type)}</div>` : ``}
        <div class="price">${fmtVND(it.price)}</div>
        <div class="meta-actions">
          ${showGift ? `<a class="btn-gift" href="${esc(giftUrl)}" target="_blank" rel="noopener" title="${esc(giftLabel)}"><span>${esc(giftLabel)}</span></a>` : `<span></span>`}
          <button class="add-btn" data-action="add-to-cart" data-id="${esc(it.id)}" aria-label="Thêm ${esc(it.id)} vào giỏ">+</button>
        </div>
      </div>
    </div>`;
  }

  /* ========= PAGER ========= */
  function renderPagination(totalItems, pageSize, currentPage){
    const totalPages = Math.max(1, Math.ceil((totalItems || 0) / (pageSize || 1)));
    state.totalPages = totalPages;

    const block = (where) => `
      <div class="d-inline-flex align-items-center gap-1" data-where="${where}">
        <button type="button" class="btn btn-sm btn-outline-secondary" data-action="page-prev" ${currentPage<=1?'disabled':''}>&lsaquo;</button>
        <select class="form-select form-select-sm page-select" style="width:auto">
          ${Array.from({length: totalPages}, (_, i) => {
            const p = i + 1;
            return `<option value="${p}" ${p===currentPage?'selected':''}>Trang ${p}/${totalPages}</option>`;
          }).join('')}
        </select>
        <button type="button" class="btn btn-sm btn-outline-secondary" data-action="page-next" ${currentPage>=totalPages?'disabled':''}>&rsaquo;</button>
      </div>
    `;

    const top = document.getElementById('pagerTop');
    const bot = document.getElementById('pagerBottom');
    if (top) top.innerHTML = block('top');
    if (bot) bot.innerHTML = block('bottom');

    document.querySelectorAll('#pagerTop .page-select, #pagerBottom .page-select')
      .forEach(sel => {
        sel.onchange = (e) => {
          state.page = parseInt(e.target.value, 10) || 1;
          fetchPage();
        };
      });
    document.querySelectorAll('#pagerTop [data-action="page-prev"], #pagerBottom [data-action="page-prev"]')
      .forEach(btn => btn.onclick = () => { if (state.page > 1) { state.page--; fetchPage(); } });
    document.querySelectorAll('#pagerTop [data-action="page-next"], #pagerBottom [data-action="page-next"]')
      .forEach(btn => btn.onclick = () => { if (state.page < state.totalPages) { state.page++; fetchPage(); } });

    const leftBlock = document.querySelector('.found-count');
    if (leftBlock && top) {
      leftBlock.appendChild(top);
      top.classList.add('ms-2');
    }
  }

  /* ====== CATEGORY ====== */
  let catIndex = 0;
  const catsPerView = 12; // 6 x 2
  let allCategories = [];

  const CATEGORY_ICONS={
    "MÓC KHÓA":"https://img.icons8.com/color/48/keychain.png",
    "TƯỢNG ĐẤT":"https://img.icons8.com/color/48/clay.png",
    "LEN":"https://img.icons8.com/color/48/yarn.png",
    "BADGE":"https://img.icons8.com/color/48/medal2.png",
    "KHÁC":"https://img.icons8.com/color/48/categorize.png"
  };
  function iconForCat(val){
    const key=(val||'').toString().toUpperCase();
    return CATEGORY_ICONS[key] || CATEGORY_ICONS["KHÁC"];
  }
   
  function renderCategoryPager(items){
  const box = document.getElementById('categoryScroll');
  if(!box) return;
  const slice = items.slice(catIndex, catIndex + catsPerView);
  box.innerHTML = slice.map(val => `
    <div class="category-item ${state.category===val?'active':''}"
         data-action="select-category" data-val="${esc(val)}">
      <div class="icon"><img src="${iconForCat(val)}" alt="Danh mục ${esc(val||'Khác')}"></div>
      <span>${esc(val||'Khác')}</span>
    </div>
  `).join('');
}

  function scrollCats(dir){
    const total = allCategories.length;
    catIndex += dir * catsPerView;
    if(catIndex < 0) catIndex = 0;
    if(catIndex >= total) catIndex = Math.max(0, total - catsPerView);
    renderCategoryPager(allCategories);
  }
  function buildCategory(items){
    allCategories = items || [];
    catIndex = 0;
    renderCategoryPager(allCategories);
  }
  function selectCategory(val){
    state.category=val; state.page=1; fetchPage();
    document.querySelectorAll('#categoryScroll .category-item').forEach(el=>el.classList.toggle('active', el.dataset.val===val));
  }

  function buildFilterBox(boxId, items, field){
    const box=document.getElementById(boxId);
    if(!box) return;
    box.classList.add("filter-box-group");
    box.innerHTML=(items||[]).map(val=>`
      <div class="filter-tag ${state[field]===val?'active':''}"
        data-action="set-filter" data-field="${field}" data-val="${esc(val)}" role="button" tabindex="0">
        ${esc(val||'Tất cả')}
      </div>
    `).join('');
  }
  function updateFilterCount(){
    let c=0; if(state.type)c++; if(state.loai)c++; if(state.note)c++; if(state.category)c++;
    const fb=document.getElementById('filterFabCount');
    if(fb){ fb.textContent=c; fb.style.display=c? 'inline-block':'none'; }
  }

  /* Link preview API */
  function fetchLinkPreview(url){
    const qs = new URLSearchParams({ action:'preview', url });
    return fetch(API_URL + '?' + qs.toString()).then(r => r.json());
  }

  /* ===== XƯỞNG ĐỀ XUẤT ===== */
  let adsData = [];
  function renderAds(items){
    adsData = items || [];
    const list = document.getElementById('adsList');
    const empty = document.getElementById('adsEmpty');
    const badge = document.getElementById('adsCount');

    if(!list) return;
   list.innerHTML = adsData.map(it => {
  const url   = it.url   || it.link  || '';
  const img   = it.img   || it.thumb || '';
  const title = it.title || it.name  || 'Đơn vị';
  const desc  = it.desc  || it.description || '';
  const site  = url ? (new URL(url, location.href).hostname) : '';

  return `
    <a class="link-preview text-decoration-none" href="${esc(url||'#')}" target="_blank" rel="noopener">
      <img class="thumb" src="${esc(img)}" alt="${esc(title)}"
           onerror="this.src='https://via.placeholder.com/64?text=%20'">
      <div class="flex-grow-1">
        <div class="title">${esc(title)}</div>
        ${desc ? `<div class="desc">${esc(desc)}</div>` : ``}
        ${site ? `<div class="site">${esc(site)}</div>` : ``}
      </div>
    </a>
  `;
}).join('');


    if (badge){
      badge.textContent = adsData.length;
      badge.style.display = adsData.length ? 'inline-block' : 'none';
    }
    if (empty){
      empty.style.display = adsData.length ? 'none' : 'block';
    }
  }
  function fetchAds(){
    const qs = new URLSearchParams({
      action:'ads',
      q:state.q, group:state.group, type:state.type, loai:state.loai, note:state.note, category:state.category
    });
    fetch(API_URL + '?' + qs.toString())
      .then(r=>r.json())
      .then(r=>renderAds(r.items||[]))
      .catch(()=>renderAds([]));
  }

  /* Cart */
  function addToCartById(id){ const it=products[id]; if(!it) return; const f=cart.find(p=>p.id===id); if(f) f.qty++; else cart.push({...it,qty:1}); updateCart(); if (AUTO_OPEN_ON_ADD) cartOffcanvas.show(); }
  function changeQty(id,delta){ const it=cart.find(p=>p.id===id); if(!it) return; it.qty+=delta; if(it.qty<=0) cart.splice(cart.indexOf(it),1); updateCart(); }
  function removeItem(id){ const i=cart.findIndex(p=>p.id===id); if(i>=0) cart.splice(i,1); updateCart(); }
  function clearCart(){ if(confirm("Xóa toàn bộ giỏ hàng?")){ cart.length=0; updateCart(); } }
  function updateCart(){
    const count = cart.reduce((a,b)=>a+b.qty,0);
    const fabCount = document.getElementById('cartFabCount');
    if(fabCount){ fabCount.textContent=count; fabCount.style.display = count>0 ? 'inline-block' : 'none'; }
    const list=document.getElementById('cartList'); let total=0;
    list.innerHTML=cart.map(it=>{
      const sub=it.qty*(Number(it.price)||0); total+=sub;
      return `<div class="d-flex align-items-center gap-2 border-bottom py-2">
        <img src="${esc(it.img)}" alt="Ảnh ${esc(it.id)}" style="width:50px;height:50px;object-fit:cover;border-radius:4px;border:1px solid #ddd">
        <div class="flex-grow-1">
          <div class="fw-semibold small">${esc(it.details||it.id)}</div>
          <div class="text-muted small">${fmtVND(it.price)}</div>
        </div>
        <div class="d-flex align-items-center gap-1">
          <button class="btn btn-sm btn-outline-secondary" data-action="qty" data-id="${esc(it.id)}" data-delta="-1">-</button>
          <span>${it.qty}</span>
          <button class="btn btn-sm btn-outline-secondary" data-action="qty" data-id="${esc(it.id)}" data-delta="1">+</button>
        </div>
        <div style="min-width:90px;text-align:right" class="small">${fmtVND(sub)}</div>
        <button class="btn btn-sm btn-link text-danger" data-action="remove" data-id="${esc(it.id)}" aria-label="Xóa ${esc(it.id)}">&times;</button>
      </div>`;
    }).join('');
    document.getElementById('cartTotal').innerText=fmtVND(total);
  }

  /* GỬI ĐƠN – hỗ trợ file */
  async function submitOrder(){
    if(cart.length===0){ alert("Giỏ hàng trống!"); return; }
    const name=document.getElementById("buyerName").value.trim();
    const email=document.getElementById("buyerEmail").value.trim();
    const phone=document.getElementById("buyerPhone").value.trim();
    const address=document.getElementById("buyerAddress").value.trim();
    const note=document.getElementById("buyerNote").value.trim();
    const file=document.getElementById("buyerFile").files[0]||null;
    const servicePlan=document.getElementById("servicePlan").value;
    const fileQuote=document.getElementById("fileQuote").checked;

    if(!name||!email||!phone||!address){ alert("Vui lòng nhập đầy đủ thông tin!"); return; }

    const order={
      customer:{name,email,phone,address,note, servicePlan, fileQuote},
      items:cart.map(({id,details,type,price,qty,img,linkFull,group,loai,category,note})=>({id,details,type,price,qty,img,linkFull,group,loai,category,note})),
      total:cart.reduce((a,b)=>a+b.qty*(Number(b.price)||0),0)
    };

    try{
      let resp;
      if(file){
        const fd=new FormData();
        fd.append('action','order');
        fd.append('data', JSON.stringify(order));
        if(API_KEY) fd.append('key', API_KEY);
        fd.append('file', file);
        resp = await fetch(API_URL, { method:'POST', body:fd });
      }else{
        resp = await fetch(API_URL, {
          method:"POST",
          headers:{"Content-Type":"application/json"},
          body:JSON.stringify({action:"order", data:order, key:API_KEY||""})
        });
      }
      const res = await resp.json();
      if(res && (res.ok||res.success)){
        const mailState = res.mail || 'ok';
        alert(mailState==='ok' ? "Đã gửi đơn hàng thành công!" : "Đã lưu đơn hàng. Gửi email bị lỗi — chúng tôi sẽ kiểm tra lại.");
        cart.length=0; updateCart();
      }else{
        alert("Gửi đơn hàng thất bại.");
      }
    }catch(_){
      alert("Không thể gửi đơn hàng. Kiểm tra API_URL.");
    }
  }

  /* Suppliers (offcanvas) */
  let suppliersAll = [];
  function normalize(s){ return (s||'').toString().toLowerCase().trim(); }
  function supplierCardHTML(s){
    const hasSite = !!s.url;
    return `
      <div class="supplier-card mb-2">
        <div class="title">${esc(s.name||'Xưởng')}</div>
        ${hasSite
          ? `<a href="${esc(s.url)}" target="_blank" rel="noopener" class="small text-truncate d-inline-block" style="max-width:100%">${esc(s.url)}</a>`
          : `<div class="small text-muted">(Không có website cụ thể)</div>`}
        ${s.address?`<div class="meta mt-1">📍 ${esc(s.address)}</div>`:''}
        <div class="chips">
          <span class="chip ${hasSite?'ok':''}">${hasSite?'Có website':'Chưa có website'}</span>
          ${s.cert?`<span class="chip">Chứng nhận: ${esc(s.cert)}</span>`:''}
        </div>
      </div>`;
  }
  function renderSuppliersList(items){
    const box = document.getElementById('suppliersList');
    const counter = document.getElementById('suppliersCount');
    counter.textContent = `${items.length}/${suppliersAll.length}`;
    box.innerHTML = items.length ? items.map(supplierCardHTML).join('') : '<div class="text-muted">Không tìm thấy xưởng phù hợp.</div>';
  }
  function applySupFilters(){
    const q = normalize(document.getElementById('supSearch').value);
    const hasSite = document.getElementById('supHasSite').checked;
    const sortBy  = document.getElementById('supSort').value;

    let out = suppliersAll.filter(s=>{
      if(hasSite && !s.url) return false;
      if(!q) return true;
      const hay = normalize([s.name, s.address, s.cert, s.url].join(' '));
      return hay.includes(q);
    });

    if(sortBy === 'addr'){
      out.sort((a,b)=> normalize(a.address).localeCompare(normalize(b.address)));
    } else {
      out.sort((a,b)=> normalize(a.name).localeCompare(normalize(b.name)));
    }
    renderSuppliersList(out);
  }
  function debounce(fn, ms){ let t; return (...a)=>{ clearTimeout(t); t=setTimeout(()=>fn.apply(this,a),ms); }; }
  function loadSuppliers(){
    const box = document.getElementById('suppliersList');
    box.innerHTML='Đang tải…';
    fetch(API_URL+'?action=suppliers')
      .then(r=>r.json())
      .then(res=>{
        if(!res||!res.ok||!res.items){ suppliersAll=[]; applySupFilters(); return; }
        suppliersAll = res.items.map(s=>({
          name: s.name || '', url:  s.url  || '', address: s.address || '', cert: s.cert || '', contact: s.contact || ''
        }));
        applySupFilters();
      })
      .catch(()=>{ box.innerHTML='<div class="text-danger">Không tải được danh sách.</div>'; });
  }

  /* GẮN SỰ KIỆN CHO BỘ LỌC XƯỞNG */
  (function bindSuppliersFilterEvents(){
    const $q  = document.getElementById('supSearch');
    const $ok = document.getElementById('supHasSite');
    const $so = document.getElementById('supSort');
    if($q)  $q.addEventListener('input', debounce(applySupFilters, 250));
    if($ok) $ok.addEventListener('change', applySupFilters);
    if($so) $so.addEventListener('change', applySupFilters);
  })();

  /* Offcanvas instances */
  const cartOffcanvas   = bootstrap.Offcanvas.getOrCreateInstance(document.getElementById('cartCanvas'));
  const filterOffcanvas = bootstrap.Offcanvas.getOrCreateInstance(document.getElementById('filterPanel'));
  const suppliersOffcanvas = bootstrap.Offcanvas.getOrCreateInstance(document.getElementById('suppliersCanvas'));

  /* ==== RENDER LÔ (incremental) cho grid – KHÔNG đổi dữ liệu ==== */
  function renderGridIncremental(items){
    const grid = document.getElementById('productGrid');
    if (!items.length){
      grid.innerHTML = '<div class="text-muted">Không có sản phẩm.</div>';
      return;
    }
    const skeletons = Array.from({length: items.length}).map(()=>`
      <div class="col">
        <div class="card-skeleton">
          <div class="sk-thumb"></div>
          <div class="sk-line w80"></div>
          <div class="sk-line w60"></div>
          <div class="sk-line w40"></div>
        </div>
      </div>
    `).join('');
    grid.innerHTML = skeletons;

    const BATCH = 12;
    let i = 0;
    const doBatch = (deadline) => {
      let count = 0;
      while(i < items.length && (deadline ? deadline.timeRemaining() > 8 : count < BATCH)){
        const col = document.createElement('div');
        col.className = 'col';
        col.innerHTML = productCardHtml(items[i]);
        grid.replaceChild(col, grid.children[i]);
        i++; count++;
      }
      if(i < items.length){
        (window.requestIdleCallback || window.setTimeout)(doBatch, 0);
      }
    };
    (window.requestIdleCallback || window.setTimeout)(doBatch, 0);
  }

  /* Events */
  document.addEventListener('click', (e)=>{
    const el = e.target;
    if(el.matches('[data-action="goto-page"], [data-action="page-prev"], [data-action="page-next"]')){
      e.preventDefault();
    }
    if(el.matches('[data-action="add-to-cart"]')){ addToCartById(el.dataset.id); }
    if(el.matches('[data-action="remove"]')){ removeItem(el.dataset.id); }
    if(el.matches('[data-action="qty"]')){ const id = el.dataset.id; const d  = Number(el.dataset.delta)||0; changeQty(id, d); }

    if(el.closest('[data-action="select-category"]')){ selectCategory(el.closest('[data-action="select-category"]').dataset.val || ''); }

    if(el.matches('[data-action="set-filter"]')){
      const field = el.dataset.field;
      state[field] = el.dataset.val || '';
      state.page = 1;
      fetchPage();
      updateFilterCount();
    }

    if(el.matches('#searchBtn')){
      state.q = document.getElementById('searchBox').value.trim();
      state.page = 1;
      fetchPage();
    }

    if(el.matches('[data-action="page-prev"]')){ if(state.page > 1){ state.page--; fetchPage(); } }
    if(el.matches('[data-action="page-next"]')){ if(state.page < state.totalPages){ state.page++; fetchPage(); } }
    if(el.matches('[data-action="goto-page"]')){
      const p = Number(el.dataset.page);
      if(p && p !== state.page){ state.page = p; fetchPage(); }
    }

    if(el.matches('[data-action="select-group"]')){
      state.group = el.dataset.val || '';
      state.page  = 1;
      updateGroupUI();
      fetchPage();
      updateFilterCount();
    }
  });

  document.getElementById('searchBox').addEventListener('keydown',e=>{
    if(e.key==='Enter'){ e.preventDefault(); document.getElementById('searchBtn').click(); }
  });

  /* FAB */
  document.getElementById('cartFab').addEventListener('click', () => cartOffcanvas.toggle());
  document.getElementById('filterFab').addEventListener('click', () => filterOffcanvas.toggle());
  document.getElementById('suppliersFab').addEventListener('click', ()=>{ loadSuppliers(); suppliersOffcanvas.show(); });
  document.getElementById('zaloFab').setAttribute('href', ZALO_URL);
  document.getElementById('adsContactBtn').setAttribute('href', ADS_CONTACT_URL);
  document.getElementById('adsContactBtn2').setAttribute('href', ADS_CONTACT_URL);

  /* Clear filters (2 nút) */
  function clearAllFilters(){
    state.type=''; state.loai=''; state.note=''; state.category=''; state.group=''; state.q='';
    const sb=document.getElementById('searchBox'); if(sb) sb.value='';
    updateFilterCount(); state.page=1; fetchPage();
  }
  document.getElementById('clearFiltersBtn').addEventListener('click', clearAllFilters);
  document.getElementById('clearFiltersBtn2').addEventListener('click', clearAllFilters);

  /* Gửi đơn hàng */
  document.getElementById('submitOrderBtn').addEventListener('click', submitOrder);

  /* ===== Modal Chi tiết Lợi ích ===== */
  const BENEFIT_DETAIL = {
    b1:{ title:'Tham khảo 10,000+ mẫu sản phẩm', lead:'Kho ý tưởng lớn, cập nhật thường xuyên.', bullets:[
        'Tìm nhanh theo ID, từ khóa, loại sản phẩm','Ảnh/Link nguồn tham khảo rõ ràng','Lưu mẫu yêu thích vào giỏ để xin báo giá' ] },
    b2:{ title:'500+ nhà cung cấp & xưởng sản xuất', lead:'Kết nối nhanh – đa dạng – so sánh giá dễ dàng.', bullets:[
        'Lọc theo loại hình/xuất xứ/ghi chú','Gợi ý xưởng ngay trong “Xưởng đề xuất”','Có thể gửi cùng lúc cho nhiều đơn vị' ] },
    b3:{ title:'Hỗ trợ tư vấn sản xuất (Miễn phí)', lead:'Đội ngũ CSKH phản hồi nhanh và cụ thể.', bullets:[
        'Tư vấn vật liệu, quy cách, định mức','Ước tính chi phí sơ bộ','Định hướng phương án tối ưu theo ngân sách' ] },
    b4:{ title:'Hỗ trợ thiết kế 2D, 3D sản xuất', lead:'Phục vụ trực tiếp cho đơn hàng đã chốt.', bullets:[
        'Dựng mockup/khung kỹ thuật cơ bản','Xuất file .SVG, .PDF theo yêu cầu xưởng','Miễn phí cho đơn đã xác nhận đặt hàng' ] },
    b5:{ title:'Hậu cần vận chuyển & đóng gói (Có phí)', lead:'Đảm bảo giao nhận đúng hẹn – an toàn.', bullets:[
        'Nhận đóng gói – dán tem – chia kiện','Theo dõi tracking – xử lý phát sinh','Báo phí rõ ràng trước khi triển khai' ], note:'Phí dịch vụ sẽ cộng riêng vào tổng đơn theo báo giá.' },
    b6:{ title:'Hỗ trợ giải quyết tranh chấp (Có phí)', lead:'Tăng cường bảo vệ quyền lợi khách hàng khi phát sinh sự cố.', bullets:[
        'Thu thập chứng cứ – làm việc với xưởng','Đề xuất phương án khắc phục/hoàn tiền','Đồng hành cho đến khi kết thúc vụ việc' ], note:'Chỉ áp dụng cho đơn hàng đã thông báo cho 2606AI.' }
  };
  (function attachBenefitModal(){
    const modalEl = document.getElementById('benefitModal');
    const modal = bootstrap.Modal.getOrCreateInstance(modalEl);
    const $title = document.getElementById('benefitTitle');
    const $lead  = document.getElementById('benefitLead');
    const $list  = document.getElementById('benefitList');
    const $note  = document.getElementById('benefitNote');
    function openDetail(key){
      const d = BENEFIT_DETAIL[key]; if(!d) return;
      $title.textContent = d.title || 'Chi tiết';
      $lead.textContent  = d.lead  || '';
      $list.innerHTML    = (d.bullets||[]).map(li=>`<li>${li}</li>`).join('');
      $note.textContent  = d.note || '';
      modal.show();
    }
    document.querySelectorAll('.benefits-v3 .bcard[data-benefit]').forEach(card=>{
      const key = card.getAttribute('data-benefit');
      card.addEventListener('click', ()=>openDetail(key));
      card.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' ') { e.preventDefault(); openDetail(key); }});
      card.style.cursor = 'pointer';
    });
  })();

  /* ==== FETCH & RENDER ==== */
  function render(res){
    const items = (res?.items||[]);
    const grid=document.getElementById('productGrid');

    // dùng incremental render để mượt (không đổi dữ liệu)
    renderGridIncremental(items);

    buildCategoryFromFacets(res?.facets||{});
    document.getElementById('totalCount').textContent = Number(res?.total||0).toLocaleString('vi-VN');
    renderPagination(res?.total||0, state.pageSize, state.page);
    updateGroupUI();
    updateGroupDots();
  }

  let _inflight;
  function setLoadingUI(isLoading){
    const badge = document.getElementById('totalCount');
    if(badge){ if(isLoading){ badge.textContent = '…'; } }
  }
  function fetchPage(){
    const key = cacheKeyFromState();
    const cached = cacheGet(key);
    if(cached){
      render(cached);
      (window.requestIdleCallback?requestIdleCallback(prefetchNext):setTimeout(prefetchNext, 120));
      return;
    }
    if (_inflight) { try{ _inflight.abort(); }catch{} }
    const ctl = new AbortController(); _inflight = ctl;

    setLoadingUI(true);
    const params=new URLSearchParams({
      action:'list',page:state.page,pageSize:state.pageSize,
      q:state.q,group:state.group,type:state.type,loai:state.loai,note:state.note,category:state.category
    });

    fetch(API_URL+'?'+params.toString(), { signal: ctl.signal })
      .then(r=>r.json())
      .then(res => {
        if(ctl.signal.aborted) return;
        cacheSet(key, res);
        render(res);
        (window.requestIdleCallback?requestIdleCallback(fetchAds):setTimeout(fetchAds,200));
        (window.requestIdleCallback?requestIdleCallback(prefetchNext):setTimeout(prefetchNext,120));
      })
      .catch(err=>{
        if(err?.name==='AbortError') return;
        document.getElementById('productGrid').innerHTML='<div class="text-danger">Không tải được dữ liệu.</div>';
      })
      .finally(()=> setLoadingUI(false));
  }

  /* === Cập nhật UI cho GROUP BAR === */
  function updateGroupUI(){
    const chips = document.querySelectorAll('#groupBar .group-chip');
    let activeEl = null;
    chips.forEach(chip=>{
      const on = chip.dataset.val === (state.group||'');
      chip.classList.toggle('active', on);
      if(on) activeEl = chip;
    });
    const catBox = document.querySelector('.category-box');
    if(catBox){
      const has = !!state.group;
      catBox.classList.toggle('group-active', has);
      catBox.classList.toggle('group-highlight', has);
      catBox.classList.toggle('tab-mode', has);
      if(activeEl){
        const wrap = document.querySelector('.group-bar-wrapper');
        const r1 = wrap.getBoundingClientRect();
        const r2 = activeEl.getBoundingClientRect();
        const left = Math.max(0, r2.left - r1.left);
        const width = r2.width;
        catBox.style.setProperty('--ink-left', left + 'px');
        catBox.style.setProperty('--ink-width', width + 'px');
      }else{
        catBox.style.removeProperty('--ink-left');
        catBox.style.removeProperty('--ink-width');
      }
    }
  }

  /* expose global for inline handlers */
  Object.assign(window, { fetchPage, scrollCats, selectCategory, clearAllFilters });

  /* INIT */
  fetchPage();
  updateFilterCount();

  document.addEventListener('keydown', (e) => {
    if ((e.ctrlKey || e.metaKey) && String(e.key || '').toLowerCase() === 'k') {
      e.preventDefault();
      document.getElementById('searchBox')?.focus();
    }
  });
}); // DOMContentLoaded
</script>

<!-- ===== FOOTER ===== -->
<footer class="text-light" style="background:#0018a8;">
  <div class="container">
    <div class="row pt-5 pb-3">
      <div class="col-md-3 mb-4 text-center">
        <img 
          src="https://drive.google.com/uc?export=view&id=1e9N6rgsTP5vYtKl4Lwq801dfteYLbx_F" 
          alt="2606AI logo" 
          class="mb-3 d-block mx-auto" 
          style="max-width:160px;height:auto">
        <p class="small mb-0 opacity-90">
          Dịch vụ hỗ trợ sản xuất ấn phẩm thương hiệu từ thiết kế đến thành phẩm.  
          <br>Tham khảo mẫu - Tư vấn - Thiết kế - Lấy báo giá - Đặt hàng - Đóng gói - Vận chuyển. 
        </p>
      </div>

      <div class="col-md-3 mb-4">
        <h6 class="fw-bold text-uppercase mb-3" style="color:#d4af37;">Liên kết nhanh</h6>
        <ul class="list-unstyled mb-0">
          <li class="mb-2"><a class="link-light text-decoration-none" href="#">Về chúng tôi</a></li>
          <li class="mb-2"><a class="link-light text-decoration-none" href="#">Danh mục sản phẩm</a></li>
          <li class="mb-2"><a class="link-light text-decoration-none" href="#">Báo giá nhanh</a></li>
          <li class="mb-2"><a class="link-light text-decoration-none" href="#">Câu hỏi thường gặp</a></li>
        </ul>
      </div>

      <div class="col-md-3 mb-4">
        <h6 class="fw-bold text-uppercase mb-3" style="color:#d4af37;">Chính sách</h6>
        <ul class="list-unstyled mb-0">
          <li class="mb-2"><a class="link-light text-decoration-none" href="#">Chính sách vận chuyển</a></li>
          <li class="mb-2"><a class="link-light text-decoration-none" href="#">Chính sách đổi trả</a></li>
          <li class="mb-2"><a class="link-light text-decoration-none" href="#">Hướng dẫn đặt hàng</a></li>
          <li class="mb-2"><a class="link-light text-decoration-none" href="#">Chính sách bảo mật</a></li>
        </ul>
      </div>

      <div class="col-md-3 mb-4">
        <h6 class="fw-bold text-uppercase mb-3" style="color:#d4af37;">Liên hệ</h6>
        <ul class="list-unstyled small mb-3">
          <li class="mb-2"><i class="bi bi-geo-alt me-2"></i>Địa chỉ: 123 Đường ABC, Quận 1, TP.HCM</li>
          <li class="mb-2"><i class="bi bi-telephone me-2"></i>Hotline:
            <a class="link-light text-decoration-none" href="tel:0909123456">0909 123 456</a></li>
          <li class="mb-2"><i class="bi bi-envelope me-2"></i>Email:
            <a class="link-light text-decoration-none" href="mailto:info@2606ai.vn">info@2606ai.vn</a></li>
        </ul>

        <div class="small opacity-90 mt-3">
          <div class="fw-bold text-uppercase mb-1">HỘ KINH DOANH DỊCH VỤ MARKETING VINA GASE</div>
          Mã số thuế: <strong>12333211232</strong><br>
          Liên hệ: <strong>012345678</strong><br>          Email: <a class="text-light text-decoration-none" href="mailto:lienhengay@gmail.com">lienhengay@gmail.com</a>
        </div>

        <div class="d-flex align-items-center gap-3 mt-3">
          <a href="#" class="link-light" aria-label="Facebook"><i class="bi bi-facebook"></i></a>
          <a href="#" class="link-light" aria-label="Messenger"><i class="bi bi-messenger"></i></a>
          <a href="#" class="link-light" aria-label="Telegram"><i class="bi bi-telegram"></i></a>
          <a href="#" class="link-light" aria-label="YouTube"><i class="bi bi-youtube"></i></a>
        </div>
      </div>
    </div>

    <hr class="border-light opacity-50">

    <div class="text-center small pb-3">
      © 2025 <span style="color:#d4af37;">2606AI</span>. Website được phát triển bởi 2606AI.
    </div>
  </div>
</footer>

</body>
</html>

