<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>PCGbrand - Thi·∫øt k·∫ø & Mua tr·ª±c ti·∫øp</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;600;700;800&display=swap" rel="stylesheet">

<style>
  :root{
    --main:#0018a8;
    --accent:#d4af37;
    --bg:#f5f6fa;
    --border:#e9e9ee;
  }
  body{font-family:'Be Vietnam Pro',sans-serif;background:var(--bg);color:#222;font-size:14px}
  .container-xl{max-width:1320px}

  /* Banner */
  .top-banner{background:#000;color:#fff;text-align:center;padding:6px;font-size:13px;font-weight:600}

  /* Hero */
  .hero{margin:15px 0;border-radius:12px;overflow:hidden}
  .hero img{width:100%;height:200px;object-fit:cover}

  /* Sidebar */
  .sidebar{background:#fff;border-radius:10px;padding:15px;margin-bottom:15px;box-shadow:0 2px 5px rgba(0,0,0,0.05)}
  .sidebar h6{font-weight:700;margin-bottom:10px}

  /* Category */
  #categoryBox {margin:15px 0;}
  #categoryBox .cat-btn{
    border:none;background:#fff;border:1px solid var(--border);
    border-radius:20px;padding:6px 14px;margin:2px;font-size:13px;cursor:pointer;
  }
  #categoryBox .cat-btn.active{background:var(--accent);color:#fff;font-weight:600}

  /* Product Grid */
  #productGrid{display:grid;grid-template-columns:repeat(5,1fr);gap:15px}
  .cardx{background:#fff;border-radius:10px;overflow:hidden;box-shadow:0 2px 5px rgba(0,0,0,0.05);position:relative;cursor:pointer}
  .cardx img.thumb{width:100%;height:180px;object-fit:cover}
  .cardx .note-badge{
    position:absolute;top:6px;left:6px;background:#f4c430;color:#000;
    font-size:12px;padding:2px 6px;border-radius:6px;font-weight:600
  }
  .cardx .meta{padding:8px}
  .cardx .id{font-weight:700;font-size:13px;color:#0000fc}
  .cardx .details{font-size:12px;color:#444;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .cardx .type-badge{font-size:11px;color:#555;margin-top:2px}
  .cardx .row-meta{display:flex;align-items:center;justify-content:space-between;margin-top:6px}
  .cardx .price{color:#d32f2f;font-weight:700;font-size:14px}
  .cardx .add-btn{
    border:none;background:var(--main);color:#fff;font-size:16px;font-weight:700;
    width:28px;height:28px;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center
  }

  /* Pagination */
  .pager{text-align:right;margin:15px 0}
  .pager button{border:none;background:none;margin:0 5px;font-weight:600;color:var(--main)}
</style>
</head>
<body>

<!-- Banner -->
<div class="top-banner">∆Øu ƒë√£i th√°ng n√†y cho kh√°ch ƒë·∫∑t qua 2606ai.vn</div>

<div class="container-xl py-3">
  <!-- Hero -->
  <div class="hero">
    <img src="https://picsum.photos/1200/300?random=10" alt="hero">
  </div>

  <!-- Search -->
  <div class="input-group mb-3">
    <input id="searchBox" class="form-control" placeholder="T√¨m s·∫£n ph·∫©m... (ID, m√¥ t·∫£, TYPE)">
    <button id="searchBtn" class="btn btn-primary">üîç</button>
    <button class="btn btn-outline-primary ms-2">üõí Gi·ªè h√†ng <span id="cartCount">0</span></button>
  </div>

  <div class="row">
    <!-- Sidebar -->
    <div class="col-md-3">
      <div class="sidebar">
        <h6>Quy·ªÅn l·ª£i khi ƒë·∫∑t h√†ng qua 2606ai.vn</h6>
        <ul class="list-unstyled small">
          <li>‚ö° B√°o gi√° nhanh 24h</li>
          <li>üé® Thi·∫øt k·∫ø & ch·ªânh s·ª≠a file mi·ªÖn ph√≠</li>
          <li>üîç Duy·ªát m·∫´u tr∆∞·ªõc khi s·∫£n xu·∫•t</li>
          <li>‚úÖ QC 2 l·ªõp & b·∫£o h√†nh</li>
          <li>üöö Giao h√†ng to√†n qu·ªëc</li>
        </ul>
      </div>
      <div class="sidebar">
        <h6>X∆∞·ªüng s·∫£n xu·∫•t uy t√≠n</h6>
        <div id="factoryList"></div>
      </div>
    </div>

    <!-- Main -->
    <div class="col-md-9">
      <!-- Category -->
      <div id="categoryBox"></div>

      <!-- Grid -->
      <h6>Danh s√°ch s·∫£n ph·∫©m</h6>
      <div id="productGrid"></div>

      <!-- Pagination -->
      <div class="pager">
        <button id="prevBtn">‚Üê Tr∆∞·ªõc</button>
        <button id="nextBtn">Sau ‚Üí</button>
      </div>
    </div>
  </div>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbyp8hH9seYgTW_H59pcR4OpvdQbpLhH9F67oYvOQoUpDsjYsemNDgel2sMameaxTdKy/exec";
const state={page:1,pageSize:30,q:'',group:''};
const fmtVND = n => (Number(n)||0).toLocaleString('vi-VN') + ' ƒë';
function hiRes(url,w=600){return (url||'').replace(/=s\\d+/,'=s'+w);}
function esc(s){return (s??'').toString().replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}

/* Factories */
const FACTORIES = [
  { name:'X∆∞·ªüng 1 ‚Äì Tem kim lo·∫°i', desc:'Men m√†u, m·∫° v√†ng, ƒë√∫c n·ªïi 3D', logo:'https://picsum.photos/80?random=41', href:'#' },
  { name:'X∆∞·ªüng 2 ‚Äì In UV', desc:'In UV ƒë·ªô b·ªÅn cao, chi ti·∫øt s·∫Øc n√©t', logo:'https://picsum.photos/80?random=42', href:'#' },
  { name:'X∆∞·ªüng 3 ‚Äì ƒê√∫c huy hi·ªáu', desc:'ƒê√∫c n·ªïi 3D, m·∫° m√†u cao c·∫•p', logo:'https://picsum.photos/80?random=43', href:'#' }
];
function renderFactories(){
  const box=document.getElementById('factoryList');
  box.innerHTML=FACTORIES.map(f=>`
    <div class="d-flex align-items-center mb-2">
      <img src="${f.logo}" class="me-2" style="width:40px;height:40px;border-radius:6px;object-fit:cover">
      <div>
        <div class="fw-bold small">${esc(f.name)}</div>
        <div class="text-muted small">${esc(f.desc)}</div>
      </div>
    </div>`).join('');
}

/* Category */
let builtCategories=false;
function buildCategoriesOnce(groups){
  if(builtCategories) return;
  const box=document.getElementById('categoryBox');
  const all=`<button class="cat-btn ${!state.group?'active':''}" data-group="">T·∫•t c·∫£</button>`;
  const btns=(groups||[]).map(g=>{
    const val=(g||'').trim();
    const act=(state.group||'').toLowerCase()===val.toLowerCase()?'active':'';
    return `<button class="cat-btn ${act}" data-group="${esc(val)}">${esc(val)}</button>`;
  }).join('');
  box.innerHTML=all+btns;
  box.addEventListener('click',e=>{
    const btn=e.target.closest('.cat-btn'); if(!btn) return;
    state.group=(btn.dataset.group||'').trim();
    box.querySelectorAll('.cat-btn').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    state.page=1; fetchPage();
  });
  builtCategories=true;
}

/* Data fetch */
function fetchPage(){
  document.getElementById('productGrid').innerHTML='<div>ƒêang t·∫£i...</div>';
  fetch(`${API_URL}?action=list&page=${state.page}&pageSize=${state.pageSize}&q=${encodeURIComponent(state.q)}&group=${encodeURIComponent(state.group)}`)
    .then(r=>r.json()).then(res=>render(res))
    .catch(()=>{document.getElementById('productGrid').innerHTML='<div class="text-danger">L·ªói t·∫£i d·ªØ li·ªáu</div>';});
}

/* Product card */
function productCardHtml(it){
  const img=hiRes(it.img,400);
  return `
    <div class="cardx">
      ${it.chuy ? `<span class="note-badge">${esc(it.chuy)}</span>` : ``}
      <img class="thumb" src="${img}">
      <div class="meta">
        <div class="id">${esc(it.id)}</div>
        <div class="details">${esc(it.details)}</div>
        <div class="type-badge">${esc(it.type||'')}</div>
        <div class="row-meta">
          <div class="price">${fmtVND(it.price)}</div>
          <button class="add-btn" title="Th√™m">+</button>
        </div>
      </div>
    </div>`;
}
function render(res){
  if(res?.facets?.groups) buildCategoriesOnce(res.facets.groups);
  document.getElementById('productGrid').innerHTML =
    (res.items||[]).map(it=>productCardHtml(it)).join('') || '<div>Kh√¥ng c√≥ s·∫£n ph·∫©m</div>';
}

/* Events */
document.getElementById('prevBtn').onclick=()=>{ if(state.page>1){state.page--; fetchPage();}};
document.getElementById('nextBtn').onclick=()=>{state.page++; fetchPage();};
document.getElementById('searchBtn').onclick=()=>{ state.q=document.getElementById('searchBox').value.trim();state.page=1;fetchPage();};
document.getElementById('searchBox').addEventListener('keypress',e=>{if(e.key==='Enter'){state.q=e.target.value.trim();state.page=1;fetchPage();}});

/* Init */
document.addEventListener('DOMContentLoaded',()=>{renderFactories();fetchPage();});
</script>
</body>
</html>
